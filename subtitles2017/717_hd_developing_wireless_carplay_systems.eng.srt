1
00:00:17,556 --> 00:00:19,866
&gt;&gt; Hello, I'm Tanya Kancheva and

2
00:00:19,866 --> 00:00:21,456
I'm here to talk about wireless

3
00:00:21,456 --> 00:00:21,916
CarPlay.

4
00:00:23,656 --> 00:00:25,526
wireless CarPlay is perfect for

5
00:00:25,526 --> 00:00:27,776
any trip, you can get in your

6
00:00:27,776 --> 00:00:29,726
car without taking your iPhone

7
00:00:29,776 --> 00:00:32,165
out of your bag or pocket and

8
00:00:32,165 --> 00:00:33,896
start experiencing CarPlay

9
00:00:33,896 --> 00:00:34,636
effortlessly.

10
00:00:36,126 --> 00:00:37,486
The CarPlay experience is the

11
00:00:37,596 --> 00:00:39,586
same whether you are plugged in

12
00:00:39,786 --> 00:00:41,336
or using it wirelessly.

13
00:00:42,856 --> 00:00:44,746
In this session, we will dive

14
00:00:44,746 --> 00:00:47,076
into the details on developing a

15
00:00:47,076 --> 00:00:48,466
wireless CarPlay system.

16
00:00:50,716 --> 00:00:52,596
First, let's start by talking

17
00:00:52,646 --> 00:00:54,436
about the wireless CarPlay

18
00:00:54,436 --> 00:00:55,206
experience.

19
00:00:57,506 --> 00:00:59,116
The first time you use wireless

20
00:00:59,116 --> 00:01:01,076
CarPlay you need to pair your

21
00:00:59,116 --> 00:01:01,076
CarPlay you need to pair your

22
00:01:01,336 --> 00:01:02,766
iPhone to your car.

23
00:01:04,025 --> 00:01:05,976
The simplest way to pair is by

24
00:01:06,016 --> 00:01:07,726
plugging in iPhone using a

25
00:01:07,726 --> 00:01:08,126
cable.

26
00:01:09,586 --> 00:01:10,996
You can also pair without

27
00:01:10,996 --> 00:01:12,736
plugging in by using the car's

28
00:01:12,736 --> 00:01:15,316
UI to add a new device and by

29
00:01:15,316 --> 00:01:16,476
following the onscreen

30
00:01:16,476 --> 00:01:17,096
instructions.

31
00:01:19,426 --> 00:01:21,526
Plugging in iPhone using a cable

32
00:01:21,646 --> 00:01:23,986
is the easiest and fastest way

33
00:01:24,026 --> 00:01:26,336
to pair for wireless CarPlay and

34
00:01:26,376 --> 00:01:28,106
all wireless CarPlay systems

35
00:01:28,426 --> 00:01:29,606
should support this feature.

36
00:01:30,646 --> 00:01:32,006
When iPhone is plugged in

37
00:01:32,286 --> 00:01:33,496
CarPlay starts normally.

38
00:01:35,496 --> 00:01:37,136
If the car supports wireless

39
00:01:37,136 --> 00:01:38,996
CarPlay the user will be

40
00:01:38,996 --> 00:01:40,866
presented with the following

41
00:01:40,866 --> 00:01:41,926
prompt on iPhone.

42
00:01:44,186 --> 00:01:46,926
A simple tap on enable wireless

43
00:01:46,926 --> 00:01:48,606
CarPlay completes the pairing

44
00:01:48,606 --> 00:01:49,186
process.

45
00:01:49,956 --> 00:01:51,886
Be sure to provide a meaningful

46
00:01:51,886 --> 00:01:54,366
display name as in this example,

47
00:01:54,646 --> 00:01:57,116
my car, so it's clear that

48
00:01:57,116 --> 00:01:58,826
iPhone will be associated with

49
00:01:58,826 --> 00:01:59,176
the car.

50
00:02:02,316 --> 00:02:04,826
Once pairing is complete CarPlay

51
00:02:04,826 --> 00:02:06,546
starts automatically the next

52
00:02:06,546 --> 00:02:07,726
time you enter the car.

53
00:02:09,485 --> 00:02:11,496
It's not necessary to require

54
00:02:11,496 --> 00:02:13,186
additional confirmation on the

55
00:02:13,186 --> 00:02:15,956
car's display because CarPlay is

56
00:02:15,956 --> 00:02:18,226
already running and the user has

57
00:02:18,226 --> 00:02:20,326
already chosen to use wireless

58
00:02:20,326 --> 00:02:21,546
CarPlay on iPhone.

59
00:02:22,496 --> 00:02:24,686
As you can see, pairing by

60
00:02:24,746 --> 00:02:27,156
plugging in is simple and

61
00:02:27,156 --> 00:02:27,626
effortless.

62
00:02:30,476 --> 00:02:32,436
The user can also pair without

63
00:02:32,436 --> 00:02:34,066
plugging in and by using the

64
00:02:34,066 --> 00:02:36,776
car's UI to add a new device and

65
00:02:36,776 --> 00:02:38,186
by following the onscreen

66
00:02:38,286 --> 00:02:39,616
instructions.

67
00:02:40,506 --> 00:02:42,426
To begin, the pairing process

68
00:02:42,426 --> 00:02:43,986
needs to be started on both the

69
00:02:43,986 --> 00:02:45,506
car and on iPhone.

70
00:02:48,246 --> 00:02:50,596
To make it easier CarPlay

71
00:02:50,596 --> 00:02:53,046
standardizes a long press on the

72
00:02:53,046 --> 00:02:55,196
Voice Control button to start

73
00:02:55,196 --> 00:02:56,116
the pairing process.

74
00:02:57,156 --> 00:02:58,696
Normally this will start Siri,

75
00:02:59,086 --> 00:03:01,096
but if no phone is connected the

76
00:02:59,086 --> 00:03:01,096
but if no phone is connected the

77
00:03:01,126 --> 00:03:02,586
car should immediately prepare

78
00:03:02,586 --> 00:03:03,156
for pairing.

79
00:03:04,846 --> 00:03:06,776
You can also use menus and

80
00:03:06,776 --> 00:03:08,656
settings in the car's native UI

81
00:03:08,656 --> 00:03:10,106
to start the pairing process.

82
00:03:11,096 --> 00:03:12,736
You may offer a CarPlay specific

83
00:03:12,736 --> 00:03:14,936
menu, a general Bluetooth menu

84
00:03:15,066 --> 00:03:15,556
or both.

85
00:03:18,546 --> 00:03:20,356
In CarPlay settings on iPhone

86
00:03:20,856 --> 00:03:22,646
users are encouraged to press

87
00:03:22,646 --> 00:03:23,866
and hold the Voice Control

88
00:03:23,866 --> 00:03:25,846
button on the steering wheel to

89
00:03:25,846 --> 00:03:27,206
start the pairing process.

90
00:03:29,546 --> 00:03:32,066
Once CarPlay setup is started on

91
00:03:32,066 --> 00:03:34,576
the car and iPhone select the

92
00:03:34,576 --> 00:03:36,146
discovered device to start the

93
00:03:36,146 --> 00:03:36,866
pairing process.

94
00:03:39,376 --> 00:03:41,416
Apple recommends that you allow

95
00:03:41,416 --> 00:03:43,336
the user to select the car from

96
00:03:43,386 --> 00:03:43,776
iPhone.

97
00:03:44,696 --> 00:03:47,356
In your native UI simply show

98
00:03:47,356 --> 00:03:49,566
your car's display name so the

99
00:03:49,566 --> 00:03:50,996
user knows what to look for.

100
00:03:54,036 --> 00:03:55,796
If you do allow the user to

101
00:03:55,796 --> 00:03:57,456
initiate selection from the car

102
00:03:58,236 --> 00:03:59,426
you can show a list of

103
00:03:59,426 --> 00:04:00,426
discovered devices.

104
00:03:59,426 --> 00:04:00,426
discovered devices.

105
00:04:02,016 --> 00:04:03,616
You can show a less specific to

106
00:04:03,616 --> 00:04:07,186
adding a CarPlay device or you

107
00:04:07,186 --> 00:04:08,566
can show a list of all

108
00:04:08,566 --> 00:04:10,026
discovered Bluetooth devices,

109
00:04:10,236 --> 00:04:11,726
including CarPlay devices.

110
00:04:14,536 --> 00:04:16,286
If the user selects a device

111
00:04:16,505 --> 00:04:18,546
using a general Bluetooth menu

112
00:04:19,026 --> 00:04:20,286
and that device supports

113
00:04:20,286 --> 00:04:22,626
wireless CarPlay, you may decide

114
00:04:22,626 --> 00:04:24,166
to offer to enable CarPlay.

115
00:04:25,116 --> 00:04:26,776
Do not show this screen if the

116
00:04:26,776 --> 00:04:28,976
user selected the device from a

117
00:04:28,976 --> 00:04:30,256
CarPlay specific menu.

118
00:04:32,856 --> 00:04:35,276
Then CarPlay connects and

119
00:04:35,516 --> 00:04:36,766
CarPlay appears on the screen.

120
00:04:37,486 --> 00:04:39,126
From here on the CarPlay

121
00:04:39,126 --> 00:04:40,696
experience is the same as

122
00:04:41,026 --> 00:04:42,886
plugging in until you leave the

123
00:04:42,886 --> 00:04:42,976
car.

124
00:04:47,066 --> 00:04:48,606
Every time the user enters the

125
00:04:48,606 --> 00:04:50,746
car CarPlay reconnects

126
00:04:50,746 --> 00:04:54,376
automatically, iPhone can remain

127
00:04:54,376 --> 00:04:56,626
in your bag or pocket and no

128
00:04:56,626 --> 00:04:58,406
user interaction is necessary.

129
00:04:59,506 --> 00:05:01,886
When CarPlay starts, be sure to

130
00:04:59,506 --> 00:05:01,886
When CarPlay starts, be sure to

131
00:05:01,886 --> 00:05:03,706
observe the last user mode for

132
00:05:03,706 --> 00:05:05,036
audio in the display.

133
00:05:06,246 --> 00:05:08,456
For details, watch the video

134
00:05:08,456 --> 00:05:10,906
Developing CarPlay Systems Part

135
00:05:10,906 --> 00:05:11,226
1.

136
00:05:14,816 --> 00:05:17,706
With wireless CarPlay it's easy

137
00:05:17,706 --> 00:05:19,546
to pair more than one iPhone

138
00:05:19,706 --> 00:05:20,316
with the car.

139
00:05:21,366 --> 00:05:23,926
In addition, you may have one or

140
00:05:23,926 --> 00:05:26,006
many iPhones plugged in at the

141
00:05:26,106 --> 00:05:26,676
same time.

142
00:05:28,396 --> 00:05:30,146
Provide a device selector in

143
00:05:30,146 --> 00:05:32,346
your native UI that lets the

144
00:05:32,346 --> 00:05:34,446
user choose the active CarPlay

145
00:05:34,446 --> 00:05:34,806
device.

146
00:05:35,866 --> 00:05:38,346
Once CarPlay has started don't

147
00:05:38,346 --> 00:05:39,876
automatically switch to another

148
00:05:39,876 --> 00:05:40,276
device.

149
00:05:41,446 --> 00:05:42,906
Changing the active CarPlay

150
00:05:42,906 --> 00:05:44,646
device should be an explicit

151
00:05:44,746 --> 00:05:45,656
user action.

152
00:05:47,246 --> 00:05:48,746
If you support multiple

153
00:05:48,746 --> 00:05:50,696
Bluetooth devices and have a

154
00:05:50,726 --> 00:05:52,666
concept of favorite or

155
00:05:52,666 --> 00:05:55,456
frequently used devices use the

156
00:05:55,456 --> 00:05:57,386
same mechanism for wireless

157
00:05:57,496 --> 00:05:57,936
CarPlay.

158
00:05:59,516 --> 00:06:02,096
Your device selector shows all

159
00:05:59,516 --> 00:06:02,096
Your device selector shows all

160
00:06:02,096 --> 00:06:04,406
CarPlay devices whether they are

161
00:06:04,476 --> 00:06:06,296
plugged in or paired for

162
00:06:06,296 --> 00:06:07,196
wireless CarPlay.

163
00:06:08,686 --> 00:06:10,316
Indicate the active CarPlay

164
00:06:10,316 --> 00:06:12,836
device using the CarPlay logo.

165
00:06:13,876 --> 00:06:15,906
Never indicate if CarPlay is

166
00:06:15,906 --> 00:06:17,796
running over wireless or wired.

167
00:06:18,626 --> 00:06:19,926
The transfer type should be

168
00:06:19,926 --> 00:06:21,186
transparent to the user.

169
00:06:22,526 --> 00:06:24,476
If you provide on off settings

170
00:06:25,116 --> 00:06:26,686
don't provide separate settings

171
00:06:26,786 --> 00:06:28,466
for wired and wireless CarPlay,

172
00:06:28,956 --> 00:06:30,196
just provide a setting for

173
00:06:30,196 --> 00:06:32,206
Bluetooth or iPod versus

174
00:06:32,206 --> 00:06:32,596
CarPlay.

175
00:06:34,326 --> 00:06:35,896
Be judicious in showing

176
00:06:35,896 --> 00:06:38,256
notifications, only show

177
00:06:38,256 --> 00:06:39,646
notifications when it's

178
00:06:39,646 --> 00:06:41,416
important to let the users know.

179
00:06:42,246 --> 00:06:44,216
Show a subtle notification when

180
00:06:44,216 --> 00:06:46,346
the first iPhone is connected

181
00:06:47,026 --> 00:06:48,996
only if CarPlay will not

182
00:06:48,996 --> 00:06:51,446
immediately become visible or

183
00:06:51,846 --> 00:06:53,596
the CarPlay [inaudible] icon is

184
00:06:53,596 --> 00:06:54,856
not immediately visible.

185
00:06:56,286 --> 00:06:57,916
Show a notification when a

186
00:06:57,916 --> 00:07:00,236
second iPhone is connected over

187
00:06:57,916 --> 00:07:00,236
second iPhone is connected over

188
00:07:00,236 --> 00:07:02,446
USB while CarPlay is running.

189
00:07:03,806 --> 00:07:06,526
Do not show notifications when

190
00:07:06,666 --> 00:07:08,666
iPhone joins or leaves the

191
00:07:08,816 --> 00:07:10,896
access point or when it is

192
00:07:10,896 --> 00:07:12,696
reconnected over Bluetooth.

193
00:07:15,436 --> 00:07:17,536
Now that we have seen how to use

194
00:07:17,536 --> 00:07:20,136
wireless CarPlay let's explore

195
00:07:20,236 --> 00:07:21,706
what it takes to develop such a

196
00:07:21,706 --> 00:07:22,186
system.

197
00:07:25,446 --> 00:07:26,686
We'll start with the hardware

198
00:07:26,686 --> 00:07:28,766
requirements, go through setup

199
00:07:28,766 --> 00:07:30,816
and pairing, reconnecting for

200
00:07:30,816 --> 00:07:33,106
CarPlay, and finish with some

201
00:07:33,106 --> 00:07:35,256
considerations for your wireless

202
00:07:35,256 --> 00:07:35,916
architecture.

203
00:07:38,666 --> 00:07:40,026
So, hardware requirements.

204
00:07:40,306 --> 00:07:42,086
wireless CarPlay requires

205
00:07:42,086 --> 00:07:44,586
Bluetooth, a Wi-Fi access point

206
00:07:44,906 --> 00:07:45,836
and location data.

207
00:07:47,956 --> 00:07:50,066
Bluetooth is used to discover

208
00:07:50,126 --> 00:07:51,866
and reconnect CarPlay devices.

209
00:07:53,356 --> 00:07:55,076
To accomplish this the Bluetooth

210
00:07:55,076 --> 00:07:57,386
subsystem needs to implement the

211
00:07:57,386 --> 00:07:59,666
Bluetooth core specification, as

212
00:07:59,666 --> 00:08:00,946
well as support service

213
00:07:59,666 --> 00:08:00,946
well as support service

214
00:08:00,946 --> 00:08:04,046
discovery, iAP2 protocols and

215
00:08:04,096 --> 00:08:06,236
advertise CarPlay support in its

216
00:08:06,236 --> 00:08:07,806
Bluetooth Extended Inquiry

217
00:08:07,806 --> 00:08:08,636
Response.

218
00:08:11,856 --> 00:08:14,726
The Wi-Fi link is used for all

219
00:08:14,726 --> 00:08:16,676
audio and video transfer to the

220
00:08:16,676 --> 00:08:18,966
CarPlay protocol, as well as

221
00:08:19,116 --> 00:08:20,616
iAP2 data transfer.

222
00:08:21,916 --> 00:08:23,106
The access point must be

223
00:08:23,106 --> 00:08:25,136
certified by the Wi-Fi Alliance

224
00:08:25,716 --> 00:08:27,386
and it is recommended that it

225
00:08:27,436 --> 00:08:30,686
supports the 802.11ac standard

226
00:08:31,106 --> 00:08:33,025
and operates in the 5GHz

227
00:08:33,025 --> 00:08:34,066
frequency band.

228
00:08:35,796 --> 00:08:37,876
In addition, the axis point

229
00:08:37,876 --> 00:08:39,256
needs to support the Apple

230
00:08:39,256 --> 00:08:41,426
Device Information Element and

231
00:08:41,426 --> 00:08:43,346
the Interworking Information

232
00:08:44,135 --> 00:08:44,366
Element.

233
00:08:45,236 --> 00:08:47,406
The location has always been

234
00:08:47,406 --> 00:08:49,736
required for CarPlay, but it

235
00:08:49,736 --> 00:08:51,916
becomes an absolute necessity

236
00:08:52,256 --> 00:08:54,186
with wireless CarPlay as the

237
00:08:54,186 --> 00:08:55,866
driver's phone might be left in

238
00:08:55,866 --> 00:08:57,786
a pocket or a bag and be

239
00:08:57,786 --> 00:08:58,886
completely out of sight.

240
00:09:00,476 --> 00:09:02,426
To provide reliable and precise

241
00:09:02,426 --> 00:09:04,966
location data, the head unit

242
00:09:04,966 --> 00:09:08,136
needs a GNSS receiver, access to

243
00:09:08,136 --> 00:09:09,836
the speed sensor of the vehicle,

244
00:09:10,346 --> 00:09:11,716
as well as the ability to

245
00:09:11,716 --> 00:09:13,416
provide dead reckoning position

246
00:09:13,416 --> 00:09:14,106
information.

247
00:09:15,206 --> 00:09:17,096
Okay, now that we have talked

248
00:09:17,126 --> 00:09:18,196
through the basic hardware

249
00:09:18,196 --> 00:09:20,756
requirements let's talk about

250
00:09:20,836 --> 00:09:22,546
set up and pairing for CarPlay.

251
00:09:25,556 --> 00:09:27,546
First, let's look at what

252
00:09:27,546 --> 00:09:29,366
components are needed to set up

253
00:09:29,366 --> 00:09:30,856
wireless and wired CarPlay.

254
00:09:33,216 --> 00:09:35,476
Of course, one or many USB

255
00:09:35,476 --> 00:09:38,456
ports, a Wi-Fi access point,

256
00:09:39,266 --> 00:09:41,766
Bluetooth module, and an

257
00:09:41,766 --> 00:09:43,186
instance of the CarPlay

258
00:09:43,186 --> 00:09:44,566
communication plugin are

259
00:09:44,566 --> 00:09:45,176
required.

260
00:09:47,336 --> 00:09:49,576
On ignition on or a head unit

261
00:09:49,576 --> 00:09:51,796
restart the components need to

262
00:09:51,796 --> 00:09:53,416
be initialized and set up.

263
00:09:54,616 --> 00:09:57,606
USBs ready for role swap and NCM

264
00:09:57,606 --> 00:09:58,976
communication for wired CarPlay.

265
00:10:00,676 --> 00:10:02,966
BT, Wi-Fi and networking for

266
00:10:02,966 --> 00:10:03,906
wireless CarPlay.

267
00:10:04,966 --> 00:10:07,386
Bonjour and the communication

268
00:10:07,386 --> 00:10:09,116
plugin to enable CarPlay

269
00:10:09,116 --> 00:10:09,706
discovery.

270
00:10:11,736 --> 00:10:13,796
When all those components are

271
00:10:13,796 --> 00:10:15,976
set up the system is ready for

272
00:10:15,976 --> 00:10:16,856
CarPlay connection.

273
00:10:18,096 --> 00:10:20,556
As we saw earlier, there are two

274
00:10:20,556 --> 00:10:22,356
ways to pair iPhone to the car.

275
00:10:23,116 --> 00:10:25,476
If iPhone is plugged in using a

276
00:10:25,476 --> 00:10:28,836
cable out-of-band pairing is

277
00:10:28,836 --> 00:10:30,086
triggered in the background.

278
00:10:31,446 --> 00:10:33,956
Otherwise, a Bluetooth pairing

279
00:10:33,956 --> 00:10:34,976
process is needed.

280
00:10:36,496 --> 00:10:39,606
Setup over USB requires less

281
00:10:39,606 --> 00:10:41,506
user interaction and is the

282
00:10:41,506 --> 00:10:43,156
recommended setup procedure.

283
00:10:46,546 --> 00:10:48,446
Now let's dive into pairing over

284
00:10:48,486 --> 00:10:48,776
USB.

285
00:10:50,716 --> 00:10:52,986
As you see in the diagram, we

286
00:10:52,986 --> 00:10:54,476
have the essential head unit

287
00:10:54,476 --> 00:10:57,266
components on the left-hand side

288
00:10:57,886 --> 00:10:59,466
and iPhone is displayed on the

289
00:10:59,466 --> 00:10:59,836
right.

290
00:11:00,766 --> 00:11:02,666
At this point, the system is

291
00:11:02,706 --> 00:11:04,186
fully booted and ready for

292
00:11:04,186 --> 00:11:04,736
CarPlay.

293
00:11:05,576 --> 00:11:07,046
The head unit is showing the

294
00:11:07,046 --> 00:11:09,596
native user interface as the

295
00:11:09,596 --> 00:11:10,976
user connects over USB.

296
00:11:12,776 --> 00:11:16,356
A USB role switch follows and

297
00:11:16,356 --> 00:11:17,656
iPhone shows that CarPlay's

298
00:11:17,656 --> 00:11:18,226
connected.

299
00:11:21,526 --> 00:11:23,656
With the role switch the unit

300
00:11:23,656 --> 00:11:26,286
also establishes an iAP2 link

301
00:11:26,726 --> 00:11:28,166
declaring support for all

302
00:11:28,166 --> 00:11:29,366
necessary messages.

303
00:11:30,746 --> 00:11:32,296
While the CarPlay session is

304
00:11:32,296 --> 00:11:34,996
starting over USB iPhone asks

305
00:11:35,226 --> 00:11:36,776
the user to enable wireless

306
00:11:36,776 --> 00:11:37,236
CarPlay.

307
00:11:40,686 --> 00:11:43,496
With that CarPlay over USB is

308
00:11:43,496 --> 00:11:44,296
already active.

309
00:11:45,766 --> 00:11:48,226
So, iOS proceeds with setting up

310
00:11:48,226 --> 00:11:50,016
the audio and video streams to

311
00:11:50,016 --> 00:11:51,266
show CarPlay in the car.

312
00:11:55,156 --> 00:11:57,286
Now the user decides to enable

313
00:11:57,286 --> 00:11:58,106
wireless CarPlay.

314
00:12:01,936 --> 00:12:05,136
After user confirmation iOS

315
00:12:05,166 --> 00:12:07,066
generates a Bluetooth link key

316
00:12:07,416 --> 00:12:09,406
and sends it over iAP to the

317
00:12:09,406 --> 00:12:09,946
unit.

318
00:12:11,566 --> 00:12:13,276
The head unit saves the link key

319
00:12:13,276 --> 00:12:14,746
together with the device

320
00:12:14,746 --> 00:12:17,526
transport identifiers and stores

321
00:12:17,526 --> 00:12:19,156
this iPhone as a Bluetooth

322
00:12:19,216 --> 00:12:21,196
paired device set up for

323
00:12:21,196 --> 00:12:21,636
CarPlay.

324
00:12:24,636 --> 00:12:27,606
Once the device is saved the

325
00:12:27,606 --> 00:12:28,926
head unit sends back a

326
00:12:28,926 --> 00:12:30,716
confirmation and out-of-band

327
00:12:30,716 --> 00:12:31,686
pairing is complete.

328
00:12:35,246 --> 00:12:35,906
Let's review.

329
00:12:38,146 --> 00:12:41,046
Without out-of-band pairing the

330
00:12:41,046 --> 00:12:42,906
CarPlay session is established

331
00:12:42,906 --> 00:12:45,726
over USB and is not interrupted.

332
00:12:47,736 --> 00:12:50,176
There is no actual exchange over

333
00:12:50,176 --> 00:12:51,776
BT during this process.

334
00:12:54,196 --> 00:12:56,646
The device needs to be stored as

335
00:12:56,646 --> 00:12:59,196
the last connected BT device or

336
00:12:59,196 --> 00:13:01,516
preferred device so that it can

337
00:12:59,196 --> 00:13:01,516
preferred device so that it can

338
00:13:01,516 --> 00:13:02,826
be reconnected later on.

339
00:13:05,076 --> 00:13:07,036
Hence, a wireless CarPlay

340
00:13:07,036 --> 00:13:09,016
session will start automatically

341
00:13:09,346 --> 00:13:11,936
only after an ignition cycle as

342
00:13:11,936 --> 00:13:13,546
the driver returns to the car.

343
00:13:15,746 --> 00:13:18,316
It's important to note that you

344
00:13:18,316 --> 00:13:19,736
should not start wireless

345
00:13:19,736 --> 00:13:21,356
CarPlay when the driver

346
00:13:21,356 --> 00:13:23,436
disconnects from USB, she might

347
00:13:23,436 --> 00:13:24,576
be just leaving the car.

348
00:13:26,086 --> 00:13:28,066
Now that we have seen the USB

349
00:13:28,066 --> 00:13:30,906
setup for wireless CarPlay let's

350
00:13:30,906 --> 00:13:32,216
take a look at the second

351
00:13:32,216 --> 00:13:34,646
method, pairing over Bluetooth.

352
00:13:35,876 --> 00:13:37,146
There are a couple of ways to

353
00:13:37,146 --> 00:13:38,966
initiate Bluetooth pairing in a

354
00:13:38,966 --> 00:13:39,476
vehicle.

355
00:13:40,646 --> 00:13:42,776
A long press on the Voice

356
00:13:42,776 --> 00:13:43,986
Recognition button on the

357
00:13:43,986 --> 00:13:46,606
steering wheel or through the

358
00:13:46,606 --> 00:13:47,176
native UI.

359
00:13:49,256 --> 00:13:51,316
And with the native UI there are

360
00:13:51,316 --> 00:13:51,916
two options.

361
00:13:51,916 --> 00:13:55,156
A dedicated UI for adding a

362
00:13:55,156 --> 00:13:58,166
CarPlay device or through the

363
00:13:58,166 --> 00:14:00,666
already existing UI for adding a

364
00:13:58,166 --> 00:14:00,666
already existing UI for adding a

365
00:14:00,666 --> 00:14:01,536
BT device.

366
00:14:02,926 --> 00:14:04,516
Over the next couple of slides,

367
00:14:04,896 --> 00:14:05,926
we will look into the

368
00:14:05,926 --> 00:14:07,576
differences between these

369
00:14:07,646 --> 00:14:08,456
pairing methods.

370
00:14:11,646 --> 00:14:13,116
No matter which of the three

371
00:14:13,116 --> 00:14:15,036
pairing UIs was used by the

372
00:14:15,036 --> 00:14:18,046
driver to initiate pairing the

373
00:14:18,046 --> 00:14:19,666
head unit becomes discoverable.

374
00:14:21,626 --> 00:14:23,776
The driver also needs to open

375
00:14:23,926 --> 00:14:26,106
either Bluetooth settings or

376
00:14:26,216 --> 00:14:29,696
CarPlay settings on iPhone to

377
00:14:29,696 --> 00:14:31,296
set iOS in a Bluetooth

378
00:14:31,296 --> 00:14:32,696
discoverable mode as well.

379
00:14:34,686 --> 00:14:37,006
Again, this is a very generic

380
00:14:37,006 --> 00:14:39,136
representation of the fact that

381
00:14:39,206 --> 00:14:40,916
both the phone and the head unit

382
00:14:40,986 --> 00:14:42,706
must be set into a discoverable

383
00:14:42,706 --> 00:14:43,016
mode.

384
00:14:46,676 --> 00:14:48,246
Now let's look at the different

385
00:14:48,246 --> 00:14:51,056
options on how to set up the

386
00:14:51,056 --> 00:14:52,956
head unit into a discoverable

387
00:14:52,956 --> 00:14:54,906
mode and how to select which

388
00:14:54,906 --> 00:14:55,826
device to pair to.

389
00:14:58,006 --> 00:14:59,986
In this first variation, the

390
00:14:59,986 --> 00:15:02,586
head unit simply asks the user

391
00:14:59,986 --> 00:15:02,586
head unit simply asks the user

392
00:15:02,626 --> 00:15:04,456
to search for the car's name on

393
00:15:04,456 --> 00:15:07,196
the CarPlay or BT settings menus

394
00:15:07,306 --> 00:15:08,046
on iPhone.

395
00:15:09,916 --> 00:15:12,296
The user enters this menu by

396
00:15:12,296 --> 00:15:13,946
either navigating the native UI

397
00:15:14,086 --> 00:15:17,106
to add a new Bluetooth device or

398
00:15:17,226 --> 00:15:18,786
by long pressing on the Voice

399
00:15:18,786 --> 00:15:20,086
Recognition button on the

400
00:15:20,086 --> 00:15:20,716
steering wheel.

401
00:15:22,956 --> 00:15:24,816
iPhone discovers the car and

402
00:15:24,816 --> 00:15:25,396
lists it.

403
00:15:28,016 --> 00:15:30,136
The driver can then select the

404
00:15:30,136 --> 00:15:34,166
car on iPhone and iOS initiates

405
00:15:34,166 --> 00:15:35,526
a Bluetooth pairing request.

406
00:15:37,466 --> 00:15:39,366
This is the simplest and most

407
00:15:39,366 --> 00:15:41,046
straightforward approach to

408
00:15:41,046 --> 00:15:42,426
accomplish Bluetooth pairing.

409
00:15:43,256 --> 00:15:45,596
The second option is for the

410
00:15:45,596 --> 00:15:47,336
driver to select the device from

411
00:15:47,336 --> 00:15:49,396
a list of available Bluetooth

412
00:15:49,396 --> 00:15:51,996
devices on the car's native

413
00:15:51,996 --> 00:15:52,586
interface.

414
00:15:54,346 --> 00:15:56,786
In this case, the head unit is

415
00:15:56,786 --> 00:15:59,186
not only discoverable, but also

416
00:15:59,186 --> 00:16:00,806
scans for BT devices.

417
00:15:59,186 --> 00:16:00,806
scans for BT devices.

418
00:16:02,516 --> 00:16:04,036
Exactly as in the previous

419
00:16:04,036 --> 00:16:06,426
option, the driver enters this

420
00:16:06,426 --> 00:16:08,466
menu by either navigating the

421
00:16:08,466 --> 00:16:10,556
native UI to add a new Bluetooth

422
00:16:10,556 --> 00:16:13,236
device or by long pressing on

423
00:16:13,236 --> 00:16:15,036
the Voice Recognition button on

424
00:16:15,036 --> 00:16:15,726
the steering wheel.

425
00:16:17,076 --> 00:16:19,126
Any BT capable device will be

426
00:16:19,126 --> 00:16:21,616
shown in this list, so the list

427
00:16:21,616 --> 00:16:23,696
might or might not include

428
00:16:23,736 --> 00:16:24,656
CarPlay devices.

429
00:16:25,966 --> 00:16:28,006
That is why it is important to

430
00:16:28,006 --> 00:16:30,706
note that in this option any

431
00:16:30,706 --> 00:16:32,866
mention of Apple CarPlay on the

432
00:16:32,866 --> 00:16:34,626
UI is not recommended.

433
00:16:36,786 --> 00:16:38,776
With this UI, the driver can

434
00:16:38,776 --> 00:16:40,606
select the device to pair to

435
00:16:41,076 --> 00:16:44,066
from the native UI or as before

436
00:16:44,326 --> 00:16:45,216
on the device.

437
00:16:46,796 --> 00:16:48,446
The third option is very

438
00:16:48,446 --> 00:16:51,536
similar, however, this time the

439
00:16:51,536 --> 00:16:54,276
user is explicitly adding a new

440
00:16:54,276 --> 00:16:55,946
CarPlay device from the native

441
00:16:55,946 --> 00:16:56,736
user interface.

442
00:16:58,036 --> 00:17:00,356
The list shows only devices that

443
00:16:58,036 --> 00:17:00,356
The list shows only devices that

444
00:17:00,356 --> 00:17:01,816
actually support wireless

445
00:17:01,816 --> 00:17:02,256
CarPlay.

446
00:17:03,486 --> 00:17:05,556
The head unit must use the Apple

447
00:17:05,556 --> 00:17:07,736
CarPlay Bluetooth EIR to

448
00:17:07,736 --> 00:17:09,366
accomplish this filtering.

449
00:17:10,636 --> 00:17:13,496
Again, as before, the driver

450
00:17:13,496 --> 00:17:15,986
selects either on the car's UI

451
00:17:16,996 --> 00:17:18,606
or on device.

452
00:17:20,665 --> 00:17:22,506
After a device has been selected

453
00:17:23,066 --> 00:17:24,526
the head unit and iPhone

454
00:17:24,596 --> 00:17:26,336
complete Bluetooth secure simple

455
00:17:26,336 --> 00:17:28,906
pairing and connect IP over

456
00:17:28,906 --> 00:17:30,896
Bluetooth and the head unit

457
00:17:30,896 --> 00:17:33,306
identifies support for the

458
00:17:33,306 --> 00:17:34,296
required messages.

459
00:17:35,646 --> 00:17:38,616
When iAP2 connects iOS will

460
00:17:38,656 --> 00:17:40,166
prompt the user to enable

461
00:17:40,166 --> 00:17:41,786
wireless CarPlay on device.

462
00:17:43,216 --> 00:17:44,876
And just as a side note, but a

463
00:17:44,876 --> 00:17:46,856
very important one, connect

464
00:17:46,856 --> 00:17:50,156
additional BT profiles only if

465
00:17:50,156 --> 00:17:51,926
the wireless access point is

466
00:17:51,926 --> 00:17:54,106
operating in the 5GHz band.

467
00:17:55,776 --> 00:17:59,106
Once iAP2 is connected iOS

468
00:17:59,106 --> 00:18:00,716
provides the device transport

469
00:17:59,106 --> 00:18:00,716
provides the device transport

470
00:18:00,716 --> 00:18:02,976
identifiers so that the head

471
00:18:02,976 --> 00:18:04,656
unit can store the device as a

472
00:18:04,656 --> 00:18:07,016
CarPlay device and recognize it

473
00:18:07,076 --> 00:18:09,016
over a different transport when

474
00:18:09,016 --> 00:18:10,536
it gets reconnected later on.

475
00:18:12,006 --> 00:18:13,266
The head unit listens to

476
00:18:13,266 --> 00:18:14,686
wireless CarPlay update

477
00:18:14,686 --> 00:18:17,836
notifications and if CarPlay is

478
00:18:17,836 --> 00:18:20,166
enabled on device it may choose

479
00:18:20,166 --> 00:18:22,256
to confirm whether to proceed

480
00:18:22,256 --> 00:18:23,366
with setup for CarPlay.

481
00:18:25,156 --> 00:18:27,216
As we saw earlier, this

482
00:18:27,266 --> 00:18:29,626
confirmation is only needed if

483
00:18:29,626 --> 00:18:31,576
the user selected the device

484
00:18:32,716 --> 00:18:34,676
through the add Bluetooth device

485
00:18:34,676 --> 00:18:35,136
menus.

486
00:18:36,536 --> 00:18:38,436
As the user initiated pairing

487
00:18:38,436 --> 00:18:39,576
through Bluetooth settings on

488
00:18:39,706 --> 00:18:41,646
iPhone we see a similar

489
00:18:41,646 --> 00:18:43,456
confirmation on iPhone as well.

490
00:18:44,806 --> 00:18:47,356
Of course, neither of those

491
00:18:47,356 --> 00:18:49,226
confirmation dialogs will be

492
00:18:49,226 --> 00:18:51,786
shown if the driver initiated

493
00:18:51,836 --> 00:18:53,916
pairing from CarPlay specific

494
00:18:53,916 --> 00:18:54,366
menus.

495
00:18:56,496 --> 00:18:58,666
Next, let's assume the user

496
00:18:58,666 --> 00:19:00,846
confirms on the device first.

497
00:18:58,666 --> 00:19:00,846
confirms on the device first.

498
00:19:01,426 --> 00:19:05,436
When that happens the device

499
00:19:05,436 --> 00:19:08,146
requests to receive the wireless

500
00:19:08,146 --> 00:19:10,226
credentials of the Wi-Fi access

501
00:19:10,226 --> 00:19:10,566
point.

502
00:19:12,466 --> 00:19:14,086
The head unit must wait for the

503
00:19:14,086 --> 00:19:15,596
user confirmation before

504
00:19:15,596 --> 00:19:16,266
responding.

505
00:19:17,476 --> 00:19:19,106
This is the time to get the

506
00:19:19,106 --> 00:19:21,806
user's consent and if needed,

507
00:19:22,026 --> 00:19:23,516
reconfigure the system for

508
00:19:23,516 --> 00:19:24,296
wireless CarPlay.

509
00:19:25,686 --> 00:19:28,226
Now the user confirms on the

510
00:19:28,226 --> 00:19:29,526
native UI as well.

511
00:19:30,826 --> 00:19:32,416
Then the head unit responds with

512
00:19:32,416 --> 00:19:35,396
the credentials and iPhone

513
00:19:35,396 --> 00:19:37,136
starts searching for the access

514
00:19:37,176 --> 00:19:39,986
point and joins it.

515
00:19:40,696 --> 00:19:42,996
From now on, exactly ask for

516
00:19:42,996 --> 00:19:43,966
wired CarPlay.

517
00:19:44,966 --> 00:19:47,186
Bonjour discovery runs and once

518
00:19:47,216 --> 00:19:49,286
the device is found the head

519
00:19:49,286 --> 00:19:51,576
unit initiates a CarPlay session

520
00:19:51,576 --> 00:19:55,216
through CarPlay Control API.

521
00:19:56,376 --> 00:19:59,256
CarPlay session follows, as well

522
00:19:59,306 --> 00:20:01,546
as connection establishment for

523
00:19:59,306 --> 00:20:01,546
as connection establishment for

524
00:20:01,606 --> 00:20:02,976
iAP2 over CarPlay.

525
00:20:04,476 --> 00:20:07,736
Note that at this point iAP2 is

526
00:20:07,736 --> 00:20:10,156
also still connected over

527
00:20:10,156 --> 00:20:10,686
Bluetooth.

528
00:20:13,776 --> 00:20:15,406
Then iPhone sends a disabled

529
00:20:15,406 --> 00:20:17,236
Bluetooth command and the head

530
00:20:17,236 --> 00:20:19,726
unit must disconnect all

531
00:20:19,726 --> 00:20:21,216
Bluetooth connections to this

532
00:20:21,266 --> 00:20:21,776
device.

533
00:20:23,466 --> 00:20:26,426
Remember that if the access

534
00:20:26,466 --> 00:20:29,976
point is operating in the 2.4GHz

535
00:20:30,076 --> 00:20:32,486
band Bluetooth needs to be

536
00:20:32,486 --> 00:20:33,906
turned off while there's an

537
00:20:34,026 --> 00:20:35,686
active CarPlay session to avoid

538
00:20:35,686 --> 00:20:36,486
interference.

539
00:20:39,416 --> 00:20:41,076
Now that the screen and video

540
00:20:41,076 --> 00:20:42,726
streams are started and the

541
00:20:42,726 --> 00:20:44,936
CarPlay UI is visible on the

542
00:20:44,936 --> 00:20:47,966
screen voila, CarPlay is running

543
00:20:47,966 --> 00:20:49,086
without any wires.

544
00:20:51,336 --> 00:20:53,726
All right, now that we saw how

545
00:20:53,726 --> 00:20:55,156
to set up wireless CarPlay

546
00:20:55,606 --> 00:20:57,196
here's some general points to

547
00:20:57,196 --> 00:20:57,616
consider.

548
00:21:00,106 --> 00:21:02,256
First, after setup is done the

549
00:21:02,256 --> 00:21:04,626
CarPlay UI is expected to show

550
00:21:04,626 --> 00:21:04,766
up.

551
00:21:06,806 --> 00:21:09,176
Then if iPhone is playing music,

552
00:21:09,416 --> 00:21:10,976
music playback will be set up

553
00:21:11,026 --> 00:21:11,596
through CarPlay.

554
00:21:13,516 --> 00:21:15,756
Lastly, the device must be

555
00:21:15,756 --> 00:21:17,826
stored as the last connected BT

556
00:21:17,826 --> 00:21:19,986
device so that it can be

557
00:21:19,986 --> 00:21:21,716
reconnected automatically later

558
00:21:21,716 --> 00:21:21,966
on.

559
00:21:25,086 --> 00:21:26,986
And with that we can conclude

560
00:21:26,986 --> 00:21:28,846
the discussion around setup and

561
00:21:28,886 --> 00:21:31,586
pairing and move to actually

562
00:21:31,586 --> 00:21:33,616
look into how a CarPlay device

563
00:21:33,656 --> 00:21:35,236
is connected when the user

564
00:21:35,236 --> 00:21:36,116
returns to the car.

565
00:21:37,546 --> 00:21:39,266
When you reconnect for CarPlay

566
00:21:39,526 --> 00:21:41,116
you need to take into account

567
00:21:41,256 --> 00:21:42,876
all devices connected to the

568
00:21:42,876 --> 00:21:45,726
system at the moment, as well as

569
00:21:46,346 --> 00:21:48,996
the state of the system before

570
00:21:48,996 --> 00:21:50,086
ignition was turned off.

571
00:21:51,976 --> 00:21:54,226
Whether CarPlay is using USB as

572
00:21:54,226 --> 00:21:56,316
the transport or the wireless

573
00:21:56,316 --> 00:21:58,546
link it's completely transparent

574
00:21:58,546 --> 00:22:01,776
to the user and depends only on

575
00:21:58,546 --> 00:22:01,776
to the user and depends only on

576
00:22:01,776 --> 00:22:03,446
how a device is connected to the

577
00:22:03,446 --> 00:22:05,516
car and in which order the

578
00:22:05,516 --> 00:22:06,476
connections happened.

579
00:22:09,036 --> 00:22:10,926
After deciding which device to

580
00:22:10,926 --> 00:22:13,636
connect to make sure the device

581
00:22:13,786 --> 00:22:15,466
still has CarPlay enabled.

582
00:22:16,736 --> 00:22:18,496
Revert to using legacy

583
00:22:18,496 --> 00:22:20,616
technologies if CarPlay is no

584
00:22:20,616 --> 00:22:21,496
longer available.

585
00:22:23,976 --> 00:22:26,076
Once the reconnection succeeds

586
00:22:26,596 --> 00:22:28,656
restore how the user used the

587
00:22:28,656 --> 00:22:29,696
system last time.

588
00:22:30,646 --> 00:22:32,576
If she was listening to FM radio

589
00:22:32,836 --> 00:22:34,176
continue playing it.

590
00:22:34,716 --> 00:22:36,376
Show the last screen the user

591
00:22:36,376 --> 00:22:38,456
was looking at either a native

592
00:22:38,456 --> 00:22:39,976
application or CarPlay.

593
00:22:41,016 --> 00:22:42,816
The user experience should

594
00:22:42,976 --> 00:22:45,176
simply continue and follow the

595
00:22:45,176 --> 00:22:45,966
user's habit.

596
00:22:48,366 --> 00:22:50,916
Lastly, once a CarPlay session

597
00:22:50,916 --> 00:22:53,246
is running on a device do not

598
00:22:53,246 --> 00:22:53,876
interrupt it.

599
00:22:55,366 --> 00:22:56,986
Imagine the driver is listening

600
00:22:56,986 --> 00:22:58,616
to her favorite song or

601
00:22:58,616 --> 00:23:01,226
navigating and a friend plugs in

602
00:22:58,616 --> 00:23:01,226
navigating and a friend plugs in

603
00:23:01,226 --> 00:23:03,686
to charge it will be disruptive

604
00:23:03,686 --> 00:23:05,586
if music all of a sudden resumed

605
00:23:05,586 --> 00:23:06,576
from the friend's phone.

606
00:23:08,496 --> 00:23:10,676
Now let's review some scenarios

607
00:23:10,996 --> 00:23:12,336
to better understand what it

608
00:23:12,336 --> 00:23:13,956
means when we say the

609
00:23:14,446 --> 00:23:15,856
reconnection depends on the

610
00:23:15,856 --> 00:23:17,896
availability and the order of

611
00:23:17,896 --> 00:23:18,386
events.

612
00:23:19,556 --> 00:23:21,106
In all these scenarios, we

613
00:23:21,106 --> 00:23:23,306
assume that the phone has been

614
00:23:23,306 --> 00:23:24,736
previously paired for wireless

615
00:23:24,736 --> 00:23:27,126
CarPlay and the system has at

616
00:23:27,126 --> 00:23:28,576
least one USB port.

617
00:23:30,386 --> 00:23:32,096
We are going to pay attention to

618
00:23:32,096 --> 00:23:33,776
when iPhone was connected over

619
00:23:33,826 --> 00:23:36,816
USB, identify a common scenario,

620
00:23:37,446 --> 00:23:39,436
and observe which transport is

621
00:23:39,436 --> 00:23:40,756
used to establish a CarPlay

622
00:23:40,756 --> 00:23:41,206
session.

623
00:23:43,676 --> 00:23:44,876
First, let's look at the

624
00:23:44,876 --> 00:23:47,476
scenario where there is just one

625
00:23:47,666 --> 00:23:48,506
iPhone in the car.

626
00:23:49,396 --> 00:23:51,456
The simplest situation is that

627
00:23:51,486 --> 00:23:53,896
the user gets back into the car

628
00:23:54,516 --> 00:23:56,356
for a short drive and keeps

629
00:23:56,356 --> 00:23:57,376
iPhone in the pocket.

630
00:23:58,526 --> 00:24:00,586
A morning commute running small

631
00:23:58,526 --> 00:24:00,586
A morning commute running small

632
00:24:00,586 --> 00:24:02,286
errands would be the perfect

633
00:24:02,286 --> 00:24:02,856
examples.

634
00:24:04,486 --> 00:24:06,506
As the only available transport

635
00:24:06,506 --> 00:24:09,426
is wireless naturally CarPlay

636
00:24:09,426 --> 00:24:10,556
runs wirelessly.

637
00:24:13,206 --> 00:24:15,946
In the next scenario, the driver

638
00:24:16,016 --> 00:24:17,846
plugs in after the drive has

639
00:24:17,846 --> 00:24:18,306
started.

640
00:24:19,926 --> 00:24:21,906
Typical usage here is just

641
00:24:21,906 --> 00:24:24,296
realizing that the phone needs

642
00:24:24,296 --> 00:24:26,026
to be charged after departing.

643
00:24:28,336 --> 00:24:30,376
In this case, the session has

644
00:24:30,376 --> 00:24:32,046
already started over wireless

645
00:24:32,656 --> 00:24:34,456
and since we do not want any

646
00:24:34,456 --> 00:24:36,966
interruptions CarPlay remains

647
00:24:36,966 --> 00:24:37,716
over wireless.

648
00:24:38,636 --> 00:24:40,616
In the next scenario, the user

649
00:24:40,616 --> 00:24:42,626
simply leaves the phone plugged

650
00:24:42,626 --> 00:24:44,336
in and gets out of the car.

651
00:24:46,286 --> 00:24:47,606
This could be a stopover at the

652
00:24:47,606 --> 00:24:49,946
gas station or simply forgetting

653
00:24:49,946 --> 00:24:52,546
the phone in the car.

654
00:24:52,806 --> 00:24:54,726
Now when the user returns the

655
00:24:54,726 --> 00:24:56,736
device is available to connect

656
00:24:56,736 --> 00:24:58,746
over both USB and wireless.

657
00:24:59,876 --> 00:25:03,116
However, usually the USB stack

658
00:24:59,876 --> 00:25:03,116
However, usually the USB stack

659
00:25:03,116 --> 00:25:05,606
resumes faster so CarPlay is

660
00:25:05,606 --> 00:25:07,006
reconnected over USB.

661
00:25:07,886 --> 00:25:09,426
Now let's look at what happens

662
00:25:09,516 --> 00:25:11,486
if the driver plugs in right

663
00:25:11,486 --> 00:25:12,736
after entering the car.

664
00:25:14,176 --> 00:25:16,356
This could be when leaving for a

665
00:25:16,356 --> 00:25:18,536
longer trip or maybe needing to

666
00:25:18,536 --> 00:25:19,516
charge right away.

667
00:25:21,456 --> 00:25:23,726
In this case, as the system is

668
00:25:23,726 --> 00:25:26,206
coming up it will bring up both

669
00:25:26,206 --> 00:25:27,996
the USB and wireless stacks.

670
00:25:29,006 --> 00:25:30,946
Since the timing will depend

671
00:25:30,946 --> 00:25:32,816
heavily on the user's behavior

672
00:25:33,386 --> 00:25:34,636
the CarPlay session will be

673
00:25:34,636 --> 00:25:36,646
started over the first available

674
00:25:36,646 --> 00:25:37,176
transport.

675
00:25:38,686 --> 00:25:41,896
If USB is up while BT or Wi-Fi

676
00:25:42,166 --> 00:25:43,966
are still reconnecting the

677
00:25:43,966 --> 00:25:45,326
session will end up being over

678
00:25:45,406 --> 00:25:45,786
USB.

679
00:25:46,566 --> 00:25:48,316
If wireless reconnected before

680
00:25:48,316 --> 00:25:50,906
USB then the session will run

681
00:25:50,906 --> 00:25:51,656
over wireless.

682
00:25:55,306 --> 00:25:57,066
In the last scenario, we

683
00:25:57,066 --> 00:25:58,716
consider multiple devices in the

684
00:25:58,716 --> 00:25:58,956
car.

685
00:26:00,776 --> 00:26:02,976
The driver might have plugged in

686
00:26:02,976 --> 00:26:04,706
right after entering the car.

687
00:26:06,046 --> 00:26:07,446
This could be a road trip with

688
00:26:07,446 --> 00:26:09,396
friends that need to charge at

689
00:26:09,436 --> 00:26:11,236
some point or want to play music

690
00:26:11,236 --> 00:26:11,946
from their phones.

691
00:26:13,516 --> 00:26:15,836
Again, as before, the session

692
00:26:15,836 --> 00:26:17,926
will initially start depending

693
00:26:17,926 --> 00:26:19,396
on the available transport.

694
00:26:21,036 --> 00:26:22,736
Later on, the driver might

695
00:26:22,736 --> 00:26:24,276
decide to change the active

696
00:26:24,276 --> 00:26:26,506
CarPlay device using the native

697
00:26:26,506 --> 00:26:27,356
user interface.

698
00:26:29,336 --> 00:26:32,646
All right, now let's see how you

699
00:26:32,646 --> 00:26:33,636
can implement all these

700
00:26:33,666 --> 00:26:34,216
scenarios.

701
00:26:35,506 --> 00:26:37,716
We can start by looking at the

702
00:26:37,716 --> 00:26:39,496
flow for wireless reconnection.

703
00:26:41,386 --> 00:26:44,296
First, wait until both Bluetooth

704
00:26:44,416 --> 00:26:46,176
and the access point are fully

705
00:26:46,176 --> 00:26:46,836
operational.

706
00:26:49,626 --> 00:26:51,166
Then check that the last

707
00:26:51,216 --> 00:26:53,046
connected device is marked for

708
00:26:53,046 --> 00:26:54,196
CarPlay on the head unit.

709
00:26:54,276 --> 00:26:59,066
If it is, make sure that there

710
00:26:59,066 --> 00:27:01,266
is no other active CarPlay

711
00:26:59,066 --> 00:27:01,266
is no other active CarPlay

712
00:27:01,266 --> 00:27:03,766
session either with the same

713
00:27:03,766 --> 00:27:06,696
device or with another wired or

714
00:27:06,696 --> 00:27:07,766
wireless device.

715
00:27:09,896 --> 00:27:11,486
If there is no other session

716
00:27:11,976 --> 00:27:14,196
proceed with connecting iAP2

717
00:27:14,196 --> 00:27:15,166
over Bluetooth.

718
00:27:17,646 --> 00:27:20,396
Once iAP2 Is connected wait to

719
00:27:20,396 --> 00:27:22,126
receive a notification that

720
00:27:22,126 --> 00:27:23,866
wireless CarPlay is enabled.

721
00:27:26,076 --> 00:27:29,476
If it is wait for the device to

722
00:27:29,476 --> 00:27:31,586
be discovered and connect.

723
00:27:33,816 --> 00:27:35,096
When the connect command is

724
00:27:35,096 --> 00:27:37,726
issued iPhone will check which

725
00:27:37,726 --> 00:27:40,616
interfaces are available and

726
00:27:40,826 --> 00:27:43,106
will initiate the session either

727
00:27:43,106 --> 00:27:45,156
over wireless or wired.

728
00:27:46,506 --> 00:27:49,396
Moving on to USB the flow looks

729
00:27:49,396 --> 00:27:50,216
fairly similar.

730
00:27:50,716 --> 00:27:52,716
You wait until the device gets

731
00:27:52,716 --> 00:27:55,676
connected, you check that there

732
00:27:55,676 --> 00:27:57,506
is no active session as we do

733
00:27:57,506 --> 00:27:58,896
not want to interrupt it.

734
00:27:59,406 --> 00:28:01,556
If there is none check that

735
00:27:59,406 --> 00:28:01,556
If there is none check that

736
00:28:01,556 --> 00:28:02,626
CarPlay is enabled.

737
00:28:03,126 --> 00:28:04,436
Then proceed with your role

738
00:28:04,436 --> 00:28:07,366
switch and selecting a device to

739
00:28:07,366 --> 00:28:07,626
connect.

740
00:28:07,706 --> 00:28:11,586
At this point again, iPhone

741
00:28:11,586 --> 00:28:13,816
checks if both the wireless and

742
00:28:13,816 --> 00:28:15,866
wired link are available and

743
00:28:15,866 --> 00:28:17,196
picks one of the two to

744
00:28:17,286 --> 00:28:19,556
establish the session.

745
00:28:20,066 --> 00:28:22,266
Then last user mode is restored

746
00:28:22,526 --> 00:28:23,926
and the driver is all set.

747
00:28:26,396 --> 00:28:28,086
In the previous two slides, we

748
00:28:28,086 --> 00:28:29,546
saw how to automatically

749
00:28:29,546 --> 00:28:31,236
reconnect to the last used

750
00:28:31,236 --> 00:28:31,666
device.

751
00:28:33,276 --> 00:28:34,946
But what happens if there are

752
00:28:34,946 --> 00:28:36,766
multiple CarPlay devices in the

753
00:28:36,766 --> 00:28:37,236
vehicle?

754
00:28:38,746 --> 00:28:40,466
They might be connected just

755
00:28:40,466 --> 00:28:43,056
over USB, just paired for

756
00:28:43,056 --> 00:28:46,386
wireless or both paired for

757
00:28:46,386 --> 00:28:48,396
wireless and connected over USB.

758
00:28:49,866 --> 00:28:51,586
One of those devices will get

759
00:28:51,586 --> 00:28:53,626
reconnected automatically, but

760
00:28:53,926 --> 00:28:56,136
as we mentioned before, the

761
00:28:56,136 --> 00:28:59,136
native UI lists all devices and

762
00:28:59,136 --> 00:29:00,786
lets the driver change the

763
00:28:59,136 --> 00:29:00,786
lets the driver change the

764
00:29:00,786 --> 00:29:02,076
active CarPlay device.

765
00:29:04,406 --> 00:29:06,476
When that happens, the head unit

766
00:29:06,476 --> 00:29:08,276
follows the same procedures to

767
00:29:08,276 --> 00:29:09,826
reconnect over the available

768
00:29:09,826 --> 00:29:10,496
transport.

769
00:29:12,446 --> 00:29:14,276
Lastly, let's talk about

770
00:29:14,276 --> 00:29:15,946
reconnecting after a session

771
00:29:15,946 --> 00:29:16,526
disconnect.

772
00:29:17,836 --> 00:29:19,206
CarPlay disconnection might

773
00:29:19,206 --> 00:29:20,656
occur for multiple reasons.

774
00:29:21,856 --> 00:29:23,786
The head unit must be aware why

775
00:29:23,786 --> 00:29:25,796
the disconnection happened and

776
00:29:25,796 --> 00:29:27,426
determine if a reconnect is

777
00:29:27,426 --> 00:29:27,936
required.

778
00:29:27,936 --> 00:29:30,846
Here are a couple of common

779
00:29:30,846 --> 00:29:33,046
scenarios and expected outcome.

780
00:29:34,806 --> 00:29:37,116
In situations where the user

781
00:29:37,166 --> 00:29:39,566
unplugs from USB or manually

782
00:29:39,566 --> 00:29:41,006
disconnects from the native UI.

783
00:29:42,566 --> 00:29:44,786
No reconnection is needed as

784
00:29:44,786 --> 00:29:46,546
there was an explicit user

785
00:29:46,546 --> 00:29:48,926
action to terminate the CarPlay

786
00:29:50,636 --> 00:29:50,786
session.

787
00:29:51,816 --> 00:29:53,856
However, if the phone is no

788
00:29:53,856 --> 00:29:56,746
longer reachable for example,

789
00:29:56,746 --> 00:29:58,746
the user walks away, turns off

790
00:29:58,746 --> 00:30:01,656
Wi-Fi or anything similar, the

791
00:29:58,746 --> 00:30:01,656
Wi-Fi or anything similar, the

792
00:30:01,656 --> 00:30:03,316
head unit is expected to do a

793
00:30:03,316 --> 00:30:05,396
fast reconnect to the same

794
00:30:05,396 --> 00:30:07,176
device using CarPlay Control

795
00:30:07,176 --> 00:30:07,486
API.

796
00:30:08,836 --> 00:30:11,636
If that fails then proceed with

797
00:30:11,636 --> 00:30:13,566
the Bluetooth reconnect to

798
00:30:13,566 --> 00:30:15,276
reestablish the CarPlay session.

799
00:30:17,316 --> 00:30:19,196
With this we have explored all

800
00:30:19,196 --> 00:30:20,876
types of CarPlay connections.

801
00:30:22,106 --> 00:30:23,606
Now let's go over some

802
00:30:23,606 --> 00:30:25,436
architectural considerations

803
00:30:25,506 --> 00:30:26,856
when designing a wireless

804
00:30:26,856 --> 00:30:27,776
CarPlay system.

805
00:30:30,656 --> 00:30:32,056
When designing a wireless

806
00:30:32,056 --> 00:30:33,886
system, you want to optimize for

807
00:30:33,886 --> 00:30:34,656
performance.

808
00:30:36,696 --> 00:30:38,146
That means that you have to

809
00:30:38,146 --> 00:30:41,796
decide which Wi-Fi protocol to

810
00:30:41,796 --> 00:30:44,106
support, what configuration to

811
00:30:44,106 --> 00:30:46,916
use and in which frequency band

812
00:30:46,916 --> 00:30:47,536
to operate.

813
00:30:49,656 --> 00:30:51,656
Next, you need to think about

814
00:30:51,926 --> 00:30:53,826
what other wireless technologies

815
00:30:53,826 --> 00:30:55,976
will be used in the vehicle and

816
00:30:55,976 --> 00:30:57,416
potential interferences.

817
00:31:00,036 --> 00:31:02,986
Services like Internet data or

818
00:31:02,986 --> 00:31:05,396
other in-car applications might

819
00:31:05,396 --> 00:31:07,406
also have an impact on the

820
00:31:07,406 --> 00:31:08,166
performance.

821
00:31:10,296 --> 00:31:12,836
With all that in mind you need

822
00:31:12,836 --> 00:31:14,216
to assure that the wireless

823
00:31:14,326 --> 00:31:15,846
performance requirements for

824
00:31:15,846 --> 00:31:17,206
CarPlay are satisfied.

825
00:31:18,196 --> 00:31:19,476
So, what do we recommend for

826
00:31:19,476 --> 00:31:20,296
wireless CarPlay?

827
00:31:21,106 --> 00:31:23,196
First, we really recommend that

828
00:31:23,196 --> 00:31:24,906
your wireless access point

829
00:31:24,906 --> 00:31:26,786
operates in the 5GHz band.

830
00:31:27,986 --> 00:31:29,306
It offers more channels to

831
00:31:29,306 --> 00:31:31,836
choose from, it's less prone to

832
00:31:31,836 --> 00:31:34,786
interference, and it is the

833
00:31:34,786 --> 00:31:36,136
least congested band.

834
00:31:36,686 --> 00:31:39,366
Please do use 5GHz whenever

835
00:31:39,366 --> 00:31:39,876
possible.

836
00:31:44,106 --> 00:31:46,986
Even though 2.4GHz is not

837
00:31:46,986 --> 00:31:48,496
recommended and is highly

838
00:31:48,496 --> 00:31:51,276
congested in some regulatory

839
00:31:51,276 --> 00:31:52,986
domains you might have to use

840
00:31:53,636 --> 00:31:53,706
it.

841
00:31:54,436 --> 00:31:57,466
Then you need to be very aware

842
00:31:57,466 --> 00:32:00,576
of coexistent scenarios and you

843
00:31:57,466 --> 00:32:00,576
of coexistent scenarios and you

844
00:32:00,576 --> 00:32:02,166
must disable the Bluetooth stack

845
00:32:02,246 --> 00:32:04,226
completely while there is an

846
00:32:04,326 --> 00:32:05,446
active CarPlay session.

847
00:32:07,766 --> 00:32:10,196
If you offer LTE connectivity on

848
00:32:10,196 --> 00:32:12,696
Band 40 your choices of

849
00:32:12,696 --> 00:32:15,086
operating channels become even

850
00:32:15,086 --> 00:32:15,996
more limited.

851
00:32:18,076 --> 00:32:20,256
Remember if you are designing a

852
00:32:20,256 --> 00:32:22,656
system which will operate in

853
00:32:22,656 --> 00:32:25,386
both bands you need to consider

854
00:32:25,436 --> 00:32:26,946
how the user experience will be

855
00:32:26,946 --> 00:32:27,496
impacted.

856
00:32:28,326 --> 00:32:30,936
In 5GHz other Bluetooth devices

857
00:32:31,116 --> 00:32:32,996
may be paired and connected in

858
00:32:32,996 --> 00:32:36,246
parallel, whereas in 2.4GHz,

859
00:32:36,796 --> 00:32:38,976
adding or connecting a second

860
00:32:38,976 --> 00:32:40,396
Bluetooth device is not

861
00:32:40,396 --> 00:32:40,896
possible.

862
00:32:45,086 --> 00:32:46,986
Some systems might choose to

863
00:32:46,986 --> 00:32:48,856
deploy multiple access points or

864
00:32:48,856 --> 00:32:51,656
dual band APs to offer a variety

865
00:32:51,656 --> 00:32:52,856
of in-car services and

866
00:32:52,856 --> 00:32:53,516
applications.

867
00:32:55,516 --> 00:32:57,146
If these access points are

868
00:32:57,146 --> 00:32:58,856
operating in the same frequency

869
00:32:58,856 --> 00:33:00,986
band they need to use different

870
00:32:58,856 --> 00:33:00,986
band they need to use different

871
00:33:00,986 --> 00:33:02,876
channels to avoid interference.

872
00:33:04,756 --> 00:33:07,286
If the access points use the

873
00:33:07,286 --> 00:33:10,556
same SSID and password they need

874
00:33:10,556 --> 00:33:12,046
to offer the same set of

875
00:33:12,176 --> 00:33:14,956
services to prevent inconsistent

876
00:33:14,956 --> 00:33:15,686
experience.

877
00:33:16,806 --> 00:33:18,856
And lastly, using hidden

878
00:33:18,856 --> 00:33:21,286
networks is not recommended for

879
00:33:21,286 --> 00:33:21,716
CarPlay.

880
00:33:25,256 --> 00:33:27,546
Finally, let's look at how to

881
00:33:27,546 --> 00:33:29,026
provide Internet data

882
00:33:29,026 --> 00:33:30,286
connectivity to iPhone.

883
00:33:31,976 --> 00:33:33,446
The head unit communicates the

884
00:33:33,446 --> 00:33:35,026
state of the Internet

885
00:33:35,076 --> 00:33:37,596
connectivity dynamically through

886
00:33:37,596 --> 00:33:40,586
the Apple Device IE and through

887
00:33:40,636 --> 00:33:41,656
the Networking IE.

888
00:33:43,456 --> 00:33:45,936
Notifications need to descend on

889
00:33:45,936 --> 00:33:46,366
changes.

890
00:33:47,206 --> 00:33:49,906
For example, to state that the

891
00:33:49,906 --> 00:33:51,576
data communication module is

892
00:33:51,576 --> 00:33:54,446
available on the system or that

893
00:33:54,476 --> 00:33:55,666
there is a failure with that

894
00:33:55,666 --> 00:33:59,586
module or that the service

895
00:33:59,586 --> 00:34:00,856
contract has expired.

896
00:33:59,586 --> 00:34:00,856
contract has expired.

897
00:34:02,866 --> 00:34:05,006
Temporary loss of connection due

898
00:34:05,006 --> 00:34:07,336
to poor cell coverage does not

899
00:34:07,336 --> 00:34:08,525
need to be communicated to

900
00:34:08,656 --> 00:34:09,016
iPhone.

901
00:34:11,266 --> 00:34:12,716
For more information about this

902
00:34:12,716 --> 00:34:14,485
session check out the session

903
00:34:14,485 --> 00:34:15,036
website.

904
00:34:16,585 --> 00:34:17,746
If you're interested in

905
00:34:17,746 --> 00:34:19,766
developing CarPlay apps check

906
00:34:19,766 --> 00:34:21,735
out the Enabling Your App for

907
00:34:21,735 --> 00:34:22,686
CarPlay session.

908
00:34:23,806 --> 00:34:25,906
Also, refer to the videos from

909
00:34:25,906 --> 00:34:27,746
last year for basic information

910
00:34:27,746 --> 00:34:28,466
about CarPlay.
