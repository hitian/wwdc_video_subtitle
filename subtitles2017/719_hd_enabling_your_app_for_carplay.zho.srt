1
00:00:18,366 --> 00:00:19,506
&gt;&gt; 大家好 欢迎来到

2
00:00:19,506 --> 00:00:20,796
让你的 app 适用于  CarPlay

3
00:00:20,796 --> 00:00:21,176
这个讲座

4
00:00:21,706 --> 00:00:22,916
我的名字是  Albert

5
00:00:22,916 --> 00:00:24,196
我是  CarPlay  团队中的一名工程师

6
00:00:25,196 --> 00:00:26,356
今天 我们将简要介绍

7
00:00:26,356 --> 00:00:27,976
app 在  CarPlay  中是怎样运行的

8
00:00:27,976 --> 00:00:29,576
怎样将你的 app 与 

9
00:00:29,576 --> 00:00:30,596
CarPlay  平台相结合

10
00:00:30,596 --> 00:00:32,546
在开发中比较规范的做法

11
00:00:32,546 --> 00:00:33,516
以及常见的错误

12
00:00:34,866 --> 00:00:36,276
我们来看一下 app 在  CarPlay  中是

13
00:00:36,276 --> 00:00:36,706
怎样运作的

14
00:00:37,246 --> 00:00:39,736
当  CarPlay  运行的时候

15
00:00:39,736 --> 00:00:41,276
CarPlay  的屏幕上

16
00:00:41,276 --> 00:00:42,446
会显示

17
00:00:42,446 --> 00:00:42,806
一些信息

18
00:00:43,476 --> 00:00:44,916
如果一个 app 给出了关于“正在播放”的元数据

19
00:00:44,916 --> 00:00:46,486
以及音频播放控制

20
00:00:46,486 --> 00:00:48,146
这些信息也会在 

21
00:00:48,146 --> 00:00:49,306
CarPlay  的主屏幕

22
00:00:49,306 --> 00:00:50,696
“正在播放”的

23
00:00:50,696 --> 00:00:52,536
app 中显示

24
00:00:53,366 --> 00:00:54,906
音频会通过车上的

25
00:00:54,906 --> 00:00:56,856
扩音器系统播放

26
00:00:56,856 --> 00:00:58,216
CarPlay  支持一些 

27
00:00:58,216 --> 00:00:59,266
SiriKit  框架中的意图

28
00:01:00,276 --> 00:01:01,826
如果用户触发了一个  CarPlay  不支持的

29
00:01:01,826 --> 00:01:03,116
SiriKit  中的意图

30
00:01:03,116 --> 00:01:04,936
Siri  会告诉用户

31
00:01:04,936 --> 00:01:06,456
这个功能

32
00:01:06,456 --> 00:01:09,876
在车中不支持

33
00:01:09,876 --> 00:01:11,206
即使你的 app 不支持  CarPlay

34
00:01:11,206 --> 00:01:13,226
用户也可以处在  CarPlay  系统中时

35
00:01:13,226 --> 00:01:14,946
在开始驾驶前

36
00:01:14,946 --> 00:01:15,826
使用你的 app

37
00:01:16,746 --> 00:01:17,876
为了保证一个良好的

38
00:01:17,876 --> 00:01:19,336
用户体验

39
00:01:19,336 --> 00:01:21,506
除非收到请求

40
00:01:21,606 --> 00:01:22,876
否则确保你的 app 不播放音频

41
00:01:22,876 --> 00:01:24,706
因为你的 app 播放的音频

42
00:01:24,706 --> 00:01:26,526
可能会与用户当前

43
00:01:26,526 --> 00:01:29,256
想要所播放的内容交叠

44
00:01:29,466 --> 00:01:31,146
在一些情况下

45
00:01:31,146 --> 00:01:32,646
你的 app 可能会与其他音频

46
00:01:32,646 --> 00:01:33,986
进行适当的互动

47
00:01:34,726 --> 00:01:36,056
对于一些例如有声书籍这种

48
00:01:36,056 --> 00:01:38,526
播放音频的 app 使用这个协议

49
00:01:38,526 --> 00:01:40,186
让你的声频在其他声频

50
00:01:40,186 --> 00:01:41,266
播放的时候暂停

51
00:01:42,226 --> 00:01:43,526
对于不时发出指示的

52
00:01:43,526 --> 00:01:44,866
导航的 app

53
00:01:44,866 --> 00:01:47,146
使用这两个协议

54
00:01:47,146 --> 00:01:48,796
第二个协议将会在开始你的音频对话之前

55
00:01:48,796 --> 00:01:50,536
暂停标为

56
00:01:50,536 --> 00:01:51,956
“spoken audio” 的音频

57
00:01:51,956 --> 00:01:53,246
的播放

58
00:01:53,796 --> 00:01:56,336
因为你的导航音频将会

59
00:01:56,336 --> 00:01:58,176
与其他音频混合播放

60
00:01:58,176 --> 00:01:59,976
将你的音频对话标为“可以混合”

61
00:01:59,976 --> 00:02:01,436
以便与其他音频

62
00:01:59,976 --> 00:02:01,436
以便与其他音频

63
00:02:01,436 --> 00:02:02,146
互动

64
00:02:02,686 --> 00:02:05,816
那些与  CarPlay 

65
00:02:05,816 --> 00:02:07,646
结合程度高的那些 app

66
00:02:07,646 --> 00:02:09,026
会显示在  CarPlay  的

67
00:02:09,026 --> 00:02:09,386
主页面

68
00:02:10,066 --> 00:02:11,096
在  CarPlay  中

69
00:02:11,096 --> 00:02:12,506
运行的 app

70
00:02:12,506 --> 00:02:14,236
会在  CarPlay  和 

71
00:02:14,236 --> 00:02:15,246
iPhone  的屏幕上显示

72
00:02:16,216 --> 00:02:17,466
对于没有结合  CarPlay  的 app

73
00:02:17,466 --> 00:02:19,326
只有  iPhone  屏幕上

74
00:02:19,326 --> 00:02:20,596
会显示这个 app

75
00:02:20,596 --> 00:02:22,586
CarPlay  屏幕上

76
00:02:22,586 --> 00:02:23,606
只显示主页面

77
00:02:24,146 --> 00:02:27,306
有一些种类的 app

78
00:02:27,306 --> 00:02:28,676
可以支持

79
00:02:28,676 --> 00:02:29,646
与  CarPlay  的高度结合

80
00:02:30,576 --> 00:02:32,406
这些包括音频 app 短信

81
00:02:32,406 --> 00:02:34,056
语音通话以及汽车生产商的

82
00:02:34,056 --> 00:02:34,376
app

83
00:02:35,096 --> 00:02:37,266
音频 app 可以播放音乐 新闻

84
00:02:37,596 --> 00:02:39,856
播客以及其他音频内容

85
00:02:39,856 --> 00:02:41,636
并且要遵循一定的设计理念

86
00:02:41,636 --> 00:02:43,016
即适合在车中使用

87
00:02:44,116 --> 00:02:45,636
采用  Siri  的短信和语音通话 app

88
00:02:45,636 --> 00:02:47,976
可以经过升级

89
00:02:47,976 --> 00:02:48,816
适用于  CarPlay

90
00:02:49,836 --> 00:02:51,366
汽车生产商的 app

91
00:02:51,366 --> 00:02:53,156
可以有特定的汽车控制及显示的功能

92
00:02:53,496 --> 00:02:54,646
让驾驶者使用这些功能时

93
00:02:54,646 --> 00:02:55,786
不必离开  CarPlay  的环境

94
00:02:57,176 --> 00:02:58,396
如果你认为你的短信 语音通话

95
00:02:58,456 --> 00:03:00,436
或汽车生产商的 app

96
00:02:58,456 --> 00:03:00,436
或汽车生产商的 app

97
00:03:00,436 --> 00:03:01,976
有可能支持  CarPlay

98
00:03:01,976 --> 00:03:04,116
请在  CarPlay 

99
00:03:04,116 --> 00:03:05,196
开发者页面

100
00:03:05,196 --> 00:03:05,936
告诉我们

101
00:03:06,656 --> 00:03:08,186
在那里你可以为你的 app

102
00:03:08,186 --> 00:03:09,506
申请权限

103
00:03:09,506 --> 00:03:10,256
以便与  CarPlay  结合

104
00:03:10,786 --> 00:03:14,436
不要忘记一些内容和图像

105
00:03:14,436 --> 00:03:15,766
需要为  CarPlay  特制

106
00:03:15,826 --> 00:03:17,686
图像要  2-3  倍大

107
00:03:17,686 --> 00:03:20,116
因为根据不同车的

108
00:03:20,236 --> 00:03:21,546
屏幕规格

109
00:03:21,546 --> 00:03:23,226
CarPlay  的屏幕有

110
00:03:23,606 --> 00:03:24,576
不同的大小

111
00:03:24,576 --> 00:03:25,036
和分辨率

112
00:03:26,096 --> 00:03:27,706
关于图标和  CarPlay 

113
00:03:27,706 --> 00:03:28,966
app 设计的更多信息

114
00:03:29,486 --> 00:03:30,826
请参照  iOS Human Interface Guidelines 

115
00:03:30,826 --> 00:03:32,036
以及 

116
00:03:32,036 --> 00:03:33,086
CarPlay Human Interface

117
00:03:33,086 --> 00:03:33,626
Guidelines

118
00:03:36,056 --> 00:03:37,326
你可以用  Xcode  中的  iOS  模拟器

119
00:03:37,326 --> 00:03:39,956
测试  CarPlay  的 app

120
00:03:40,006 --> 00:03:41,696
但是为达到最好的

121
00:03:41,696 --> 00:03:42,946
真实的测试效果

122
00:03:42,946 --> 00:03:44,726
最好连接真正的设备

123
00:03:44,766 --> 00:03:45,216
在车中测试

124
00:03:46,236 --> 00:03:47,586
对于播放音频的 app

125
00:03:47,746 --> 00:03:48,906
模拟器在播放状态下

126
00:03:48,906 --> 00:03:50,336
有一些局限

127
00:03:50,756 --> 00:03:52,106
不能反映

128
00:03:52,106 --> 00:03:53,566
真正的用户体验

129
00:03:54,696 --> 00:03:55,976
为了用  LLDB  全面调试你的 app

130
00:03:55,976 --> 00:03:58,586
Xcode  现在支持无线调试

131
00:03:58,586 --> 00:04:00,036
在调试你的 app 

132
00:03:58,586 --> 00:04:00,036
在调试你的 app 

133
00:04:00,186 --> 00:04:01,676
的过程中  iPhone

134
00:04:01,676 --> 00:04:03,336
可以连接在车上

135
00:04:03,456 --> 00:04:04,416
或是车配件上

136
00:04:05,156 --> 00:04:06,786
更多信息

137
00:04:06,786 --> 00:04:08,016
请参照这一周  WWDC  中

138
00:04:08,016 --> 00:04:09,786
“Xcode  9  调试程序” 

139
00:04:09,786 --> 00:04:11,076
这一讲座

140
00:04:11,656 --> 00:04:14,976
如果你的 app

141
00:04:14,976 --> 00:04:17,096
对用户数据使用数据保护

142
00:04:17,096 --> 00:04:18,685
不要忘记  CarPlay  可能是在

143
00:04:18,685 --> 00:04:20,096
iPhone  被密码锁住的

144
00:04:20,096 --> 00:04:20,796
状态下运行

145
00:04:21,736 --> 00:04:22,866
如果你的 app 有密码保护的数据

146
00:04:22,866 --> 00:04:24,156
对文件

147
00:04:24,156 --> 00:04:25,696
钥匙串

148
00:04:26,726 --> 00:04:29,696
或  SQL  数据库使用了以下的类别

149
00:04:29,696 --> 00:04:31,476
你的数据可能

150
00:04:31,476 --> 00:04:33,316
在  CarPlay  中无法使用

151
00:04:33,316 --> 00:04:34,116
你的 app 可能会有

152
00:04:34,116 --> 00:04:34,856
异常的表现

153
00:04:35,546 --> 00:04:38,626
让我们仔细的看一下

154
00:04:38,626 --> 00:04:39,856
怎样让你的 app

155
00:04:39,856 --> 00:04:40,286
与  CarPlay  相结合

156
00:04:40,846 --> 00:04:42,946
我们重点举出了三类

157
00:04:42,946 --> 00:04:44,356
支持  CarPlay  集成

158
00:04:44,356 --> 00:04:46,496
音频 app

159
00:04:46,896 --> 00:04:48,366
短讯和语音通话

160
00:04:48,366 --> 00:04:49,196
以及汽车生产商的 app

161
00:04:49,726 --> 00:04:52,186
让我们从音频 app

162
00:04:52,936 --> 00:04:53,036
开始

163
00:04:54,446 --> 00:04:55,966
在  CarPlay  中

164
00:04:55,966 --> 00:04:57,436
音频 app 的用户界面

165
00:04:57,486 --> 00:04:58,756
根据平台而优化

166
00:04:59,276 --> 00:05:00,696
为用户提供一个

167
00:04:59,276 --> 00:05:00,696
为用户提供一个

168
00:05:00,696 --> 00:05:02,146
很容易使用的操作系统

169
00:05:02,146 --> 00:05:02,626
便于获得他们想得到的内容

170
00:05:03,426 --> 00:05:04,876
音频 app 的开发者

171
00:05:04,876 --> 00:05:06,186
提供数据来源

172
00:05:06,186 --> 00:05:07,826
和导航操作的框架

173
00:05:07,826 --> 00:05:09,266
以便  CarPlay  的平台

174
00:05:09,266 --> 00:05:09,756
在屏幕上显示

175
00:05:10,276 --> 00:05:13,056
另外 “正在播放” 的信息

176
00:05:13,056 --> 00:05:14,466
会显示给用户

177
00:05:14,466 --> 00:05:16,006
相关的元数据

178
00:05:16,006 --> 00:05:17,916
以及一些可以调节的操作选项

179
00:05:17,916 --> 00:05:19,526
以便用户操纵播放速度 播放曲目

180
00:05:19,526 --> 00:05:21,416
和其他的一些

181
00:05:21,416 --> 00:05:22,746
音频 app 可能支持的

182
00:05:22,746 --> 00:05:23,216
选项

183
00:05:25,156 --> 00:05:26,176
app 在获得  CarPlay 

184
00:05:26,176 --> 00:05:27,506
的权限之后

185
00:05:27,506 --> 00:05:29,076
CarPlay  必须至少实现  MP

186
00:05:29,226 --> 00:05:30,496
可播放的  API

187
00:05:30,496 --> 00:05:32,736
包括数据来源

188
00:05:32,736 --> 00:05:34,226
和委托

189
00:05:34,226 --> 00:05:35,406
这样  CarPlay  才能

190
00:05:35,406 --> 00:05:36,916
获取内容

191
00:05:36,946 --> 00:05:37,376
和开始播放

192
00:05:38,596 --> 00:05:40,386
音频的 app 必须响应

193
00:05:40,496 --> 00:05:42,016
MPRemoteCommandCenter  事件 

194
00:05:42,566 --> 00:05:43,716
让用户对你的内容发送指令

195
00:05:43,716 --> 00:05:45,136
例如播放 暂停

196
00:05:45,136 --> 00:05:47,766
或跳过曲目

197
00:05:48,536 --> 00:05:50,626
最后 音频 app 必须

198
00:05:50,626 --> 00:05:51,256
设定和更新 

199
00:05:51,256 --> 00:05:52,456
MPNowPlayingInfoCenter  字典

200
00:05:52,456 --> 00:05:54,066
这其中包括

201
00:05:54,066 --> 00:05:55,876
正在播放曲目的元数据

202
00:05:55,876 --> 00:05:57,416
例如

203
00:05:57,416 --> 00:05:59,366
艺术家名称

204
00:05:59,366 --> 00:05:59,646
和时长

205
00:06:00,166 --> 00:06:02,786
让我们看一下

206
00:06:02,786 --> 00:06:04,046
音频 app 的

207
00:06:04,046 --> 00:06:04,326
数据结构

208
00:06:05,186 --> 00:06:06,506
CarPlay  会使用  NSIndexPath

209
00:06:06,506 --> 00:06:08,856
根据特定的路径

210
00:06:08,856 --> 00:06:09,976
来找寻内容

211
00:06:10,396 --> 00:06:11,606
这与  UITableView  中

212
00:06:11,606 --> 00:06:13,316
NSIndexPath  的使用

213
00:06:13,316 --> 00:06:14,016
有所不同

214
00:06:15,006 --> 00:06:16,006
让我们来看一个例子

215
00:06:16,006 --> 00:06:17,926
这个例子中最左边的内容

216
00:06:17,926 --> 00:06:19,616
是根数据项

217
00:06:19,806 --> 00:06:20,936
在用户界面中

218
00:06:20,936 --> 00:06:22,696
可以用单个的窗口

219
00:06:22,696 --> 00:06:24,246
或者是根子表的形式来体现

220
00:06:24,736 --> 00:06:27,686
这里是在整个数据结构中

221
00:06:27,686 --> 00:06:29,156
每个内容的

222
00:06:29,156 --> 00:06:29,806
路径

223
00:06:30,586 --> 00:06:32,216
当  CarPlay  根据某个路径目录

224
00:06:32,216 --> 00:06:33,776
要求某个内容的时候

225
00:06:34,076 --> 00:06:35,526
音频的 app 会

226
00:06:35,526 --> 00:06:36,846
遍历整个结构

227
00:06:36,846 --> 00:06:38,046
来查找所需的内容

228
00:06:38,836 --> 00:06:40,656
在这个例子里

229
00:06:40,656 --> 00:06:42,576
我们要求第一个内容下面的第一个元素

230
00:06:42,576 --> 00:06:44,366
也就是 “Running”

231
00:06:44,366 --> 00:06:47,636
这个播放列表

232
00:06:47,846 --> 00:06:49,196
CarPlay  还会询问某一个目录下面

233
00:06:49,196 --> 00:06:50,656
包含的子元素的

234
00:06:50,656 --> 00:06:51,636
数量

235
00:06:52,196 --> 00:06:53,776
在这个例子里 我们询问

236
00:06:53,776 --> 00:06:55,056
第二个内容下的

237
00:06:55,206 --> 00:06:56,826
第三级中的

238
00:06:56,826 --> 00:06:58,136
子元素数量

239
00:06:59,116 --> 00:07:01,336
在这个例子中

240
00:06:59,116 --> 00:07:01,336
在这个例子中

241
00:07:01,926 --> 00:07:01,996
数量是 2

242
00:07:04,046 --> 00:07:05,356
一些车型可能会根据车辆

243
00:07:05,356 --> 00:07:07,176
是否在行驶状态

244
00:07:07,246 --> 00:07:08,656
而限制屏幕上

245
00:07:08,656 --> 00:07:09,206
可显示的内容

246
00:07:09,926 --> 00:07:11,116
这可能会限制屏幕上

247
00:07:11,116 --> 00:07:13,146
可显示的的行数

248
00:07:13,146 --> 00:07:14,566
以及点击进某一个目录后

249
00:07:14,566 --> 00:07:15,216
可显示的内容

250
00:07:16,016 --> 00:07:17,266
你的 app 可以利用

251
00:07:17,266 --> 00:07:19,026
MPPlayableContentManager

252
00:07:19,026 --> 00:07:19,826
来处理这些变化

253
00:07:20,386 --> 00:07:23,086
查询所显示的内容是否会受到限制

254
00:07:23,086 --> 00:07:24,806
使用

255
00:07:24,806 --> 00:07:26,176
DelegateCallbackContentManagerDidUpdate

256
00:07:26,176 --> 00:07:28,576
来查询内容

257
00:07:28,576 --> 00:07:29,736
是否会受限

258
00:07:30,446 --> 00:07:31,836
用这种方法 你的 app 可以

259
00:07:31,836 --> 00:07:33,196
查询环境属性

260
00:07:33,196 --> 00:07:34,596
就可以知道

261
00:07:34,596 --> 00:07:36,476
表格视图中

262
00:07:36,476 --> 00:07:37,806
允许多少项内容

263
00:07:37,806 --> 00:07:39,416
以及你的 app 最多可以

264
00:07:39,416 --> 00:07:39,776
显示几层菜单

265
00:07:40,336 --> 00:07:42,816
如果你的 app

266
00:07:42,816 --> 00:07:44,446
更适合页面

267
00:07:44,506 --> 00:07:45,866
而不是表格视图

268
00:07:45,866 --> 00:07:48,026
你可以通过将

269
00:07:48,026 --> 00:07:49,596
UIBrowsableContentSupportSectionBrowsing

270
00:07:49,596 --> 00:07:51,596
加到的你属性列表中

271
00:07:51,636 --> 00:07:52,856
来增加页面

272
00:07:53,746 --> 00:07:55,286
我们推荐最多使用  4  个页面

273
00:07:55,286 --> 00:07:57,616
并使用短的标题

274
00:07:57,616 --> 00:07:58,766
因为视窗的空间有限

275
00:07:58,766 --> 00:07:59,886
并且有些汽车的屏幕比较窄

276
00:07:59,886 --> 00:08:01,526
而且在播放内容的同时

277
00:07:59,886 --> 00:08:01,526
而且在播放内容的同时

278
00:08:01,526 --> 00:08:02,646
还需显示

279
00:08:02,646 --> 00:08:04,076
“正在播放”的

280
00:08:04,076 --> 00:08:04,376
按钮

281
00:08:05,456 --> 00:08:06,666
页面的图像会在 

282
00:08:06,666 --> 00:08:08,216
CarPlay  的屏幕上

283
00:08:08,216 --> 00:08:09,016
做为模版图像显示

284
00:08:09,016 --> 00:08:12,096
让我们看一下  CarPlay  中

285
00:08:12,096 --> 00:08:13,196
“正在播放” 的屏幕

286
00:08:13,866 --> 00:08:15,566
一些控制选项和元数据

287
00:08:15,616 --> 00:08:16,906
与控制中心中显示的

288
00:08:16,906 --> 00:08:17,656
是一样的

289
00:08:18,466 --> 00:08:20,046
总的来说

290
00:08:20,046 --> 00:08:21,696
你在控制中心中所看到的选项与数据

291
00:08:21,696 --> 00:08:23,186
在  CarPlay  的 “正在播放” 屏幕中

292
00:08:23,186 --> 00:08:24,806
也应该有所显示

293
00:08:25,876 --> 00:08:27,266
要调出这个“正在播放”的屏幕

294
00:08:27,266 --> 00:08:28,766
用户可以点击你

295
00:08:28,766 --> 00:08:30,356
app 视图右上角的

296
00:08:30,356 --> 00:08:31,596
“正在播放”

297
00:08:31,596 --> 00:08:33,486
或通过点击  CarPlay  主页面上的

298
00:08:33,486 --> 00:08:34,796
“正在播放”

299
00:08:34,796 --> 00:08:35,145
app 图标

300
00:08:36,236 --> 00:08:37,726
运行过程中 你的  app  的名字会显示在

301
00:08:37,726 --> 00:08:38,986
“正在播放” 的屏幕

302
00:08:38,986 --> 00:08:42,116
的右上方

303
00:08:44,116 --> 00:08:45,666
“正在播放” 屏幕的元数据

304
00:08:45,666 --> 00:08:46,776
与设置控制中心等

305
00:08:46,776 --> 00:08:47,336
相同

306
00:08:47,956 --> 00:08:49,446
在 MPNowPlayingInfoCenter 中

307
00:08:49,446 --> 00:08:51,496
设置一个信息字典

308
00:08:51,496 --> 00:08:52,806
提供尽可能多的

309
00:08:52,806 --> 00:08:53,436
信息

310
00:08:53,966 --> 00:08:57,556
另外 对播放指令做出回应

311
00:08:57,556 --> 00:08:58,866
这样用户可以对内容做出调整

312
00:08:58,866 --> 00:09:00,906
例如播放 暂停

313
00:08:58,866 --> 00:09:00,906
例如播放 暂停

314
00:09:00,956 --> 00:09:03,986
跳过曲目

315
00:09:03,986 --> 00:09:05,416
随机播放或重复播放

316
00:09:05,416 --> 00:09:05,666
歌单

317
00:09:06,726 --> 00:09:08,326
这些是 CarPlay

318
00:09:08,326 --> 00:09:09,266
“正在播放” 的界面

319
00:09:09,266 --> 00:09:10,456
支持的指令

320
00:09:10,996 --> 00:09:14,466
在新的 iSO 11 中

321
00:09:14,466 --> 00:09:15,936
“正在播放” 的界面支持显示

322
00:09:15,936 --> 00:09:17,256
和调整播放速度

323
00:09:17,916 --> 00:09:19,366
在  CarPlay  里

324
00:09:19,366 --> 00:09:20,456
要想在你的 app 中“正在播放” 的界面里

325
00:09:20,456 --> 00:09:23,016
显示播放的速度

326
00:09:23,016 --> 00:09:24,926
需要将  MPNowPlayingInfo PropertyDefaultPlaybackRate

327
00:09:24,966 --> 00:09:26,796
加到  MP Now Playing Info Center  里

328
00:09:26,796 --> 00:09:28,186
并且利用  MPRemoteCommandCenter  里

329
00:09:28,186 --> 00:09:29,576
存有所支持的一系列的播放速度的数组

330
00:09:29,576 --> 00:09:30,596
来对调整播放速度的指令

331
00:09:30,596 --> 00:09:31,676
做出反应

332
00:09:32,166 --> 00:09:34,696
这里有一个代码的例子

333
00:09:34,696 --> 00:09:36,006
展示了怎样实现

334
00:09:36,006 --> 00:09:36,876
调整播放速度

335
00:09:37,406 --> 00:09:38,806
在这个例子中

336
00:09:38,806 --> 00:09:40,146
默认的当前曲目的播放速度为 x1

337
00:09:40,146 --> 00:09:42,246
支持的 

338
00:09:42,246 --> 00:09:43,656
播放速度有

339
00:09:43,656 --> 00:09:47,616
0.5 1.0 1.5  和  2.0

340
00:09:48,316 --> 00:09:49,566
若用户想要调整播放速度

341
00:09:49,566 --> 00:09:51,036
当播放速度不断增加 当增加至

342
00:09:51,036 --> 00:09:52,796
所支持的最快播放速度时

343
00:09:52,796 --> 00:09:54,156
播放速度

344
00:09:54,156 --> 00:09:55,486
会循环到

345
00:09:55,486 --> 00:09:56,146
最小值

346
00:09:57,046 --> 00:09:58,646
在这个例子里

347
00:09:58,646 --> 00:10:01,056
播放速度会增加到 1.5

348
00:09:58,646 --> 00:10:01,056
播放速度会增加到 1.5

349
00:10:01,056 --> 00:10:02,976
然后到  2.0  然后回到  0.5

350
00:10:03,976 --> 00:10:07,176
一些音频 app 会响应 

351
00:10:07,176 --> 00:10:08,756
MP  遥控指令中心中的

352
00:10:08,756 --> 00:10:09,396
多项指令

353
00:10:10,106 --> 00:10:11,326
根据指令的不同

354
00:10:11,326 --> 00:10:12,906
运行中的  CarPlay  “正在播放”界面

355
00:10:12,906 --> 00:10:14,526
将会结合响应的指令

356
00:10:14,526 --> 00:10:15,966
转化为一个按钮

357
00:10:15,966 --> 00:10:18,186
例如省略号

358
00:10:18,186 --> 00:10:19,576
或一个菜单按钮来替代

359
00:10:19,576 --> 00:10:20,516
之前的按钮

360
00:10:20,626 --> 00:10:25,176
规范的做法

361
00:10:25,176 --> 00:10:26,536
在调用  MP playable content data source 

362
00:10:26,536 --> 00:10:28,096
和 MP playable content 

363
00:10:28,166 --> 00:10:29,386
委托中的

364
00:10:29,386 --> 00:10:31,286
完成指针之前

365
00:10:31,286 --> 00:10:32,726
将要播放的内容

366
00:10:32,726 --> 00:10:33,466
准备好

367
00:10:34,266 --> 00:10:35,576
对于那些不用页面

368
00:10:35,576 --> 00:10:37,226
只用表格视图的 app

369
00:10:37,756 --> 00:10:39,326
根表格必须返回

370
00:10:39,326 --> 00:10:40,166
至少一项内容

371
00:10:40,886 --> 00:10:42,306
CarPlay  会显示一个

372
00:10:42,306 --> 00:10:44,036
读取任务进行情况的指示

373
00:10:44,036 --> 00:10:45,816
如果 app 在一定时限内

374
00:10:45,816 --> 00:10:46,916
没有返回内容

375
00:10:46,916 --> 00:10:47,376
就会超时

376
00:10:47,856 --> 00:10:49,996
如果你的 app 需要一些初始的设置

377
00:10:49,996 --> 00:10:51,626
比如登入的信息

378
00:10:52,066 --> 00:10:53,416
在页面的第一行

379
00:10:53,416 --> 00:10:54,936
应该提示用户 

380
00:10:54,936 --> 00:10:56,386
app  当前的状态

381
00:10:57,596 --> 00:10:58,786
关于使用音频的  app  就是这些内容

382
00:10:58,786 --> 00:10:59,936
下面  Chris Whitney  将会讨论 

383
00:10:59,936 --> 00:11:01,196
CarPlay  中

384
00:10:59,936 --> 00:11:01,196
CarPlay  中

385
00:11:01,226 --> 00:11:02,326
有关短息

386
00:11:02,326 --> 00:11:02,636
和语音通话的 app

387
00:11:05,566 --> 00:11:06,856
&gt;&gt; 大家好 我是  Chris Whitney

388
00:11:06,856 --> 00:11:08,016
来自  CarPlay  工程师团队

389
00:11:08,726 --> 00:11:10,246
Albert  谈到了关于使用音频的  app

390
00:11:10,366 --> 00:11:11,666
下面我会讲解一些其他类别的

391
00:11:11,666 --> 00:11:13,026
可以与  CarPlay 

392
00:11:13,026 --> 00:11:13,906
相结合的  app

393
00:11:14,776 --> 00:11:16,516
我要讲解的第一类

394
00:11:16,746 --> 00:11:18,456
是短信

395
00:11:18,456 --> 00:11:20,986
以及用网络协议传输语音的打电话的 app

396
00:11:22,086 --> 00:11:23,706
在 CarPlay 中  Siri  为

397
00:11:23,706 --> 00:11:26,036
短信以及语音通话  app

398
00:11:26,036 --> 00:11:26,806
提供接口

399
00:11:27,696 --> 00:11:29,296
在主页面上

400
00:11:29,296 --> 00:11:31,176
当  app  的图标被选中后

401
00:11:31,176 --> 00:11:32,556
Siri  提供读信息 建立新信息

402
00:11:32,556 --> 00:11:34,666
或开始语音通话

403
00:11:34,976 --> 00:11:36,196
这几种选择

404
00:11:37,226 --> 00:11:39,506
使用了  SiriKit  的  app  已经可以支持这些互动

405
00:11:39,506 --> 00:11:41,136
但对  Siri  发出的 

406
00:11:41,136 --> 00:11:43,216
请求中必须包含

407
00:11:43,216 --> 00:11:43,806
app  的名字

408
00:11:45,226 --> 00:11:46,566
经过一些改动

409
00:11:47,006 --> 00:11:49,626
短信和语音通话的  app  在  CarPlay  中

410
00:11:49,626 --> 00:11:50,866
可以包含一个主页面的图标

411
00:11:50,866 --> 00:11:52,326
提示

412
00:11:52,786 --> 00:11:54,956
以及一个专门的

413
00:11:54,956 --> 00:11:55,936
Siri  接口

414
00:11:56,476 --> 00:12:00,606
这里是  CarPlay  中

415
00:11:56,476 --> 00:12:00,606
这里是  CarPlay  中

416
00:12:00,606 --> 00:12:02,606
支持短信和语音通信的  app

417
00:12:02,606 --> 00:12:03,746
所要满足的要求

418
00:12:05,386 --> 00:12:07,326
app 必须使用

419
00:12:07,326 --> 00:12:09,706
SiriKit  中的短讯意图

420
00:12:09,706 --> 00:12:10,626
并有专门针对 

421
00:12:10,626 --> 00:12:11,976
CarPlay  短讯的

422
00:12:11,976 --> 00:12:12,796
授权

423
00:12:14,336 --> 00:12:16,906
同样的 语音通话 app

424
00:12:17,136 --> 00:12:18,816
必须使用

425
00:12:18,816 --> 00:12:20,776
SiriKit  中的通话意图

426
00:12:20,776 --> 00:12:22,116
并有专门针对

427
00:12:22,116 --> 00:12:23,656
CarPlay  语音通讯的

428
00:12:23,656 --> 00:12:24,016
授权

429
00:12:25,336 --> 00:12:27,046
语音通话  app  还必须使用 

430
00:12:27,046 --> 00:12:28,966
CallKit 来通知 

431
00:12:28,966 --> 00:12:30,436
CarPlay  通话的

432
00:12:30,436 --> 00:12:30,756
状态

433
00:12:31,426 --> 00:12:34,346
一个  app  在  CarPlay  中

434
00:12:34,346 --> 00:12:36,286
可以同时支持短信

435
00:12:36,286 --> 00:12:36,686
和语音通话

436
00:12:38,106 --> 00:12:39,366
让我们看一下更多

437
00:12:39,366 --> 00:12:43,396
关于  SiriKit  技术要求的细节

438
00:12:43,546 --> 00:12:46,466
对于短信  app

439
00:12:46,466 --> 00:12:47,636
Siri  通过 

440
00:12:47,826 --> 00:12:49,056
INSendMessageIntent  发送信息

441
00:12:50,626 --> 00:12:53,146
Siri  通过  INSearchforMessagesIntent

442
00:12:53,526 --> 00:12:55,296
读取新收到的信息

443
00:12:55,546 --> 00:12:57,576
并搜寻未读信息

444
00:12:58,506 --> 00:13:00,756
读信息的过程完成后

445
00:12:58,506 --> 00:13:00,756
读信息的过程完成后

446
00:13:00,756 --> 00:13:02,656
Siri  通过调用  INSendMessageAttributeIntent

447
00:13:02,846 --> 00:13:04,626
将信息标记为已读

448
00:13:05,666 --> 00:13:07,646
这三个意图在  CarPlay  中

449
00:13:07,646 --> 00:13:09,296
是支持一个完整的信息读取过程

450
00:13:09,296 --> 00:13:10,576
所必须用到的

451
00:13:11,166 --> 00:13:15,626
对于语音通话  app

452
00:13:15,626 --> 00:13:17,946
Siri  通过调用  INStartAudiCallIntent 

453
00:13:18,156 --> 00:13:20,916
来开始通话

454
00:13:21,526 --> 00:13:23,466
关于搜索 例如搜索未接来电

455
00:13:23,466 --> 00:13:25,336
则通过调用

456
00:13:25,486 --> 00:13:27,146
INSearchCallHistoryIntent

457
00:13:28,386 --> 00:13:30,046
这些意图是在  CarPlay  中

458
00:13:30,046 --> 00:13:31,526
完成一个通话流程

459
00:13:31,526 --> 00:13:33,546
所必备的

460
00:13:34,526 --> 00:13:36,986
关于  SirKit  的细节

461
00:13:36,986 --> 00:13:39,176
请参见“SiriKit  最新更新”

462
00:13:39,716 --> 00:13:41,736
以及“创造最好的 

463
00:13:41,736 --> 00:13:42,386
SiriKit  体验”

464
00:13:42,476 --> 00:13:46,956
任何已经使用了  CallKit  的  app

465
00:13:46,956 --> 00:13:49,176
都有一个  CarPlay  的接口

466
00:13:49,176 --> 00:13:50,886
用来处理新来电以及

467
00:13:50,986 --> 00:13:51,816
正在通话中的来电

468
00:13:52,836 --> 00:13:54,096
但如果你的语音通话  app

469
00:13:54,476 --> 00:13:56,186
还没有使用  CallKit

470
00:13:56,806 --> 00:13:58,136
这样是结合  CarPlay 

471
00:13:58,136 --> 00:13:59,046
所必须的一个要求

472
00:14:00,016 --> 00:14:02,226
总体来说  app  必须

473
00:14:02,226 --> 00:14:04,396
在接到来电时通知  CallKit

474
00:14:04,396 --> 00:14:07,166
来处理开始

475
00:14:07,416 --> 00:14:09,266
接听和挂断的行为

476
00:14:10,446 --> 00:14:11,666
如果该  app  的语音通话平台支持其他行为

477
00:14:11,666 --> 00:14:14,256
例如无声 群组

478
00:14:14,256 --> 00:14:16,616
来电等待和键盘声音

479
00:14:16,616 --> 00:14:18,366
那么这些活动也应该

480
00:14:18,496 --> 00:14:18,976
在  app  中实现

481
00:14:20,746 --> 00:14:22,236
关于  CallKit  的更多信息

482
00:14:22,936 --> 00:14:24,576
请观看  2016  WWDC

483
00:14:24,576 --> 00:14:26,256
“用  CallKit  提高语音通话 app”

484
00:14:26,256 --> 00:14:28,216
的视频

485
00:14:30,686 --> 00:14:32,426
app  可以在  CarPlay  中

486
00:14:32,426 --> 00:14:34,486
显示新信息

487
00:14:34,836 --> 00:14:35,726
和未接来电的提示

488
00:14:36,546 --> 00:14:37,706
在  CarPlay  中显示提示

489
00:14:37,706 --> 00:14:39,306
需要一些

490
00:14:39,306 --> 00:14:39,746
其他的设置

491
00:14:40,376 --> 00:14:42,886
在请求提示通知授权的时候

492
00:14:42,886 --> 00:14:44,136
CarPlay  必须

493
00:14:44,136 --> 00:14:45,936
包含在其中

494
00:14:46,336 --> 00:14:48,826
并且信息必须单独在一个提示的类别中

495
00:14:48,826 --> 00:14:50,976
通过  CarPlay  选项中

496
00:14:50,976 --> 00:14:53,416
允许这个选项

497
00:14:53,416 --> 00:14:54,666
来实现

498
00:14:55,916 --> 00:14:58,206
提示这个类别

499
00:14:58,206 --> 00:15:00,256
仅限使用于信息

500
00:14:58,206 --> 00:15:00,256
仅限使用于信息

501
00:15:00,456 --> 00:15:01,876
不应该

502
00:15:01,956 --> 00:15:03,226
用于其他  

503
00:15:03,226 --> 00:15:03,746
app 提示信息

504
00:15:04,296 --> 00:15:08,486
提示这个类别必须指定一个 

505
00:15:08,486 --> 00:15:11,036
SiriKit  的意图

506
00:15:11,036 --> 00:15:11,956
来处理  CarPlay  中的

507
00:15:11,956 --> 00:15:15,296
对提示的选择

508
00:15:15,406 --> 00:15:17,286
只满足  CarPlay  的短信

509
00:15:17,286 --> 00:15:18,566
或语音通话的  app

510
00:15:18,566 --> 00:15:20,036
才会被允许

511
00:15:20,036 --> 00:15:21,486
请求发出

512
00:15:21,486 --> 00:15:22,696
显示通知的授权

513
00:15:24,386 --> 00:15:26,356
同时 用户可以使用设置选项

514
00:15:26,356 --> 00:15:28,466
来禁止你的  app 

515
00:15:28,466 --> 00:15:29,846
在  CarPlay  中显示提示通知

516
00:15:31,666 --> 00:15:32,536
让我们看一下  CarPlay  中

517
00:15:32,536 --> 00:15:33,726
设置通知的

518
00:15:33,726 --> 00:15:33,976
代码

519
00:15:36,816 --> 00:15:38,706
首先 在请求发送提示通知的授权时

520
00:15:38,706 --> 00:15:39,976
将  CarPlay  选项

521
00:15:40,046 --> 00:15:41,586
包含进去

522
00:15:42,966 --> 00:15:45,226
如果用户不接受提示通知

523
00:15:45,226 --> 00:15:47,176
则让你的 app 恰当地禁止

524
00:15:47,176 --> 00:15:48,566
与发送提示

525
00:15:48,616 --> 00:15:49,336
有关的功能

526
00:15:50,446 --> 00:15:52,546
接下来 建立一个新的信息类别

527
00:15:52,546 --> 00:15:54,566
仅包含关于

528
00:15:54,566 --> 00:15:56,186
信息的通知

529
00:15:56,656 --> 00:15:57,976
关于其他功能的通知

530
00:15:57,976 --> 00:16:00,596
例如新闻或游戏

531
00:15:57,976 --> 00:16:00,596
例如新闻或游戏

532
00:16:00,816 --> 00:16:02,126
不应该被包含在

533
00:16:02,126 --> 00:16:03,276
这个通知类别中

534
00:16:03,756 --> 00:16:06,066
给这个类别加一个标记

535
00:16:06,066 --> 00:16:08,136
确保所有本地

536
00:16:08,136 --> 00:16:10,286
或远程的

537
00:16:10,626 --> 00:16:12,686
信息通知提醒

538
00:16:12,686 --> 00:16:13,826
都有同样的类别标记

539
00:16:14,366 --> 00:16:17,906
建立一个意图的标记

540
00:16:17,906 --> 00:16:19,706
以便通知选项在 

541
00:16:20,456 --> 00:16:21,446
CarPlay  中被选中时

542
00:16:21,446 --> 00:16:22,316
来设置  Siri  的互动

543
00:16:23,536 --> 00:16:24,646
通常使用的是

544
00:16:24,896 --> 00:16:25,966
INSearchForMessagesIntentIdentifier 

545
00:16:25,966 --> 00:16:27,596
这个意图

546
00:16:27,596 --> 00:16:29,386
设置  Siri  让它搜寻这个意图

547
00:16:29,566 --> 00:16:31,386
并读取与这个提示通知

548
00:16:31,386 --> 00:16:32,756
对应的信息

549
00:16:33,276 --> 00:16:36,346
关于开发短信和语音通话  app

550
00:16:36,346 --> 00:16:37,536
有一些推荐的

551
00:16:37,536 --> 00:16:40,136
对应的信息

552
00:16:41,006 --> 00:16:42,466
在通知的标题或副标题中

553
00:16:42,466 --> 00:16:43,776
应该只包含发送者

554
00:16:43,776 --> 00:16:46,066
和群组名称

555
00:16:46,066 --> 00:16:47,016
等信息

556
00:16:47,546 --> 00:16:49,526
信息的内容不应该

557
00:16:49,526 --> 00:16:50,716
在  CarPlay  中显示出来

558
00:16:51,286 --> 00:16:54,476
读取一条信息过后

559
00:16:54,476 --> 00:16:55,036
Siri 将使用

560
00:16:55,186 --> 00:16:57,286
INSentMessageAttributeIntent

561
00:16:57,286 --> 00:16:58,376
将信息标为已读

562
00:16:59,466 --> 00:17:00,346
读取状态

563
00:16:59,466 --> 00:17:00,346
读取状态

564
00:17:00,346 --> 00:17:02,056
应该显示在 app 中

565
00:17:02,056 --> 00:17:03,646
在之后搜索信息的活动中

566
00:17:03,846 --> 00:17:04,266
也应该体现

567
00:17:05,126 --> 00:17:08,465
用户可能驶入或者驶出信号覆盖的范围

568
00:17:08,465 --> 00:17:10,866
所以  app  应该使用提示

569
00:17:10,866 --> 00:17:12,066
来通知用户

570
00:17:12,066 --> 00:17:14,636
未接来电

571
00:17:14,636 --> 00:17:15,996
或者发送失败的信息

572
00:17:17,336 --> 00:17:18,516
像我们之前描述的那样

573
00:17:18,516 --> 00:17:19,776
这可能需要

574
00:17:19,776 --> 00:17:21,376
单独设置另一个

575
00:17:21,376 --> 00:17:21,695
提示类别

576
00:17:22,256 --> 00:17:26,906
可以结合  CarPlay  的

577
00:17:26,906 --> 00:17:28,496
最后一个类别的  app

578
00:17:28,496 --> 00:17:30,066
是汽车生产商的  app

579
00:17:32,026 --> 00:17:33,686
只有这类汽车生产商的  app

580
00:17:33,686 --> 00:17:35,006
可以在  CarPlay  中

581
00:17:35,006 --> 00:17:36,746
显示自定义

582
00:17:36,746 --> 00:17:37,266
用户界面

583
00:17:38,176 --> 00:17:39,966
在这个例子中

584
00:17:39,966 --> 00:17:41,246
汽车生产商的  app 

585
00:17:41,246 --> 00:17:42,436
提供温度设置

586
00:17:43,016 --> 00:17:45,256
选择收音机频道

587
00:17:45,256 --> 00:17:46,626
以及呼叫公路援助的功能

588
00:17:47,856 --> 00:17:49,426
在汽车生产商的  app  中提供这些功能

589
00:17:49,426 --> 00:17:51,866
让用户可以不必离开  CarPlay

590
00:17:51,866 --> 00:17:53,136
就可以调节车的温度

591
00:17:53,136 --> 00:17:55,036
和收音机

592
00:17:55,556 --> 00:17:58,306
汽车生产商的  app  可以

593
00:17:58,306 --> 00:17:59,366
利用 iPhone  的

594
00:17:59,366 --> 00:18:00,866
网络连接

595
00:17:59,366 --> 00:18:00,866
网络连接

596
00:18:00,866 --> 00:18:02,896
和强大的开发平台

597
00:18:02,896 --> 00:18:04,036
带来更多汽车相关的

598
00:18:04,036 --> 00:18:04,606
功能

599
00:18:05,176 --> 00:18:07,406
例如 这个汽车生产商的 app

600
00:18:07,676 --> 00:18:09,316
可以利用Siri

601
00:18:09,316 --> 00:18:11,406
来语音控制温度和收音机

602
00:18:11,406 --> 00:18:11,846
设置

603
00:18:15,606 --> 00:18:17,176
汽车生产商的  app 

604
00:18:17,176 --> 00:18:18,816
必须由汽车制造商来制作

605
00:18:18,816 --> 00:18:20,496
需要车的制造商提供信息

606
00:18:20,496 --> 00:18:22,046
来控制汽车上的功能

607
00:18:22,546 --> 00:18:25,366
这些  app  必须有一个特定的

608
00:18:25,366 --> 00:18:27,106
CarPlay  协议的

609
00:18:27,106 --> 00:18:27,756
签名授权

610
00:18:28,996 --> 00:18:30,826
它们必须在  CarPlay  里

611
00:18:30,826 --> 00:18:31,906
显示一个用户界面

612
00:18:32,896 --> 00:18:35,516
并且只能在支持的

613
00:18:35,516 --> 00:18:37,186
车型上显示

614
00:18:39,626 --> 00:18:40,686
CarPlay  通过匹配 

615
00:18:40,736 --> 00:18:42,486
汽车的外部配件协议

616
00:18:42,486 --> 00:18:44,576
与 app 的

617
00:18:44,576 --> 00:18:46,206
CarPlay  协议权限

618
00:18:46,456 --> 00:18:48,356
来决定某款车型

619
00:18:48,356 --> 00:18:50,096
是否支持某个 

620
00:18:50,516 --> 00:18:53,036
汽车生产商的 app 

621
00:18:53,036 --> 00:18:53,996
因此 在汽车开发制造过程中

622
00:18:53,996 --> 00:18:55,726
考虑可能的汽车生产商的  app 

623
00:18:55,726 --> 00:18:58,316
是很重要的

624
00:18:58,616 --> 00:18:59,946
这样才能保证

625
00:18:59,946 --> 00:19:01,636
汽车配有适当的

626
00:18:59,946 --> 00:19:01,636
汽车配有适当的

627
00:19:01,636 --> 00:19:02,046
协议声明

628
00:19:02,536 --> 00:19:05,576
这个例子展示了  CarPlay  是怎样

629
00:19:05,576 --> 00:19:07,226
将汽车与汽车生产商的 app

630
00:19:07,226 --> 00:19:07,646
相匹配

631
00:19:08,346 --> 00:19:10,786
这个汽车有两个协议的声明

632
00:19:10,786 --> 00:19:12,606
一个是表现的协议

633
00:19:12,646 --> 00:19:14,186
用来采集汽车的数据

634
00:19:14,186 --> 00:19:16,806
还有一个控制温度

635
00:19:16,806 --> 00:19:17,486
的协议

636
00:19:18,686 --> 00:19:20,506
像这儿所显示的那样

637
00:19:20,506 --> 00:19:21,676
协议的名字应该用

638
00:19:21,926 --> 00:19:22,766
反向域名格式

639
00:19:23,416 --> 00:19:27,326
汽车生产商希望

640
00:19:27,326 --> 00:19:28,446
在一个新叫做“跑道”的  app  中

641
00:19:28,446 --> 00:19:30,306
利用有关汽车

642
00:19:30,306 --> 00:19:33,156
表现的数据

643
00:19:33,156 --> 00:19:34,426
这个  app  是为了赛道所设计

644
00:19:35,556 --> 00:19:36,796
该  app  包含了

645
00:19:36,826 --> 00:19:38,076
表现协议以及授权

646
00:19:38,866 --> 00:19:41,706
并且 app 和车

647
00:19:41,706 --> 00:19:43,166
都支持表现协议

648
00:19:43,166 --> 00:19:47,126
所以 “跑道” 将会

649
00:19:47,126 --> 00:19:49,886
显示在  CarPlay  中

650
00:19:51,666 --> 00:19:53,796
汽车生产商的  app 

651
00:19:53,796 --> 00:19:54,826
还可以支持多个协议

652
00:19:56,116 --> 00:19:57,896
这个汽车生产商决定

653
00:19:57,896 --> 00:19:59,516
在“跑道”这个 app 成功的基础上

654
00:19:59,986 --> 00:20:02,016
开发一个新的 app

655
00:19:59,986 --> 00:20:02,016
开发一个新的 app

656
00:20:02,016 --> 00:20:03,956
叫做“舒适旅程”

657
00:20:03,956 --> 00:20:05,836
可以根据驾驶者的喜好

658
00:20:05,836 --> 00:20:07,016
很方便的

659
00:20:07,056 --> 00:20:08,356
调节收音机和温度

660
00:20:09,686 --> 00:20:10,856
这个  app  的授权

661
00:20:10,856 --> 00:20:13,406
包括一个温度的协议

662
00:20:13,406 --> 00:20:14,376
和一个新的收音机的协议

663
00:20:14,986 --> 00:20:17,366
该车不支持收音机的协议

664
00:20:17,366 --> 00:20:19,206
但因为车辆和  app 

665
00:20:19,206 --> 00:20:21,366
都支持温度协议

666
00:20:21,366 --> 00:20:24,266
“舒适旅程” 这个  app

667
00:20:24,266 --> 00:20:25,456
将会显示在

668
00:20:25,456 --> 00:20:25,816
CarPlay  中

669
00:20:27,226 --> 00:20:28,986
在汽车生产商的  app  开始运行之后

670
00:20:29,266 --> 00:20:30,646
应该询问所支持的外部配件协议

671
00:20:30,646 --> 00:20:32,906
并且在用户界面上

672
00:20:32,906 --> 00:20:34,466
应该只显示

673
00:20:35,226 --> 00:20:36,486
支持的功能

674
00:20:37,416 --> 00:20:39,156
在这个例子中

675
00:20:39,156 --> 00:20:40,736
“舒适旅程”这个  app

676
00:20:40,736 --> 00:20:42,796
应该只显示温度控制

677
00:20:42,796 --> 00:20:44,576
因为该车不支持

678
00:20:44,576 --> 00:20:44,976
收音机协议

679
00:20:49,086 --> 00:20:50,586
这个汽车生产商想开发另外一个  app

680
00:20:50,586 --> 00:20:52,926
叫做“充电”

681
00:20:53,446 --> 00:20:54,456
来显示他们的

682
00:20:54,456 --> 00:20:55,666
电动车充电站

683
00:20:56,406 --> 00:20:58,086
为了让这个 app 只适用于他们自己的电动车

684
00:20:58,086 --> 00:20:59,926
这个汽车生产商在  app  的权限中

685
00:20:59,926 --> 00:21:02,476
设定了一个

686
00:20:59,926 --> 00:21:02,476
设定了一个

687
00:21:02,766 --> 00:21:03,836
新的电子协议

688
00:21:04,446 --> 00:21:07,266
因为这款车

689
00:21:07,266 --> 00:21:08,666
不支持电子协议

690
00:21:09,296 --> 00:21:10,976
“充电”这个  app 

691
00:21:10,976 --> 00:21:12,516
将不会显示在 

692
00:21:13,146 --> 00:21:13,366
CarPlay  中

693
00:21:16,386 --> 00:21:17,446
开发一个汽车生产商的  app

694
00:21:17,686 --> 00:21:18,986
需要与该汽车

695
00:21:18,986 --> 00:21:19,366
进行信息交换

696
00:21:20,636 --> 00:21:22,486
汽车生产商的  app 

697
00:21:22,486 --> 00:21:24,216
必须直接通过  iPhone

698
00:21:24,216 --> 00:21:25,956
使用“外部配件”框架

699
00:21:25,956 --> 00:21:26,816
与车辆进行信息交换

700
00:21:27,876 --> 00:21:29,526
直接通过外部配件

701
00:21:29,526 --> 00:21:31,516
进行交流

702
00:21:31,516 --> 00:21:33,676
提高了 app 的反应速度

703
00:21:33,676 --> 00:21:35,396
并避免了

704
00:21:35,396 --> 00:21:36,356
依赖网络连接

705
00:21:37,646 --> 00:21:38,906
要使用外部配件框架

706
00:21:38,906 --> 00:21:41,326
app  需要像之前演示的那样

707
00:21:41,326 --> 00:21:43,086
定义一个自定义的协议名称

708
00:21:43,086 --> 00:21:45,706
在汽车的软件中 

709
00:21:45,706 --> 00:21:46,996
和 app 所检测到的

710
00:21:46,996 --> 00:21:50,646
配件连接事件中

711
00:21:50,646 --> 00:21:53,146
应用这个协议

712
00:21:53,146 --> 00:21:55,296
在建立连接的时候

713
00:21:55,296 --> 00:21:56,656
初始化一个  EA  对话

714
00:21:56,656 --> 00:21:57,686
来建立车中的网络传输

715
00:21:58,996 --> 00:22:01,036
了解更多信息

716
00:21:58,996 --> 00:22:01,036
了解更多信息

717
00:22:01,036 --> 00:22:02,816
请参见外部配件编程的

718
00:22:03,486 --> 00:22:03,696
话题

719
00:22:05,716 --> 00:22:08,046
汽车生产商的 app 可以使用  UIKit

720
00:22:08,046 --> 00:22:09,576
来在  CarPlay  的屏幕上

721
00:22:09,576 --> 00:22:10,296
显示用户界面

722
00:22:11,396 --> 00:22:12,456
要创立一个  CarPlay  的接口

723
00:22:12,456 --> 00:22:15,196
app  需检测 

724
00:22:15,196 --> 00:22:16,716
UIScreen  连接事件

725
00:22:18,066 --> 00:22:19,146
当屏幕建立连接时

726
00:22:19,266 --> 00:22:20,316
验证连接的屏幕的

727
00:22:20,316 --> 00:22:22,096
特征包含

728
00:22:22,096 --> 00:22:22,866
CarPlay  的惯用语法

729
00:22:24,256 --> 00:22:26,106
除了  CarPlay iOS  还支持

730
00:22:26,106 --> 00:22:27,396
其他外部的显示系统

731
00:22:27,396 --> 00:22:29,166
例如飞机上的

732
00:22:29,166 --> 00:22:29,516
屏幕

733
00:22:30,746 --> 00:22:32,906
屏幕只应该显示有  CarPlay  惯用语法的

734
00:22:32,906 --> 00:22:34,286
CarPlay  内容

735
00:22:34,836 --> 00:22:39,636
这个 app 在  CarPlay  屏幕上

736
00:22:39,636 --> 00:22:41,656
建立了一个  UIWindow

737
00:22:41,656 --> 00:22:43,676
将根视图的控制器设置为

738
00:22:43,676 --> 00:22:44,956
自定义  UI  视图

739
00:22:46,436 --> 00:22:47,566
控制器的子类

740
00:22:47,566 --> 00:22:47,956
让我们看一下这些结合在一起是怎样的

741
00:22:51,856 --> 00:22:53,076
这里是在  CarPlay  中

742
00:22:53,076 --> 00:22:54,356
显示视图控制器的

743
00:22:54,356 --> 00:22:54,776
代码

744
00:22:55,766 --> 00:22:56,856
通常这些代码或者放在

745
00:22:56,856 --> 00:22:58,256
你  UI  程序的委托中

746
00:22:58,256 --> 00:23:01,066
或者放在为这些代码所建的

747
00:22:58,256 --> 00:23:01,066
或者放在为这些代码所建的

748
00:23:01,066 --> 00:23:02,316
一个新的类中

749
00:23:03,476 --> 00:23:05,366
首先 我们加上一个新的类

750
00:23:05,396 --> 00:23:07,166
来储存我们 

751
00:23:07,916 --> 00:23:08,756
为  CarPlay 所创建的

752
00:23:08,756 --> 00:23:09,506
UIWindow

753
00:23:10,386 --> 00:23:12,026
接下来我们定义一个

754
00:23:12,026 --> 00:23:13,856
叫做  updateCarWindow  的实例方法

755
00:23:15,026 --> 00:23:16,266
要检查是否连接了  CarPlay  的屏幕

756
00:23:16,266 --> 00:23:18,506
我们检测含有  CarPlay  

757
00:23:18,786 --> 00:23:19,896
惯用语法的  UIScreen

758
00:23:21,086 --> 00:23:22,666
如果没有含  CarPlay  惯用语法的屏幕存在

759
00:23:22,666 --> 00:23:24,476
我们就取消

760
00:23:24,476 --> 00:23:26,016
之前建立的任何  UIWindow

761
00:23:26,856 --> 00:23:27,816
因为与  CarPlay  的连接

762
00:23:28,016 --> 00:23:28,646
可能断开了

763
00:23:29,196 --> 00:23:32,566
如果  CarPlay  屏幕是连接上的

764
00:23:33,306 --> 00:23:35,276
则初始化一个新的  UIWindow

765
00:23:35,276 --> 00:23:37,586
并建立一个自定义的

766
00:23:37,586 --> 00:23:39,616
rootViewController

767
00:23:39,616 --> 00:23:40,656
在其中包含要在  CarPlay  中

768
00:23:40,656 --> 00:23:41,106
显示的内容

769
00:23:42,146 --> 00:23:43,716
在这里我们使用 

770
00:23:43,716 --> 00:23:45,536
UI view controller  的一个子类

771
00:23:45,736 --> 00:23:46,626
叫做  carViewController

772
00:23:47,676 --> 00:23:48,606
这个类需要

773
00:23:48,606 --> 00:23:49,086
被实现

774
00:23:49,586 --> 00:23:53,796
你的  app  可以在连接  CarPlay

775
00:23:53,796 --> 00:23:54,576
之后启动

776
00:23:55,446 --> 00:23:57,096
为了处理这种情况

777
00:23:57,096 --> 00:23:58,986
尽早的在你的 app 中

778
00:23:58,986 --> 00:24:00,856
调用  updateCarWindow

779
00:23:58,986 --> 00:24:00,856
调用  updateCarWindow

780
00:24:00,856 --> 00:24:02,186
例如在完成

781
00:24:02,186 --> 00:24:03,016
启动的选项里

782
00:24:04,376 --> 00:24:05,806
因为  CarPlay  在你的 app 启动过后

783
00:24:05,806 --> 00:24:07,326
也可以连接

784
00:24:07,746 --> 00:24:08,236
检测 

785
00:24:08,236 --> 00:24:10,086
UIScreenDidConnect

786
00:24:10,086 --> 00:24:11,676
和 UIScreenDidDisconnect

787
00:24:12,116 --> 00:24:14,056
通知并调用

788
00:24:14,056 --> 00:24:15,846
UpdateCarWindow

789
00:24:15,846 --> 00:24:17,086
来处理这些事件

790
00:24:18,676 --> 00:24:19,996
UIKit 在 CarPlay

791
00:24:19,996 --> 00:24:21,736
屏幕中的表现

792
00:24:21,736 --> 00:24:23,776
和在  iPhone  主屏幕中的表现

793
00:24:24,346 --> 00:24:25,486
有些不同

794
00:24:25,686 --> 00:24:27,556
UIButtonTypeSystem  以  CarPlay  默认的

795
00:24:27,556 --> 00:24:29,476
显示风格来显示

796
00:24:29,476 --> 00:24:30,976
也是推荐的创建按钮的方法

797
00:24:30,976 --> 00:24:32,946
因为这样一来它的格式和表现

798
00:24:32,946 --> 00:24:34,856
就会与其他 

799
00:24:34,856 --> 00:24:36,866
CarPlay app  保持一致

800
00:24:38,096 --> 00:24:38,726
在 CarPlay 中

801
00:24:38,986 --> 00:24:41,116
UITableViewController  可能会

802
00:24:41,116 --> 00:24:44,006
限制表格的长度

803
00:24:44,006 --> 00:24:45,106
对于有导航硬件的车来说

804
00:24:45,106 --> 00:24:47,186
使用 

805
00:24:48,096 --> 00:24:48,856
UIFocusEnvironment

806
00:24:48,856 --> 00:24:50,476
以及相关的焦点类

807
00:24:50,476 --> 00:24:52,546
来处理相应的

808
00:24:52,546 --> 00:24:53,796
焦点动作

809
00:24:54,416 --> 00:24:57,976
注意  UIKit   提供的

810
00:24:57,976 --> 00:24:59,676
所有的系统用户界面元素

811
00:24:59,676 --> 00:25:01,546
并不是都可以用在汽车制造商的

812
00:24:59,676 --> 00:25:01,546
并不是都可以用在汽车制造商的

813
00:25:02,536 --> 00:25:02,626
app  中

814
00:25:05,086 --> 00:25:06,176
有一些  SiriKit  的意图

815
00:25:06,176 --> 00:25:07,776
是与汽车制造商的 

816
00:25:07,776 --> 00:25:08,076
app  相关的

817
00:25:09,396 --> 00:25:10,806
这些意图指令

818
00:25:10,806 --> 00:25:11,856
对所有  app  开放

819
00:25:12,346 --> 00:25:13,526
它们并不需要连接  CarPlay

820
00:25:13,526 --> 00:25:15,336
或者是参与到

821
00:25:15,336 --> 00:25:16,436
一个  CarPlay  的  app  中

822
00:25:17,316 --> 00:25:18,956
但是汽车生产商的  app

823
00:25:18,956 --> 00:25:19,916
是利用这些意图的一个好地方

824
00:25:19,916 --> 00:25:22,016
包括可以锁车

825
00:25:22,016 --> 00:25:23,496
检查汽油使用情况

826
00:25:23,496 --> 00:25:26,436
和按响喇叭

827
00:25:26,596 --> 00:25:27,826
还有一系列的意图

828
00:25:28,086 --> 00:25:29,216
需要连接  CarPlay

829
00:25:29,216 --> 00:25:30,766
而且只能应用在

830
00:25:30,766 --> 00:25:32,246
汽车生产商的  app  上

831
00:25:33,516 --> 00:25:35,176
CarPlay  意图包括控制温度

832
00:25:35,176 --> 00:25:37,176
除霜

833
00:25:37,176 --> 00:25:38,156
控制座椅加热

834
00:25:39,136 --> 00:25:40,976
还有控制收音机和

835
00:25:41,036 --> 00:25:42,756
选择音频来源

836
00:25:42,786 --> 00:25:43,396
的意图

837
00:25:44,026 --> 00:25:47,286
汽车生产商  app  的设计

838
00:25:47,286 --> 00:25:48,176
有一定的规范

839
00:25:49,176 --> 00:25:50,906
首先 要让你的  app

840
00:25:50,906 --> 00:25:52,456
在没有  CarPlay  的情况下

841
00:25:52,456 --> 00:25:52,916
依然可以发挥作用

842
00:25:53,646 --> 00:25:55,256
例如 当断开与  CarPlay  的连接的时候

843
00:25:55,256 --> 00:25:57,046
汽车生产商的  app 

844
00:25:57,046 --> 00:25:58,646
可以通过连接因特网

845
00:25:58,646 --> 00:26:00,926
来与汽车进行

846
00:25:58,646 --> 00:26:00,926
来与汽车进行

847
00:26:02,206 --> 00:26:02,436
信息交换

848
00:26:02,516 --> 00:26:04,026
在设计汽车生产商  app  的时候

849
00:26:04,176 --> 00:26:06,456
考虑兼容的

850
00:26:07,776 --> 00:26:07,876
问题

851
00:26:07,876 --> 00:26:09,306
app  的更新应该继续支持老款的车型

852
00:26:09,306 --> 00:26:11,396
新的功能

853
00:26:11,396 --> 00:26:12,946
不应该影响到

854
00:26:12,946 --> 00:26:16,916
现有的  app  版本

855
00:26:17,006 --> 00:26:18,426
简化用户界面

856
00:26:19,246 --> 00:26:21,146
多数的  CarPlay  app 界面

857
00:26:21,146 --> 00:26:22,876
应该只包括基本的互动元素

858
00:26:22,876 --> 00:26:25,396
例如按钮

859
00:26:25,896 --> 00:26:28,746
标签 表格 导航条

860
00:26:29,356 --> 00:26:30,676
和页面标签

861
00:26:32,106 --> 00:26:33,696
最后 如果你的汽车生产商 app

862
00:26:33,696 --> 00:26:34,786
支持的车型上

863
00:26:34,786 --> 00:26:37,116
有硬件的导航装置

864
00:26:37,116 --> 00:26:38,866
要考虑

865
00:26:38,866 --> 00:26:40,686
怎样将焦点在不同的 

866
00:26:40,686 --> 00:26:40,976
UI  元素中转移

867
00:26:44,506 --> 00:26:45,506
我们希望你学到了

868
00:26:45,506 --> 00:26:47,036
怎样将一个语音 信息

869
00:26:47,036 --> 00:26:49,006
语音通话或汽车生产商的 app

870
00:26:49,006 --> 00:26:50,366
结合到  CarPlay  中

871
00:26:51,006 --> 00:26:52,056
关于  CarPlay  的

872
00:26:52,056 --> 00:26:53,126
更多信息

873
00:26:53,126 --> 00:26:56,226
请访问  developer.apple.com

874
00:26:56,436 --> 00:26:57,716
你也可以

875
00:26:57,716 --> 00:26:58,776
从相关的讲座中

876
00:26:59,456 --> 00:27:00,926
了解更多内容

877
00:26:59,456 --> 00:27:00,926
了解更多内容

878
00:27:00,926 --> 00:27:02,306
“用  Xcode 9  调试程序”

879
00:27:02,306 --> 00:27:04,236
可以告诉你关于

880
00:27:04,236 --> 00:27:05,376
有线连接  CarPlay  调试程序的更多信息

881
00:27:06,266 --> 00:27:07,246
关于 SiriKit 的更多信息

882
00:27:07,286 --> 00:27:09,946
请参考“ SiriKit  最新更新”

883
00:27:09,946 --> 00:27:11,986
以及 “创造最好的 

884
00:27:11,986 --> 00:27:13,016
SiriKit  体验”

885
00:27:14,266 --> 00:27:15,356
关于  CarPlay  怎样通过无线工作

886
00:27:15,356 --> 00:27:16,906
请观看“开发无线  CarPlay  系统”

887
00:27:16,906 --> 00:27:18,476
的视频

888
00:27:19,596 --> 00:27:22,096
WWDC 6 的视频

889
00:27:22,096 --> 00:27:24,026
也包括 CallKit 和

890
00:27:24,026 --> 00:27:25,546
CarPlay  系统开发的

891
00:27:26,296 --> 00:27:26,476
话题
