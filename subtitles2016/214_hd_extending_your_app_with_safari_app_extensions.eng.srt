1
00:00:07,516 --> 00:00:18,500
[ Music ]

2
00:00:23,516 --> 00:00:28,356
[ Applause ]

3
00:00:28,856 --> 00:00:29,506
&gt;&gt; Hello, everyone.

4
00:00:29,946 --> 00:00:31,066
I'm Brian Weinstein.

5
00:00:31,346 --> 00:00:33,226
I'm an engineer on

6
00:00:33,556 --> 00:00:37,856
And today Zach, Damian and

7
00:00:37,856 --> 00:00:41,326
to extend your Mac app

8
00:00:41,946 --> 00:00:45,586
In macOS Sierra and

9
00:00:45,926 --> 00:00:49,766
we are introducing a new

10
00:00:49,926 --> 00:00:51,826
and distributing

11
00:00:52,376 --> 00:00:55,396
These extensions leverage

12
00:00:55,696 --> 00:00:57,696
and native code written

13
00:00:58,216 --> 00:01:01,356
They're bundled with the Mac

14
00:00:58,216 --> 00:01:01,356
They're bundled with the Mac

15
00:01:01,356 --> 00:01:02,296
through the App Store.

16
00:01:02,756 --> 00:01:07,796
That new way is Safari

17
00:01:08,286 --> 00:01:12,256
Safari app extensions have the

18
00:01:12,256 --> 00:01:16,326
of webpages using

19
00:01:16,396 --> 00:01:19,726
They have the power to block

20
00:01:19,796 --> 00:01:21,426
or elements on a page.

21
00:01:22,326 --> 00:01:24,856
They can add toolbar

22
00:01:25,756 --> 00:01:27,776
And those toolbar

23
00:01:27,776 --> 00:01:31,516
to display popovers using

24
00:01:31,516 --> 00:01:32,516
to build the views.

25
00:01:32,906 --> 00:01:36,496
And lastly, Safari app

26
00:01:36,496 --> 00:01:38,956
to context menus on webpages.

27
00:01:40,266 --> 00:01:43,576
Safari app extensions are

28
00:01:43,746 --> 00:01:46,206
Which are bundles of

29
00:01:46,526 --> 00:01:49,326
that are packaged inside

30
00:01:49,326 --> 00:01:52,786
to give your users access

31
00:01:52,886 --> 00:01:54,906
and content throughout macOS.

32
00:01:55,856 --> 00:01:59,926
And so this means that they

33
00:01:59,926 --> 00:02:02,926
and other developing tools you

34
00:01:59,926 --> 00:02:02,926
and other developing tools you

35
00:02:03,736 --> 00:02:07,426
and it means that Safari app

36
00:02:07,676 --> 00:02:10,936
with the power of the APIs

37
00:02:11,646 --> 00:02:14,876
Another major benefit

38
00:02:14,876 --> 00:02:18,956
on app extensions is that they

39
00:02:19,136 --> 00:02:21,576
Which means that they can be

40
00:02:22,086 --> 00:02:24,236
And it means that

41
00:02:24,236 --> 00:02:26,126
to download your

42
00:02:26,356 --> 00:02:29,226
after installing your app.

43
00:02:29,226 --> 00:02:34,026
And for those of you who require

44
00:02:34,026 --> 00:02:36,396
and your extension,

45
00:02:36,396 --> 00:02:38,286
of Safari app extensions is

46
00:02:38,286 --> 00:02:41,066
that your extension is always

47
00:02:41,686 --> 00:02:43,046
because they're packaged

48
00:02:43,596 --> 00:02:46,236
So, your users will always

49
00:02:46,236 --> 00:02:48,386
of your app and your extension.

50
00:02:49,366 --> 00:02:52,226
One of the best parts of

51
00:02:52,226 --> 00:02:54,456
that it's capable of

52
00:02:54,456 --> 00:02:55,176
of extensions.

53
00:02:55,596 --> 00:02:58,256
Today we're going to build

54
00:02:58,786 --> 00:03:01,966
The first type is a content

55
00:02:58,786 --> 00:03:01,966
The first type is a content

56
00:03:01,966 --> 00:03:04,286
which can block the loading

57
00:03:04,656 --> 00:03:06,466
or hide elements on the page.

58
00:03:07,166 --> 00:03:09,226
The second type will

59
00:03:09,226 --> 00:03:12,646
that modifies the contents

60
00:03:12,646 --> 00:03:15,896
between the JavaScript code

61
00:03:16,276 --> 00:03:18,086
and the extension's native code.

62
00:03:18,726 --> 00:03:21,496
And the third type of

63
00:03:21,496 --> 00:03:25,396
to extend Safari's UI to add

64
00:03:25,396 --> 00:03:27,846
of your app directly to Safari.

65
00:03:28,686 --> 00:03:31,126
So, let's get started

66
00:03:31,996 --> 00:03:33,796
To build a content

67
00:03:34,126 --> 00:03:35,676
I'd like to bring Zach on stage.

68
00:03:35,976 --> 00:03:36,326
Zach?

69
00:03:38,016 --> 00:03:39,946
[ Applause ]

70
00:03:39,946 --> 00:03:40,706
&gt;&gt; Thanks, Ryan.

71
00:03:43,086 --> 00:03:47,636
Hi. I'm Zach Li and I'm also

72
00:03:48,616 --> 00:03:51,866
Last year in Safari we

73
00:03:51,866 --> 00:03:52,676
Blocking model.

74
00:03:53,136 --> 00:03:57,156
Rather than developing extension

75
00:03:57,156 --> 00:03:59,906
or hide elements,

76
00:03:59,906 --> 00:04:03,026
where you can declare ahead

77
00:03:59,906 --> 00:04:03,026
where you can declare ahead

78
00:04:03,826 --> 00:04:06,646
And WebKit optimizes

79
00:04:06,766 --> 00:04:08,786
to make it fast and

80
00:04:09,556 --> 00:04:12,786
Best of all, this model

81
00:04:13,086 --> 00:04:15,396
because the host

82
00:04:15,506 --> 00:04:16,685
for the resources block.

83
00:04:17,896 --> 00:04:21,446
Since then, we've seen so many

84
00:04:21,446 --> 00:04:24,296
have written that really

85
00:04:24,756 --> 00:04:25,816
And users love them.

86
00:04:27,146 --> 00:04:30,996
Today, I'm excited to talk

87
00:04:30,996 --> 00:04:34,076
out existing iOS

88
00:04:34,886 --> 00:04:37,236
For those of you who haven't

89
00:04:37,236 --> 00:04:39,146
before, that's no problem.

90
00:04:39,596 --> 00:04:41,946
You can check out the

91
00:04:42,216 --> 00:04:44,116
on developer.Apple.com.

92
00:04:45,016 --> 00:04:47,886
Let's take a look at what

93
00:04:49,066 --> 00:04:50,146
I really love eating.

94
00:04:50,516 --> 00:04:51,956
I basically eat all the time.

95
00:04:52,816 --> 00:04:55,706
Obviously I have a food

96
00:04:55,706 --> 00:04:58,356
to the food I want to try.

97
00:04:58,556 --> 00:05:02,226
But unfortunately, well,

98
00:04:58,556 --> 00:05:02,226
But unfortunately, well,

99
00:05:02,406 --> 00:05:03,956
I will attend my

100
00:05:04,076 --> 00:05:05,626
as his best man next month.

101
00:05:05,936 --> 00:05:07,056
That I need to stay fit.

102
00:05:07,486 --> 00:05:09,836
At least I need to be

103
00:05:10,986 --> 00:05:13,456
So, I created this

104
00:05:13,626 --> 00:05:16,026
that blocks all the

105
00:05:16,376 --> 00:05:19,126
that even if I'm starving

106
00:05:19,576 --> 00:05:22,276
on my food blog, I wouldn't

107
00:05:22,826 --> 00:05:26,056
Let me show you how the

108
00:05:28,806 --> 00:05:32,426
So, this is my source code

109
00:05:32,816 --> 00:05:35,556
and my app dessert

110
00:05:36,766 --> 00:05:37,796
Let's go to Safari.

111
00:05:38,326 --> 00:05:41,816
And the desserts are present.

112
00:05:42,256 --> 00:05:45,186
Let's reload the page with

113
00:05:45,716 --> 00:05:48,486
All the desserts are gone.

114
00:05:49,666 --> 00:05:50,186
That's great.

115
00:05:50,796 --> 00:05:51,976
Although I'll be missing them.

116
00:05:52,586 --> 00:05:56,576
So, I am an iOS developer

117
00:05:57,016 --> 00:06:00,246
and I really want to bring it

118
00:05:57,016 --> 00:06:00,246
and I really want to bring it

119
00:06:00,296 --> 00:06:01,086
through the App Store.

120
00:06:02,086 --> 00:06:03,466
It's actually quite simple to do

121
00:06:03,876 --> 00:06:07,636
because the content blocker APIs

122
00:06:08,896 --> 00:06:12,906
So, let's first go to Xcode.

123
00:06:13,046 --> 00:06:19,686
Create a new Mac Application

124
00:06:19,686 --> 00:06:27,156
blocker for Mac.

125
00:06:27,156 --> 00:06:30,086
And let's quickly switch

126
00:06:30,176 --> 00:06:33,516
because we are now

127
00:06:34,356 --> 00:06:37,996
Then, create a new Mac

128
00:06:42,256 --> 00:06:45,106
Use the content blocker

129
00:06:47,956 --> 00:06:53,606
That's called dessert

130
00:06:55,896 --> 00:07:00,126
When users get Apps from the

131
00:06:55,896 --> 00:07:00,126
When users get Apps from the

132
00:07:00,126 --> 00:07:02,646
to run the application

133
00:07:02,646 --> 00:07:03,906
to find the app extension.

134
00:07:04,266 --> 00:07:08,756
But outside the App Store,

135
00:07:08,756 --> 00:07:10,476
for Safari to see the extension.

136
00:07:11,026 --> 00:07:12,686
So, in this case,

137
00:07:12,686 --> 00:07:15,336
to continue using the

138
00:07:15,916 --> 00:07:18,126
So, I'm just going

139
00:07:20,416 --> 00:07:23,746
This template will set

140
00:07:24,276 --> 00:07:26,946
And it comes with a simple

141
00:07:27,916 --> 00:07:30,016
To make your own content

142
00:07:30,016 --> 00:07:31,476
to modify this JSON file.

143
00:07:31,886 --> 00:07:33,036
It's really convenient.

144
00:07:33,756 --> 00:07:37,696
But in our case, we can actually

145
00:07:38,506 --> 00:07:40,616
So, we can get rid

146
00:07:41,726 --> 00:07:43,216
And the Swift file.

147
00:07:43,796 --> 00:07:47,886
And make the ones we

148
00:07:47,886 --> 00:07:51,086
to the Mac Application,

149
00:07:51,646 --> 00:07:55,596
To accomplish that,

150
00:07:56,576 --> 00:07:58,896
And in the target

151
00:07:59,306 --> 00:08:01,186
check the Mac app

152
00:07:59,306 --> 00:08:01,186
check the Mac app

153
00:08:01,496 --> 00:08:03,296
for the resources

154
00:08:05,516 --> 00:08:08,116
Cool. We're pretty

155
00:08:08,636 --> 00:08:10,426
But before that, I do want

156
00:08:10,426 --> 00:08:12,786
to make my dessert

157
00:08:13,066 --> 00:08:15,876
by displaying a better name

158
00:08:16,106 --> 00:08:18,076
in Safari extensions

159
00:08:18,726 --> 00:08:22,566
To accomplish that, let's go

160
00:08:22,566 --> 00:08:29,006
Instead of dessert blocker

161
00:08:29,266 --> 00:08:30,516
just called it dessert blocker.

162
00:08:31,056 --> 00:08:34,395
And the description I want

163
00:08:34,395 --> 00:08:38,306
to provide is this content

164
00:08:38,306 --> 00:08:40,905
on my food blog.com.

165
00:08:41,106 --> 00:08:44,556
Also, I want to provide

166
00:08:44,626 --> 00:08:45,616
for my dessert blocker.

167
00:08:46,566 --> 00:08:48,666
Let's remove the

168
00:08:49,676 --> 00:08:50,616
And drag the ones

169
00:08:50,616 --> 00:08:54,846
with predesigned ice cream

170
00:08:55,516 --> 00:08:57,506
All right.

171
00:08:57,776 --> 00:09:04,346
Let's view it and run

172
00:08:57,776 --> 00:09:04,346
Let's view it and run

173
00:09:04,546 --> 00:09:06,516
and the application is run.

174
00:09:07,286 --> 00:09:08,476
So, let's go to Safari.

175
00:09:09,056 --> 00:09:14,506
As you can see, it shows up

176
00:09:14,826 --> 00:09:16,616
Like all other Safari

177
00:09:17,076 --> 00:09:19,136
content blocker is

178
00:09:19,676 --> 00:09:21,356
Let's enable this

179
00:09:21,856 --> 00:09:24,656
Reload the page.

180
00:09:25,216 --> 00:09:29,136
Great. All the desserts

181
00:09:30,366 --> 00:09:33,156
Awesome. Now that my urges

182
00:09:33,156 --> 00:09:35,166
to eat desserts are

183
00:09:35,386 --> 00:09:38,106
I'm so ready to be the best man.

184
00:09:40,516 --> 00:09:45,186
[ Applause ]

185
00:09:45,686 --> 00:09:50,336
As you saw, without even writing

186
00:09:50,336 --> 00:09:51,986
content blocker to macOS.

187
00:09:53,376 --> 00:09:56,016
On top of that, we've

188
00:09:56,016 --> 00:09:58,866
that it would be nice to know

189
00:09:58,866 --> 00:09:59,636
is enabled.

190
00:10:00,296 --> 00:10:02,446
So, we are introducing

191
00:10:03,286 --> 00:10:06,006
getStateOfContent

192
00:10:08,086 --> 00:10:13,106
With this API, for example, if

193
00:10:13,226 --> 00:10:16,966
in the app, I can provide a

194
00:10:17,306 --> 00:10:20,876
by giving instructions on how

195
00:10:21,216 --> 00:10:24,026
if I detect my content

196
00:10:25,166 --> 00:10:28,926
This API along with other

197
00:10:28,966 --> 00:10:32,326
and Damian are going to

198
00:10:32,326 --> 00:10:37,706
on Sierra and El Capitan if

199
00:10:39,036 --> 00:10:44,066
Because El Capitan, the API

200
00:10:44,066 --> 00:10:45,866
on the presence of Safari 10.

201
00:10:46,196 --> 00:10:50,466
We are providing you with a

202
00:10:50,516 --> 00:10:53,586
to check at runtime whether

203
00:10:53,586 --> 00:10:55,046
Safari services APIs

204
00:10:56,266 --> 00:10:58,106
Let's step through

205
00:10:59,586 --> 00:11:02,606
If SFSafari service is

206
00:10:59,586 --> 00:11:02,606
If SFSafari service is

207
00:11:03,126 --> 00:11:05,026
you can safely use the new API.

208
00:11:05,936 --> 00:11:08,366
If not, fall back

209
00:11:09,756 --> 00:11:11,856
These are what's new

210
00:11:12,276 --> 00:11:16,306
To talk about other powerful

211
00:11:16,306 --> 00:11:20,616
app extensions, I would like to

212
00:11:22,516 --> 00:11:25,716
[ Applause ]

213
00:11:26,216 --> 00:11:26,856
&gt;&gt; Thanks, Zach.

214
00:11:28,126 --> 00:11:31,416
So, the next type of extension

215
00:11:31,416 --> 00:11:35,226
that modifies the contents of

216
00:11:35,226 --> 00:11:38,226
to communicate with the

217
00:11:38,226 --> 00:11:39,336
by your app extension.

218
00:11:39,726 --> 00:11:41,346
So, we're going to

219
00:11:41,466 --> 00:11:43,536
that replaces instances

220
00:11:43,806 --> 00:11:45,456
with another throughout the web.

221
00:11:45,906 --> 00:11:48,936
It will get the word to

222
00:11:48,936 --> 00:11:51,376
with from a app extension's

223
00:11:51,886 --> 00:11:54,326
There are 2 ways for

224
00:11:54,326 --> 00:11:56,256
to modify the contents

225
00:11:56,676 --> 00:11:59,376
extensions can inject

226
00:11:59,786 --> 00:12:02,196
and JavaScript content

227
00:11:59,786 --> 00:12:02,196
and JavaScript content

228
00:12:02,776 --> 00:12:04,976
Let's take a look at how

229
00:12:05,786 --> 00:12:08,566
Stylesheets are injected

230
00:12:08,766 --> 00:12:12,806
in the app extensions Info.plist

231
00:12:13,376 --> 00:12:17,666
Stylesheets are specified using

232
00:12:18,056 --> 00:12:21,056
of the Info.plist file

233
00:12:21,056 --> 00:12:23,486
of dictionaries defining

234
00:12:24,346 --> 00:12:28,566
And each style sheet is defined

235
00:12:28,896 --> 00:12:32,586
where the value is the path

236
00:12:32,586 --> 00:12:35,516
to the resources directory

237
00:12:36,206 --> 00:12:38,336
And any style sheet

238
00:12:38,336 --> 00:12:41,996
for a Safari extension will just

239
00:12:43,056 --> 00:12:45,026
Next up is injecting scripts.

240
00:12:45,266 --> 00:12:47,096
Which is almost exactly

241
00:12:47,516 --> 00:12:48,686
just with two different keys.

242
00:12:49,246 --> 00:12:50,386
Scripts are specified

243
00:12:50,446 --> 00:12:53,516
in the SFSafari content

244
00:12:54,456 --> 00:12:57,476
And the key representing

245
00:12:57,476 --> 00:12:58,116
of style sheet.

246
00:12:59,246 --> 00:13:01,586
And all of your extensions

247
00:12:59,246 --> 00:13:01,586
And all of your extensions

248
00:13:01,586 --> 00:13:03,536
in their own execution context

249
00:13:03,736 --> 00:13:05,946
which means there are never

250
00:13:06,166 --> 00:13:08,656
with variables in

251
00:13:09,186 --> 00:13:13,116
This also allows Safari to

252
00:13:13,486 --> 00:13:15,156
to your extension's

253
00:13:15,436 --> 00:13:17,286
that aren't available

254
00:13:17,916 --> 00:13:20,836
For example, your extension

255
00:13:20,836 --> 00:13:23,966
with the native code in your app

256
00:13:24,296 --> 00:13:27,806
or perform some action that can

257
00:13:28,296 --> 00:13:31,516
And to facilitate this, we've

258
00:13:32,106 --> 00:13:34,556
so your app extension's

259
00:13:34,826 --> 00:13:37,286
and Swift code can

260
00:13:38,516 --> 00:13:40,766
So, taking a look

261
00:13:41,196 --> 00:13:45,186
you can see that we have Safari

262
00:13:45,356 --> 00:13:48,376
with a box representing

263
00:13:48,376 --> 00:13:50,306
in your extension's

264
00:13:50,306 --> 00:13:51,916
of course completely sandboxed.

265
00:13:52,406 --> 00:13:56,386
And the extension has injected

266
00:13:56,696 --> 00:13:58,146
and that script would

267
00:13:58,146 --> 00:14:00,736
that app extension what

268
00:13:58,146 --> 00:14:00,736
that app extension what

269
00:14:01,566 --> 00:14:05,926
To do that, it just calls

270
00:14:05,926 --> 00:14:08,376
message and passes

271
00:14:08,916 --> 00:14:12,036
Now let's see how the Swift

272
00:14:12,246 --> 00:14:15,076
and responds back with the

273
00:14:16,246 --> 00:14:19,366
Each Safari app extension

274
00:14:19,936 --> 00:14:22,236
which is the class that

275
00:14:22,236 --> 00:14:24,686
on when the user

276
00:14:25,286 --> 00:14:27,926
When a message is dispatched

277
00:14:28,016 --> 00:14:31,556
to the app extension,

278
00:14:31,866 --> 00:14:34,376
from page userInfo is called.

279
00:14:35,606 --> 00:14:37,426
And once that method is called

280
00:14:37,426 --> 00:14:39,246
on our extension's

281
00:14:39,766 --> 00:14:43,986
the first thing we do is check

282
00:14:44,456 --> 00:14:48,146
And to act on it, our extension

283
00:14:48,376 --> 00:14:51,686
to the SFSafari page

284
00:14:51,946 --> 00:14:55,336
with the words to replace and

285
00:14:55,886 --> 00:14:58,186
And we are structuring

286
00:14:58,446 --> 00:15:01,556
where each key represents the

287
00:14:58,446 --> 00:15:01,556
where each key represents the

288
00:15:02,046 --> 00:15:04,936
and the value represents what

289
00:15:05,886 --> 00:15:11,306
So, when the app extension

290
00:15:11,306 --> 00:15:15,686
Script(withName,userInfo,

291
00:15:15,686 --> 00:15:18,786
from the extension process

292
00:15:19,076 --> 00:15:21,016
that is injected into Apple.com.

293
00:15:21,566 --> 00:15:24,066
Now let's see how that

294
00:15:24,066 --> 00:15:25,946
for these messages

295
00:15:27,406 --> 00:15:29,956
To listen for a message

296
00:15:30,266 --> 00:15:33,846
we start by adding an event

297
00:15:34,076 --> 00:15:36,596
So, the content script can

298
00:15:36,896 --> 00:15:38,076
from the app extension.

299
00:15:38,496 --> 00:15:40,616
And if you've written a

300
00:15:41,016 --> 00:15:42,556
this will look very familiar.

301
00:15:42,856 --> 00:15:45,436
The API to receive

302
00:15:45,436 --> 00:15:48,156
of a content script is

303
00:15:49,096 --> 00:15:52,266
And when our event listener

304
00:15:52,266 --> 00:15:53,446
from our app extension,

305
00:15:54,036 --> 00:15:57,016
the first thing we do once

306
00:15:57,016 --> 00:16:00,486
as a best practice

307
00:15:57,016 --> 00:16:00,486
as a best practice

308
00:16:00,486 --> 00:16:05,176
To act on this message, we want

309
00:16:05,696 --> 00:16:08,356
that was specified in the

310
00:16:08,356 --> 00:16:10,576
from the Swift code

311
00:16:10,576 --> 00:16:12,886
to JavaScript as event.message.

312
00:16:13,356 --> 00:16:16,216
So, we get our dictionary

313
00:16:16,496 --> 00:16:19,276
and we iterate over

314
00:16:19,276 --> 00:16:23,256
in our content script that

315
00:16:23,876 --> 00:16:26,596
So, this word replacement

316
00:16:26,596 --> 00:16:29,676
that we've been discussing is

317
00:16:30,096 --> 00:16:32,326
But some extensions are

318
00:16:32,326 --> 00:16:33,926
on particular websites.

319
00:16:34,706 --> 00:16:37,606
Safari app extensions

320
00:16:37,606 --> 00:16:41,686
for specifying what sites they

321
00:16:41,686 --> 00:16:44,426
in Safari 10, users

322
00:16:44,586 --> 00:16:47,766
which sites your Safari

323
00:16:49,196 --> 00:16:52,396
Like information about content

324
00:16:53,086 --> 00:16:55,776
your extension's website

325
00:16:55,776 --> 00:16:57,566
in the extension's Info.plist

326
00:16:57,946 --> 00:17:00,596
under the

327
00:16:57,946 --> 00:17:00,596
under the

328
00:17:00,966 --> 00:17:02,806
and it's a dictionary

329
00:17:03,166 --> 00:17:05,616
The first part is the

330
00:17:06,266 --> 00:17:09,675
And this extension is specifying

331
00:17:10,036 --> 00:17:11,496
which means it wants access

332
00:17:11,496 --> 00:17:13,766
to every webpage

333
00:17:14,175 --> 00:17:17,705
And as you can see, Safari's

334
00:17:17,705 --> 00:17:20,516
user about this before they're

335
00:17:21,636 --> 00:17:22,685
And in this example,

336
00:17:23,136 --> 00:17:25,665
the extension has an

337
00:17:26,326 --> 00:17:30,556
When the access level is some,

338
00:17:30,556 --> 00:17:32,786
of domains that it wants access

339
00:17:32,786 --> 00:17:36,216
to in the allowed domain

340
00:17:36,716 --> 00:17:40,466
And if an allowed domain starts

341
00:17:40,466 --> 00:17:44,006
as a wildcard and it represents

342
00:17:45,426 --> 00:17:49,346
So, now that we've discussed how

343
00:17:49,686 --> 00:17:51,876
by injecting content

344
00:17:52,356 --> 00:17:54,646
how those content

345
00:17:54,646 --> 00:17:56,336
with your app extension's

346
00:17:56,716 --> 00:17:59,496
and how you specify what

347
00:17:59,496 --> 00:18:00,396
like access to.

348
00:17:59,496 --> 00:18:00,396
like access to.

349
00:18:00,796 --> 00:18:03,416
I'd like to put this all

350
00:18:03,416 --> 00:18:06,446
that word replacement extension

351
00:18:09,976 --> 00:18:12,886
So, one of the interesting

352
00:18:12,956 --> 00:18:17,716
about Safari extensions is that

353
00:18:17,716 --> 00:18:21,146
with webpages is JavaScript

354
00:18:21,146 --> 00:18:23,926
to bring code that you've

355
00:18:23,926 --> 00:18:27,116
for a different browser, and

356
00:18:27,546 --> 00:18:31,156
So, what I'm going to do is I'm

357
00:18:31,436 --> 00:18:33,886
that does this word

358
00:18:33,886 --> 00:18:36,436
to create a Safari

359
00:18:36,846 --> 00:18:41,206
And I'm going to extend it so

360
00:18:41,456 --> 00:18:44,056
and what to replace them

361
00:18:44,966 --> 00:18:48,756
So, I already have an app

362
00:18:48,756 --> 00:18:50,606
like to create a

363
00:18:51,286 --> 00:18:53,696
To do that, I create

364
00:18:55,036 --> 00:18:57,466
and select a macOS

365
00:18:58,116 --> 00:18:59,786
and select Safari extension.

366
00:19:00,526 --> 00:19:04,236
And we're going to call this

367
00:19:04,236 --> 00:19:05,376
to Animalify the web

368
00:19:05,376 --> 00:19:07,586
by replacing animals

369
00:19:09,776 --> 00:19:14,026
And as Zach mentioned

370
00:19:14,026 --> 00:19:16,816
so I'm not going to activate

371
00:19:17,336 --> 00:19:22,386
So, we now have our

372
00:19:22,386 --> 00:19:24,206
to jump into the Info.plist.

373
00:19:24,636 --> 00:19:26,806
And open up that

374
00:19:27,336 --> 00:19:32,166
And as you can see,

375
00:19:32,166 --> 00:19:35,596
from the template, we have a

376
00:19:36,006 --> 00:19:38,736
and the website access that

377
00:19:39,146 --> 00:19:41,016
I'm going to get rid

378
00:19:41,016 --> 00:19:42,446
because our extension

379
00:19:43,096 --> 00:19:47,256
And change the access level

380
00:19:47,256 --> 00:19:49,816
of allowed domains because

381
00:19:50,016 --> 00:19:51,586
to run on every page.

382
00:19:52,636 --> 00:19:55,866
The next thing I'm going to do

383
00:19:56,456 --> 00:19:59,746
and I'm just going to bring in

384
00:19:59,746 --> 00:20:01,496
for my Chrome extension

385
00:19:59,746 --> 00:20:01,496
for my Chrome extension

386
00:20:03,336 --> 00:20:05,896
And as you can see, when

387
00:20:05,896 --> 00:20:08,916
into the page, it just calls

388
00:20:09,176 --> 00:20:11,506
and replaces bear

389
00:20:12,136 --> 00:20:15,156
Now, what I would like to

390
00:20:15,156 --> 00:20:17,036
like to have it replaced,

391
00:20:17,036 --> 00:20:18,966
I would like to have it

392
00:20:19,146 --> 00:20:20,576
and the users can choose

393
00:20:20,576 --> 00:20:22,736
which animals they

394
00:20:23,166 --> 00:20:25,956
I'm not going to design

395
00:20:26,356 --> 00:20:30,196
but to support that, we need

396
00:20:30,196 --> 00:20:31,436
from the app extension.

397
00:20:31,926 --> 00:20:35,526
So, instead of doing this

398
00:20:36,216 --> 00:20:38,926
we're going to send

399
00:20:38,926 --> 00:20:42,636
to the app extension asking it

400
00:20:43,306 --> 00:20:45,606
And so one thing that's

401
00:20:45,606 --> 00:20:47,496
that Safari's extensions,

402
00:20:47,496 --> 00:20:51,176
Safari app extension content

403
00:20:51,176 --> 00:20:54,486
dom has loaded for more

404
00:20:55,016 --> 00:20:58,386
But since a word replacer

405
00:20:58,386 --> 00:21:01,966
dom, we want to wait until the

406
00:20:58,386 --> 00:21:01,966
dom, we want to wait until the

407
00:21:01,966 --> 00:21:02,706
this message.

408
00:21:03,706 --> 00:21:05,666
So, now let's go to

409
00:21:06,286 --> 00:21:09,376
and as you can see, we

410
00:21:09,376 --> 00:21:13,836
for message received with

411
00:21:14,646 --> 00:21:19,246
So, we're going to get rid

412
00:21:19,506 --> 00:21:22,786
with some, with the code that

413
00:21:23,166 --> 00:21:25,376
Which all it does is

414
00:21:25,436 --> 00:21:28,376
and sends a response back

415
00:21:28,876 --> 00:21:31,196
And we're making two

416
00:21:31,226 --> 00:21:31,956
because we can.

417
00:21:33,356 --> 00:21:35,716
So, let's go back to the

418
00:21:35,716 --> 00:21:37,986
for this message and act on it.

419
00:21:42,776 --> 00:21:45,516
And once again, this is

420
00:21:45,516 --> 00:21:47,046
about a few minutes ago.

421
00:21:47,456 --> 00:21:49,146
We start by adding

422
00:21:49,146 --> 00:21:51,886
for the message event

423
00:21:52,766 --> 00:21:56,686
And when that event listener

424
00:21:56,686 --> 00:22:00,236
and get our replacements

425
00:21:56,686 --> 00:22:00,236
and get our replacements

426
00:22:00,336 --> 00:22:03,976
And we act on them by iterating

427
00:22:04,256 --> 00:22:06,636
and calling that same

428
00:22:06,636 --> 00:22:08,106
at the beginning of

429
00:22:08,856 --> 00:22:12,236
So, now I would like to build

430
00:22:12,236 --> 00:22:13,706
to discover this new extension.

431
00:22:20,436 --> 00:22:23,036
And you can just imagine

432
00:22:23,036 --> 00:22:23,866
and I've checked a few.

433
00:22:24,816 --> 00:22:28,996
So, I'm just trying out

434
00:22:28,996 --> 00:22:29,826
for the first time.

435
00:22:30,106 --> 00:22:32,496
So, I have not signed up for

436
00:22:32,496 --> 00:22:33,896
up for the Apple

437
00:22:33,896 --> 00:22:36,546
yet which means I don't have

438
00:22:36,976 --> 00:22:40,086
By default, Safari

439
00:22:40,086 --> 00:22:42,676
allow users to enable

440
00:22:42,676 --> 00:22:44,066
with the developer certificate.

441
00:22:44,466 --> 00:22:46,566
But for those of you who

442
00:22:46,876 --> 00:22:49,496
we've added way for

443
00:22:49,496 --> 00:22:51,476
to test your unsigned

444
00:22:51,946 --> 00:22:55,916
To do that, I'm going to open

445
00:22:56,366 --> 00:22:58,526
and show the Develop

446
00:22:59,176 --> 00:23:00,456
And from the Develop menu,

447
00:22:59,176 --> 00:23:00,456
And from the Develop menu,

448
00:23:00,716 --> 00:23:03,516
I'm going to select Allow

449
00:23:04,176 --> 00:23:05,376
I'm going to type my password

450
00:23:06,256 --> 00:23:09,966
and now the animal

451
00:23:09,966 --> 00:23:11,286
up in our list of extensions.

452
00:23:11,966 --> 00:23:15,516
I'm going to turn it on and

453
00:23:15,516 --> 00:23:17,496
I was researching the

454
00:23:17,856 --> 00:23:21,676
So I'm just going to reload

455
00:23:21,816 --> 00:23:24,436
bear has now been placed,

456
00:23:24,726 --> 00:23:27,366
and salmon has been replaced

457
00:23:29,446 --> 00:23:31,446
[ Applause ]

458
00:23:31,876 --> 00:23:34,056
And this is just going to

459
00:23:34,056 --> 00:23:34,776
for me to browse.

460
00:23:39,936 --> 00:23:43,596
So, that was how a Safari

461
00:23:43,596 --> 00:23:47,346
content and how your extension

462
00:23:47,346 --> 00:23:48,276
like access to.

463
00:23:49,036 --> 00:23:51,456
The last type of extension that

464
00:23:51,456 --> 00:23:55,736
to make is one that extends

465
00:23:55,736 --> 00:23:59,796
and functionality of your

466
00:24:00,296 --> 00:24:01,566
And to show us how to do that,

467
00:24:01,886 --> 00:24:03,456
I'd like to invite

468
00:24:03,886 --> 00:24:04,236
Damian?

469
00:24:06,516 --> 00:24:09,026
[ Applause ]

470
00:24:09,526 --> 00:24:11,006
&gt;&gt; Hello, everyone.

471
00:24:11,006 --> 00:24:13,956
My name is Damian Kaleta and I'm

472
00:24:15,106 --> 00:24:17,276
So, Brian already told

473
00:24:17,276 --> 00:24:20,386
of Safari App Extensions and now

474
00:24:20,856 --> 00:24:22,916
I want to tell you how you

475
00:24:23,916 --> 00:24:24,426
So, let's start.

476
00:24:25,686 --> 00:24:28,146
I've written this

477
00:24:28,706 --> 00:24:29,456
It's a notebook app.

478
00:24:30,186 --> 00:24:32,776
And as you can see

479
00:24:32,776 --> 00:24:34,366
the icon got some love

480
00:24:34,366 --> 00:24:35,886
Unfortunately, the

481
00:24:36,276 --> 00:24:38,926
But nevertheless, it

482
00:24:39,086 --> 00:24:41,046
saves it so I can view it later.

483
00:24:41,996 --> 00:24:45,866
But now I want to be

484
00:24:45,866 --> 00:24:49,426
of web pages directly and

485
00:24:50,396 --> 00:24:52,516
And with the new Safari

486
00:24:53,606 --> 00:24:55,036
I have all the tools

487
00:24:55,036 --> 00:24:56,836
to build my extension

488
00:24:57,856 --> 00:25:00,096
I'm going to need

489
00:24:57,856 --> 00:25:00,096
I'm going to need

490
00:25:00,606 --> 00:25:03,996
So, I want to be able to

491
00:25:03,996 --> 00:25:05,076
to be able to save it.

492
00:25:06,156 --> 00:25:09,046
For that, I'll use

493
00:25:10,406 --> 00:25:14,536
Secondly, I want to be able

494
00:25:15,336 --> 00:25:19,046
and I want to be

495
00:25:19,586 --> 00:25:20,826
For that, I'll use a popover.

496
00:25:21,866 --> 00:25:25,186
The popover shows up when the

497
00:25:25,536 --> 00:25:28,296
So, let's talk about that first.

498
00:25:28,826 --> 00:25:32,646
The toolbar button

499
00:25:32,646 --> 00:25:33,796
to the Smart Search field.

500
00:25:34,436 --> 00:25:37,466
That way your users have

501
00:25:37,466 --> 00:25:40,516
to the functionality that

502
00:25:41,476 --> 00:25:43,376
As you would expect, if

503
00:25:43,376 --> 00:25:45,386
of course you can move

504
00:25:46,566 --> 00:25:48,716
So, how did I add my button?

505
00:25:49,336 --> 00:25:52,826
I went to my extension's

506
00:25:53,246 --> 00:25:56,236
and I've added

507
00:25:56,986 --> 00:25:59,656
Together with four

508
00:26:00,546 --> 00:26:05,526
Identifier, label,

509
00:26:06,786 --> 00:26:12,136
And as with all toolbar items

510
00:26:12,136 --> 00:26:14,036
that I'm using a PDF file here.

511
00:26:15,686 --> 00:26:19,256
Okay, so Safari now displays my

512
00:26:19,256 --> 00:26:22,906
to my extension when the user

513
00:26:24,236 --> 00:26:27,016
Safari sends toolbar

514
00:26:27,766 --> 00:26:29,166
to your principal object.

515
00:26:30,116 --> 00:26:33,006
And as a reminder, your

516
00:26:33,426 --> 00:26:35,146
that handles all of

517
00:26:35,146 --> 00:26:37,846
between Safari and

518
00:26:39,166 --> 00:26:41,936
And also if you want to gray

519
00:26:41,936 --> 00:26:45,756
on the context, Safari provides

520
00:26:46,346 --> 00:26:49,556
And you can also set batch

521
00:26:50,126 --> 00:26:51,916
That usually represents

522
00:26:51,916 --> 00:26:54,926
such as in red count.

523
00:26:55,516 --> 00:26:59,056
So, we've got ourselves a

524
00:26:59,056 --> 00:27:03,566
to display a popover when

525
00:26:59,056 --> 00:27:03,566
to display a popover when

526
00:27:03,876 --> 00:27:07,286
The popover lets me insert

527
00:27:07,686 --> 00:27:11,556
which is great because if you

528
00:27:11,556 --> 00:27:13,946
before, you're going

529
00:27:13,946 --> 00:27:16,306
that code really

530
00:27:16,996 --> 00:27:18,396
So, let me show you

531
00:27:19,426 --> 00:27:23,406
You have your extension

532
00:27:24,466 --> 00:27:28,956
and then you'll want to define

533
00:27:28,956 --> 00:27:30,826
on your principal object.

534
00:27:32,036 --> 00:27:34,626
Inside that method,

535
00:27:34,626 --> 00:27:38,696
to custom view controller it

536
00:27:38,696 --> 00:27:40,176
to insert in that popover.

537
00:27:40,716 --> 00:27:43,906
On the other side,

538
00:27:44,676 --> 00:27:47,536
and Safari process is something

539
00:27:48,426 --> 00:27:51,656
That remote view will

540
00:27:51,656 --> 00:27:55,776
and display its contents

541
00:27:56,516 --> 00:27:59,676
And as you would expect, we

542
00:27:59,676 --> 00:28:01,286
of the events such

543
00:27:59,676 --> 00:28:01,286
of the events such

544
00:28:01,786 --> 00:28:05,646
And a way to show the popover

545
00:28:05,646 --> 00:28:11,356
of popover instead of command

546
00:28:11,726 --> 00:28:12,286
And that's it.

547
00:28:12,286 --> 00:28:15,286
At this point, Safari knows that

548
00:28:15,286 --> 00:28:17,516
so you will look for that

549
00:28:18,096 --> 00:28:22,736
The popover also comes with

550
00:28:23,236 --> 00:28:26,336
And as you can see here, the

551
00:28:26,336 --> 00:28:27,736
and the popoverWillClose.

552
00:28:28,276 --> 00:28:30,336
It can help you do some

553
00:28:31,396 --> 00:28:33,226
And the third one

554
00:28:33,256 --> 00:28:35,436
It's the one that

555
00:28:35,436 --> 00:28:36,006
view controller.

556
00:28:37,006 --> 00:28:38,456
Okay, so we've added the button.

557
00:28:38,456 --> 00:28:40,706
We can display a popover.

558
00:28:41,216 --> 00:28:44,096
Now let's talk about

559
00:28:44,096 --> 00:28:52,106
So, you typically want to use

560
00:28:52,106 --> 00:28:54,376
to act on part of the page.

561
00:28:54,986 --> 00:28:56,906
But in my case, I

562
00:28:56,906 --> 00:28:59,516
to select the text

563
00:29:00,226 --> 00:29:02,786
So, I went again to my

564
00:29:03,096 --> 00:29:06,236
and then I've added

565
00:29:07,496 --> 00:29:09,516
It's an array of dictionaries

566
00:29:09,516 --> 00:29:12,016
that hold two different

567
00:29:12,606 --> 00:29:14,556
Text and command.

568
00:29:15,966 --> 00:29:18,256
And then when the user presses

569
00:29:18,256 --> 00:29:20,596
or clicks your context

570
00:29:21,466 --> 00:29:24,186
Safari will send

571
00:29:24,646 --> 00:29:25,836
to the principal object.

572
00:29:27,596 --> 00:29:31,356
Please notice that we are

573
00:29:32,036 --> 00:29:35,846
This will simply represent any

574
00:29:35,846 --> 00:29:38,566
want to include from

575
00:29:39,516 --> 00:29:45,036
Such as in my case, I want to be

576
00:29:45,616 --> 00:29:48,986
So, inside my injected script

577
00:29:48,986 --> 00:29:49,906
for context menu.

578
00:29:50,706 --> 00:29:54,636
And then inside that function

579
00:29:54,636 --> 00:29:58,106
event userInfo on the

580
00:29:59,286 --> 00:30:03,086
And notice that I'm actually

581
00:29:59,286 --> 00:30:03,086
And notice that I'm actually

582
00:30:04,396 --> 00:30:08,536
Okay. So now I'm excited to show

583
00:30:08,536 --> 00:30:09,296
it into Safari.

584
00:30:09,906 --> 00:30:15,226
So, let's do that.

585
00:30:16,036 --> 00:30:17,466
So, before I show you any code,

586
00:30:17,846 --> 00:30:20,556
this is my simple macOS

587
00:30:20,556 --> 00:30:22,636
As you can see, I

588
00:30:23,066 --> 00:30:25,466
I can insert my note

589
00:30:25,936 --> 00:30:28,606
etc. So, let's go to Xcode.

590
00:30:29,176 --> 00:30:31,156
I want to show you

591
00:30:31,826 --> 00:30:34,006
First, Info.plist.

592
00:30:35,916 --> 00:30:39,926
So, please notice that I'm

593
00:30:39,926 --> 00:30:40,656
right over here.

594
00:30:41,456 --> 00:30:43,426
Here's my text and my command.

595
00:30:44,326 --> 00:30:46,206
And I'm also adding

596
00:30:46,456 --> 00:30:50,006
I have my, all of my four

597
00:30:50,006 --> 00:30:50,676
over here.

598
00:30:50,676 --> 00:30:54,496
And as you can see,

599
00:30:55,376 --> 00:30:59,506
Second thing I want to show

600
00:31:00,286 --> 00:31:04,856
Let me just make it like that.

601
00:31:05,396 --> 00:31:08,466
And I have overridden

602
00:31:08,466 --> 00:31:09,636
on my principal object.

603
00:31:09,816 --> 00:31:11,746
The first one is

604
00:31:12,176 --> 00:31:15,366
This will simply return

605
00:31:15,696 --> 00:31:17,826
that represents the

606
00:31:17,826 --> 00:31:19,636
that displaced in the popover.

607
00:31:20,276 --> 00:31:22,156
And the second one

608
00:31:22,156 --> 00:31:23,286
Selected(withCommand.

609
00:31:24,066 --> 00:31:26,816
And as you can see, I'm getting

610
00:31:26,926 --> 00:31:28,936
and assigning my

611
00:31:28,936 --> 00:31:36,916
And third thing I want to show

612
00:31:36,916 --> 00:31:41,716
the code and share it between

613
00:31:42,326 --> 00:31:45,616
Of course normally you

614
00:31:45,616 --> 00:31:48,436
You would use a framework

615
00:31:49,536 --> 00:31:51,176
So, this is my notes manager.

616
00:31:51,686 --> 00:31:55,716
It will simply read and

617
00:31:56,086 --> 00:31:58,816
It has some simple methods

618
00:31:58,816 --> 00:32:03,266
removeLastNote, etc.

619
00:31:58,816 --> 00:32:03,266
removeLastNote, etc.

620
00:32:03,266 --> 00:32:07,796
that my target membership is set

621
00:32:08,336 --> 00:32:10,406
which is macOS app

622
00:32:11,646 --> 00:32:17,366
Okay. So, now let me go

623
00:32:17,766 --> 00:32:21,216
and as you can see, my

624
00:32:21,216 --> 00:32:22,326
to the Smart Search field.

625
00:32:23,476 --> 00:32:25,726
I can click it and

626
00:32:25,886 --> 00:32:27,676
my most recent note will appear.

627
00:32:28,136 --> 00:32:32,106
So, let's say and, let me just

628
00:32:33,106 --> 00:32:33,886
Side to side.

629
00:32:34,366 --> 00:32:37,316
So, let's say I'm

630
00:32:37,796 --> 00:32:43,026
and let's pick this one.

631
00:32:43,446 --> 00:32:48,006
And let's say that I want to

632
00:32:48,006 --> 00:32:50,756
So, let's say I select

633
00:32:50,976 --> 00:32:54,446
I command, CTL click it.

634
00:32:54,566 --> 00:32:57,386
And then I say add

635
00:32:58,526 --> 00:33:03,916
Like so. As you can see, my note

636
00:32:58,526 --> 00:33:03,916
Like so. As you can see, my note

637
00:33:04,536 --> 00:33:09,136
I can open my extension

638
00:33:09,496 --> 00:33:11,546
And now if I want to

639
00:33:11,846 --> 00:33:16,096
because let's say I don't

640
00:33:16,196 --> 00:33:20,236
I can simply delete that,

641
00:33:20,466 --> 00:33:22,076
It's reflected in my macOS app.

642
00:33:22,536 --> 00:33:26,426
So, it's that simple to create

643
00:33:26,426 --> 00:33:29,806
between your macOS

644
00:33:30,456 --> 00:33:36,206
So, I showed you

645
00:33:36,446 --> 00:33:38,716
I showed you how to

646
00:33:38,716 --> 00:33:41,176
and add multiple

647
00:33:42,666 --> 00:33:44,286
Now I want to hand

648
00:33:45,516 --> 00:33:48,500
[ Applause ]

649
00:33:54,286 --> 00:33:55,056
&gt;&gt; Thanks, Damian.

650
00:33:55,806 --> 00:33:57,176
Except for leaving

651
00:33:58,676 --> 00:34:02,366
So, today we showed you

652
00:33:58,676 --> 00:34:02,366
So, today we showed you

653
00:34:02,366 --> 00:34:04,746
that are made possible with

654
00:34:05,506 --> 00:34:08,366
We showed how easy it is to

655
00:34:08,476 --> 00:34:11,896
from iOS to the Mac

656
00:34:12,045 --> 00:34:14,126
to get the state of

657
00:34:14,446 --> 00:34:15,976
in response to your feedback.

658
00:34:16,656 --> 00:34:19,466
We saw how simple it is to

659
00:34:19,666 --> 00:34:23,985
that modifies webpages to Safari

660
00:34:23,985 --> 00:34:26,775
with the native Swift code

661
00:34:27,295 --> 00:34:30,906
And lastly, we saw how it had

662
00:34:30,906 --> 00:34:33,346
of your app directly to Safari.

663
00:34:34,176 --> 00:34:37,706
And remember, Safari app

664
00:34:37,706 --> 00:34:38,766
on app extensions.

665
00:34:39,146 --> 00:34:42,266
Which means you have the power

666
00:34:42,266 --> 00:34:46,176
in your app extension

667
00:34:46,335 --> 00:34:49,856
and your CSS used to

668
00:34:50,616 --> 00:34:53,416
And since Safari app

669
00:34:53,416 --> 00:34:57,226
with your Mac app, there's an

670
00:34:57,226 --> 00:35:00,516
for your users and you can

671
00:34:57,226 --> 00:35:00,516
for your users and you can

672
00:35:00,636 --> 00:35:01,686
in the Mac App Store.

673
00:35:02,356 --> 00:35:05,756
For more information about the

674
00:35:06,066 --> 00:35:07,526
please visit this page.

675
00:35:07,906 --> 00:35:11,556
Safari app extensions are the

676
00:35:11,596 --> 00:35:13,316
to make them the best

677
00:35:13,726 --> 00:35:15,866
Please give us some

678
00:35:15,866 --> 00:35:17,796
and any bugs you find.

679
00:35:18,056 --> 00:35:20,806
On the More Information page,

680
00:35:20,806 --> 00:35:24,296
that feedback and the email

681
00:35:24,296 --> 00:35:26,376
our Safari and WebKit

682
00:35:27,126 --> 00:35:29,966
And for related sessions,

683
00:35:29,966 --> 00:35:33,126
out some of the app extension

684
00:35:34,266 --> 00:35:35,486
Thank you so much.

685
00:35:36,516 --> 00:35:40,500
[ Applause ]
