1
00:00:01,176 --> 0:00:05,500
[音乐]

2
00:00:11,516 --> 0:00:16,546
[掌声]

3
00:00:17,046 --> 0:00:18,406
&gt;&gt; 大家好

4
00:00:18,876 --> 0:00:20,906
我的名字是 Gokul 

5
00:00:20,906 --> 0:00:22,846
与我的同事 Dima 

6
00:00:22,846 --> 0:00:24,916
和 Jonathan 一起

7
00:00:24,916 --> 0:00:26,616
我们很高兴告诉大家有关

8
00:00:26,806 --> 0:00:27,216
Sign in with Apple 的事

9
00:00:27,616 --> 0:00:30,196
我将首先概述

10
00:00:30,196 --> 0:00:31,416
Sign in with Apple 的主要功能

11
00:00:31,416 --> 0:00:33,486
然后 Dima 将介绍

12
00:00:33,486 --> 0:00:34,966
如何将其集成到

13
00:00:34,966 --> 0:00:36,696
你们的原生 App 中

14
00:00:37,276 --> 0:00:39,916
Jonathan 将会现场为你们演示

15
00:00:40,436 --> 0:00:44,756
最后 我们将讨论跨平台

16
00:00:44,756 --> 0:00:45,966
并以一些最佳实践作为结束

17
00:00:49,516 --> 0:00:53,236
Sign in with Apple 是快速的

18
00:00:53,236 --> 0:00:55,536
简单的账户设置

19
00:00:55,536 --> 0:00:56,366
以及登录你们的 App 的方式

20
00:00:57,136 --> 0:01:01,206
它既安全又私密

21
00:00:57,136 --> 0:01:01,206
它既安全又私密

22
00:01:01,986 --> 0:01:04,806
既适用于你们的用户

23
00:01:04,806 --> 0:01:05,316
也适用于你们的隐私

24
00:01:05,956 --> 0:01:07,526
了解你们如何

25
00:01:07,526 --> 0:01:10,056
与应用中的用户互动

26
00:01:10,056 --> 0:01:11,326
这与 Apple 无关

27
00:01:12,046 --> 0:01:13,386
因此 你们可以放心地

28
00:01:13,386 --> 0:01:15,576
使用 Sign in with Apple 

29
00:01:15,576 --> 0:01:18,606
Apple 不会跟踪任何此类内容

30
00:01:19,156 --> 0:01:21,576
让我们快速感受一下

31
00:01:21,576 --> 0:01:25,096
当用户轻点该按钮时的体验

32
00:01:26,386 --> 0:01:28,456
他们会看到一张预先填写了

33
00:01:28,456 --> 0:01:30,226
你们要求的信息的表格

34
00:01:30,796 --> 0:01:33,656
如姓名和邮件

35
00:01:34,826 --> 0:01:36,656
用户可以选择他们

36
00:01:36,656 --> 0:01:38,206
想要共享的邮件

37
00:01:39,516 --> 0:01:45,556
他们轻点“Continue”就是这样

38
00:01:45,846 --> 0:01:48,456
他们就登录到你们的 App 了

39
00:01:48,456 --> 0:01:52,746
你们的 App 会获得一个独特稳定的 ID

40
00:01:54,156 --> 0:01:58,296
一个名称以及一个可以

41
00:01:58,296 --> 0:02:00,716
为用户提供的经过验证的

42
00:01:58,296 --> 0:02:00,716
为用户提供的经过验证的

43
00:02:00,716 --> 0:02:01,116
邮件地址

44
00:02:01,986 --> 0:02:04,326
最棒的是 这是一个

45
00:02:04,326 --> 0:02:07,276
安全的双重验证账户

46
00:02:07,276 --> 0:02:09,806
适用于你们 App 中的用户

47
00:02:09,806 --> 0:02:18,946
就是这么简单 更棒的是

48
00:02:19,076 --> 0:02:21,326
这一切都可以在所有用户的

49
00:02:21,326 --> 0:02:22,286
设备上无缝地工作

50
00:02:23,956 --> 0:02:26,266
在一个新设备上 

51
00:02:26,806 --> 0:02:28,456
通过简单的轻点即可让

52
00:02:28,456 --> 0:02:30,456
你们使用与之前 App 相同的账户

53
00:02:30,936 --> 0:02:33,186
并准备好再次完全投入使用

54
00:02:33,576 --> 0:02:34,966
非常快 非常容易

55
00:02:37,046 --> 0:02:38,466
因此 Sign in with Apple

56
00:02:38,616 --> 0:02:40,546
可为你们的 App 提供

57
00:02:40,546 --> 0:02:42,796
真正简化的账户设置体验

58
00:02:42,896 --> 0:02:45,456
无需填写繁琐的表单

59
00:02:45,456 --> 0:02:46,306
只需轻轻一点

60
00:02:47,486 --> 0:02:50,716
用户已使用 Apple ID 从 App Store 

61
00:02:50,716 --> 0:02:53,526
下载了你们的 App

62
00:02:54,086 --> 0:02:55,406
Sign in with Apple 可帮助他们

63
00:02:55,446 --> 0:02:59,726
通过轻点一下 就能使用你们 App

64
00:03:01,396 --> 0:03:03,636
你们还可以获得可用于

65
00:03:03,636 --> 0:03:05,456
与用户通信的经过验证的

66
00:03:05,456 --> 0:03:06,586
邮件地址

67
00:03:07,616 --> 0:03:09,316
这是 Apple 用于通信的

68
00:03:10,146 --> 0:03:13,066
邮件地址

69
00:03:13,996 --> 0:03:15,266
因此 无需进行这些繁琐的

70
00:03:15,266 --> 0:03:16,666
往返发送邮件

71
00:03:16,666 --> 0:03:20,036
并让用户轻点链接

72
00:03:20,726 --> 0:03:23,266
Apple 已经为你们完成了这项工作

73
00:03:24,546 --> 0:03:26,686
登录与 Apple 立即为你们

74
00:03:26,686 --> 0:03:29,676
提供可以使用的邮件

75
00:03:30,066 --> 0:03:31,876
无需额外验证

76
00:03:34,236 --> 0:03:35,966
现在 一些用户可能

77
00:03:35,966 --> 0:03:37,666
不太愿意共享他们的

78
00:03:37,666 --> 0:03:38,406
真实邮件地址

79
00:03:39,316 --> 0:03:40,466
而你们可能最终得到一些

80
00:03:40,506 --> 0:03:42,146
不起作用的假邮件

81
00:03:43,006 --> 0:03:44,526
那么 Sign in with Apple 可以

82
00:03:44,526 --> 0:03:45,016
帮助你们隐藏我的

83
00:03:46,016 --> 0:03:48,436
邮件选项使这些用户可以

84
00:03:48,486 --> 0:03:53,716
共享隐藏的邮件地址 该邮件地址

85
00:03:53,716 --> 0:03:55,596
将路由到其经过验证的邮箱里

86
00:03:56,586 --> 0:03:58,986
这很棒

87
00:03:59,166 --> 0:04:00,976
这是通过 Apple 的

88
00:03:59,166 --> 0:04:00,976
这是通过 Apple 的

89
00:04:00,976 --> 0:04:03,596
私人邮件中继系统启用的

90
00:04:03,596 --> 0:04:06,026
该系统将邮件转发给

91
00:04:06,746 --> 0:04:08,566
用户的已验证邮箱

92
00:04:08,566 --> 0:04:11,586
它也可以处理回复

93
00:04:11,836 --> 0:04:12,866
所以无论收发 它都能处理

94
00:04:13,596 --> 0:04:16,375
你们可以将其用于 

95
00:04:16,375 --> 0:04:19,856
App 的任何类型的业务通信

96
00:04:19,856 --> 0:04:21,846
Apple 一旦将其发送到

97
00:04:21,846 --> 0:04:23,796
用户的收件箱

98
00:04:24,196 --> 0:04:25,206
就不会保留任何消息

99
00:04:26,156 --> 0:04:28,936
总而言之 

100
00:04:29,666 --> 0:04:31,966
经过验证的邮件可以

101
00:04:32,326 --> 0:04:32,976
立即用于你们的 App 

102
00:04:37,266 --> 0:04:39,836
有了 Sign in with Apple

103
00:04:39,836 --> 0:04:42,156
你不需要记住任何密码

104
00:04:42,546 --> 0:04:42,976
所以也不会忘记

105
00:04:45,046 --> 0:04:46,396
因此它就更安全了

106
00:04:47,456 --> 0:04:50,866
更好的是 

107
00:04:50,866 --> 0:04:52,966
你们的 App 收到的每个账户

108
00:04:52,966 --> 0:04:54,266
都受到双重认证保护

109
00:04:55,186 --> 0:04:57,716
这就是你们 App 的最佳账户

110
00:04:58,016 --> 0:05:00,346
无需密码 双重认证

111
00:04:58,016 --> 0:05:00,346
无需密码 双重认证

112
00:05:00,346 --> 0:05:02,746
无需你们投入任何成本

113
00:05:03,146 --> 0:05:05,236
也不会给用户带来额外的摩擦

114
00:05:05,786 --> 0:05:08,206
Sign in with Apple 的

115
00:05:08,206 --> 0:05:09,686
内置安全性极佳

116
00:05:12,046 --> 0:05:15,196
目前 打击系统中的账户欺诈是一个难题

117
00:05:15,196 --> 0:05:20,746
而 Apple 可以提供独特的帮助

118
00:05:20,906 --> 0:05:22,976
Sign in with Apple 包含一种

119
00:05:22,976 --> 0:05:25,946
新的隐私友好方式

120
00:05:25,946 --> 0:05:28,386
让你们获得对你们 App 上的

121
00:05:28,386 --> 0:05:30,426
用户确实真实的信心

122
00:05:31,736 --> 0:05:33,776
它将复杂的设备上智能

123
00:05:33,776 --> 0:05:35,656
与账户信息相结合

124
00:05:36,316 --> 0:05:40,616
并将其抽象为一个比特

125
00:05:40,616 --> 0:05:43,196
真实用户或未知用户

126
00:05:43,976 --> 0:05:46,526
对于真正的用户 在你们的 App 中

127
00:05:46,526 --> 0:05:48,616
给予他们应得的贵宾级的待遇

128
00:05:49,946 --> 0:05:51,906
这是一个高可信度的指示器

129
00:05:52,496 --> 0:05:55,846
如果你得到是未知用户 那它可能是

130
00:05:55,846 --> 0:05:58,306
一个用户 它也可能是一个机器人

131
00:05:59,116 --> 0:06:01,216
对待此用户就像对待

132
00:05:59,116 --> 0:06:01,216
对待此用户就像对待

133
00:06:01,216 --> 0:06:02,786
你们系统中没有

134
00:06:02,786 --> 0:06:04,576
足够信息做出决策的

135
00:06:04,866 --> 0:06:06,366
任何其他新账户一样

136
00:06:07,246 --> 0:06:09,226
因此 这是帮助你们

137
00:06:09,226 --> 0:06:11,406
打击账户欺诈的

138
00:06:11,566 --> 0:06:12,846
真实用户指示器

139
00:06:15,246 --> 0:06:18,976
最后 Sign in with Apple 

140
00:06:18,976 --> 0:06:19,836
是跨平台的

141
00:06:20,726 --> 0:06:23,546
该 API 适用于

142
00:06:23,546 --> 0:06:26,366
所有 Apple 平台：iOS macOS

143
00:06:26,516 --> 0:06:27,636
watchOS tvOS

144
00:06:29,306 --> 0:06:33,336
登录体验适用于每个平台 易于使用

145
00:06:34,406 --> 0:06:36,966
通过 JavaScript API

146
00:06:36,966 --> 0:06:38,616
你们可以在网页上

147
00:06:38,616 --> 0:06:40,726
以及 Windows 或 Android 等

148
00:06:40,756 --> 0:06:42,526
其他平台上 Sign in with Apple

149
00:06:43,356 --> 0:06:44,976
我们稍后会详细讨论 这个问题

150
00:06:45,516 --> 0:06:51,686
[掌声]

151
00:06:52,186 --> 0:06:53,386
简化的账户设置

152
00:06:53,956 --> 0:06:56,536
经过验证的邮件地址

153
00:06:56,536 --> 0:06:58,996
内置安全性 

154
00:06:58,996 --> 0:06:59,906
反欺诈和跨平台

155
00:07:00,366 --> 0:07:02,256
这是 Sign in with Apple 的

156
00:07:02,256 --> 0:07:04,516
关键功能的快速摘要

157
00:07:04,876 --> 0:07:06,696
接下来 Dima 将加入讲台

158
00:07:06,696 --> 0:07:08,336
讨论如何将其

159
00:07:08,336 --> 0:07:10,716
集成到你的原生 App 中

160
00:07:10,996 --> 0:07:14,546
有请 Dima [掌声]

161
00:07:15,046 --> 0:07:15,526
&gt;&gt; 多谢 Gokul

162
00:07:16,416 --> 0:07:19,146
嗨 大家好 那么你们已经看到了

163
00:07:19,636 --> 0:07:19,976
这个很棒的功能

164
00:07:20,606 --> 0:07:21,536
它实际上需要什么来集成到

165
00:07:21,536 --> 0:07:22,656
你们的 App 中呢

166
00:07:26,046 --> 0:07:28,006
你们的 App 需要做四件

167
00:07:28,006 --> 0:07:29,616
关键事情才能实现目标

168
00:07:30,276 --> 0:07:32,816
首先 使用 Apple 的自动登录按钮

169
00:07:34,046 --> 0:07:36,896
然后配置并执行授权请求

170
00:07:38,136 --> 0:07:40,156
在用户看到使用 Sign in with Apple 的 UI

171
00:07:40,156 --> 0:07:41,496
并经过快速面容 ID 检查后

172
00:07:41,836 --> 0:07:46,596
授权结果将返回送至你们的 App

173
00:07:47,036 --> 0:07:48,816
此时 你们需要使用 

174
00:07:48,816 --> 0:07:50,036
Apple ID 服务器验证结果

175
00:07:50,036 --> 0:07:51,976
并在你们的系统中创建一个账户

176
00:07:54,506 --> 0:07:55,966
最后同样重要的是

177
00:07:55,966 --> 0:07:57,546
凭据状态可能会在返回到

178
00:07:57,546 --> 0:07:58,956
你们的 App 后发生更改

179
00:07:58,956 --> 0:08:00,116
并且你们的 App 需要

180
00:07:58,956 --> 0:08:00,116
并且你们的 App 需要

181
00:08:00,116 --> 0:08:02,056
很好地处理这些状态更改

182
00:08:06,136 --> 0:08:08,176
首先 让我们看一下使用

183
00:08:08,176 --> 0:08:10,236
Sign in with Apple 按钮

184
00:08:10,266 --> 0:08:12,416
只需几行代码

185
00:08:12,416 --> 0:08:13,656
你们就可以在你们的 App 中

186
00:08:13,656 --> 0:08:15,886
添加 AuthorizationAppleIDButton

187
00:08:17,096 --> 0:08:21,116
初始化后添加操作

188
00:08:22,396 --> 0:08:24,876
这就是你需要做的一切

189
00:08:25,136 --> 0:08:26,856
该按钮支持多种

190
00:08:26,856 --> 0:08:28,026
不同的自定义

191
00:08:28,026 --> 0:08:28,786
以适应你们 App 的设计

192
00:08:29,696 --> 0:08:30,946
它提供不同的视觉风格

193
00:08:30,946 --> 0:08:32,256
和不同类型的标签

194
00:08:32,946 --> 0:08:35,966
这对目前使用有效 API 

195
00:08:35,966 --> 0:08:37,616
的 App 而言非常熟悉

196
00:08:43,356 --> 0:08:45,566
接下来 一旦用户执行操作

197
00:08:45,566 --> 0:08:49,926
你们需要配置请求并执行授权

198
00:08:52,496 --> 0:08:55,196
下面就是方法

199
00:08:55,196 --> 0:08:56,936
只需一行代码 

200
00:08:56,936 --> 0:08:59,066
即可初始化 Apple ID 授权请求

201
00:09:00,426 --> 0:09:01,806
这是你们在系统中

202
00:09:01,806 --> 0:09:03,186
创建账户所需的全部内容

203
00:09:05,116 --> 0:09:06,776
或者 如果你们的 App 需要

204
00:09:06,776 --> 0:09:08,976
此功能以获得最佳用户体验

205
00:09:08,976 --> 0:09:10,426
则可以设置 requestedScopes 

206
00:09:10,426 --> 0:09:10,886
以获取全名和邮件

207
00:09:12,376 --> 0:09:13,556
如果你们的 App 

208
00:09:13,556 --> 0:09:14,746
确实需要此信息

209
00:09:14,746 --> 0:09:16,496
则应该只请求此信息

210
00:09:16,496 --> 0:09:18,076
并且在最小信息量方面报错

211
00:09:19,786 --> 0:09:22,646
配置完请求后 初始化

212
00:09:22,646 --> 0:09:26,556
AuthorizationController

213
00:09:26,556 --> 0:09:28,576
设置代理以将结果

214
00:09:28,576 --> 0:09:30,416
返回到你们的 App 中

215
00:09:30,416 --> 0:09:33,146
最后同样重要的是执行请求

216
00:09:34,176 --> 0:09:35,366
执行请求后

217
00:09:35,656 --> 0:09:36,666
将启动向用户

218
00:09:36,666 --> 0:09:38,456
显示的授权 UI

219
00:09:39,156 --> 0:09:40,436
快速进行面容 ID 检查后 

220
00:09:41,066 --> 0:09:42,306
授权结果将

221
00:09:42,306 --> 0:09:43,146
返回给你们的 App 

222
00:09:43,776 --> 0:09:44,976
我们来谈谈处理这些结果

223
00:09:48,046 --> 0:09:49,446
通过 AuthorizationController 

224
00:09:49,446 --> 0:09:50,656
didCompleteWithAuthorization

225
00:09:50,656 --> 0:09:52,036
方法 你们将获得

226
00:09:52,036 --> 0:09:54,846
一个授权对象此对象具有 

227
00:09:54,846 --> 0:09:56,306
AppleIDCredential 类型的

228
00:09:56,306 --> 0:09:57,426
凭证属性

229
00:09:57,926 --> 0:09:58,826
在处理之前

230
00:09:58,826 --> 0:09:59,916
你们应该检查

231
00:09:59,916 --> 0:10:00,806
这实际上是 AppleIDCredential

232
00:09:59,916 --> 0:10:00,806
这实际上是 AppleIDCredential

233
00:10:01,856 --> 0:10:02,936
此对象包含

234
00:10:02,936 --> 0:10:05,466
在系统中创建账户所需的所有信息

235
00:10:06,056 --> 0:10:09,036
如果用户取消请求

236
00:10:09,036 --> 0:10:10,556
或发生任何其他错误

237
00:10:10,786 --> 0:10:13,306
我们将通过 didCompleteWithError 回调 

238
00:10:13,306 --> 0:10:13,756
让你的 App 知道

239
00:10:15,106 --> 0:10:16,296
这两个代理回调

240
00:10:16,296 --> 0:10:17,676
都保证在你们的 App 的

241
00:10:17,676 --> 0:10:18,756
主队列中进行

242
00:10:21,626 --> 0:10:22,806
因此 让我们深入了解

243
00:10:22,806 --> 0:10:25,966
我们将为你们的 App 提供的结果

244
00:10:29,276 --> 0:10:30,796
首先 用户标识符

245
00:10:30,796 --> 0:10:32,916
这是一个独特 稳定的

246
00:10:32,916 --> 0:10:34,476
团队范围的用户标识符

247
00:10:35,396 --> 0:10:37,186
这很棒

248
00:10:37,756 --> 0:10:38,676
你们可以使用它

249
00:10:38,676 --> 0:10:41,086
从不同平台 不同系统

250
00:10:41,086 --> 0:10:43,366
网页端 Android 端的

251
00:10:43,676 --> 0:10:44,746
用户系统中检索信息

252
00:10:45,316 --> 0:10:47,046
它在所有这些方面保持稳定

253
00:10:47,046 --> 0:10:49,266
另外它与你们的开发团队有关

254
00:10:50,486 --> 0:10:51,596
这是你们用户的关键

255
00:10:52,586 --> 0:10:55,826
接下来 我们将返回验证数据

256
00:10:55,826 --> 0:10:57,476
身份令牌和授权码

257
00:10:57,916 --> 0:10:59,156
这是一种短期令牌 

258
00:10:59,156 --> 0:11:01,046
可与 Apple ID 服务器一起

259
00:10:59,156 --> 0:11:01,046
可与 Apple ID 服务器一起

260
00:11:01,046 --> 0:11:02,156
使用以交换刷新令牌

261
00:11:03,056 --> 0:11:04,226
如果你们与现有的

262
00:11:04,226 --> 0:11:05,906
身份验证系统集成

263
00:11:05,906 --> 0:11:07,726
那么采用 Sign in with Apple 将会十分自然

264
00:11:10,146 --> 0:11:11,856
或者 如果你们提出要求

265
00:11:11,986 --> 0:11:13,056
我们将返回账户信息

266
00:11:13,056 --> 0:11:16,256
以一个名称和一封可验证的邮件的方式

267
00:11:16,876 --> 0:11:18,176
另外由于 Apple 已对

268
00:11:18,176 --> 0:11:19,496
此邮件进行了验证

269
00:11:19,496 --> 0:11:20,546
因此我们向你们展示后

270
00:11:20,546 --> 0:11:22,936
你们的 App 不再需要执行任何类型的验证

271
00:11:25,046 --> 0:11:26,486
最后 如前所述 

272
00:11:27,766 --> 0:11:28,786
一个真实用户的指示器

273
00:11:28,786 --> 0:11:31,596
使用此选项可简化你们的登录体验

274
00:11:35,046 --> 0:11:36,936
所以现在你们已经在你们的系统中创建了一个账户

275
00:11:37,616 --> 0:11:39,386
当用户在你们的 App 中

276
00:11:39,386 --> 0:11:41,006
使用 Apple 设备时

277
00:11:41,006 --> 0:11:42,136
凭据状态可能会更改

278
00:11:43,006 --> 0:11:44,696
而且你需要妥善地处理这些情景

279
00:11:47,026 --> 0:11:49,066
用户可能会停止在 App 中使用 Apple ID

280
00:11:49,716 --> 0:11:51,126
他们可能会退出设备

281
00:11:51,996 --> 0:11:54,996
你们应当妥善地处理这样的事件

282
00:11:54,996 --> 0:11:56,666
为此 身份验证服务的

283
00:11:56,666 --> 0:11:57,926
框架公开了一个

284
00:11:58,016 --> 0:12:00,976
快速 API 允许你们查询此状态

285
00:11:58,016 --> 0:12:00,976
快速 API 允许你们查询此状态

286
00:12:03,616 --> 0:12:06,246
使用先前通过 Apple ID Credential

287
00:12:06,246 --> 0:12:08,916
返回的用户标识符

288
00:12:08,916 --> 0:12:10,796
你们可以检查 GetCredentialState 

289
00:12:11,286 --> 0:12:12,366
调用以获取

290
00:12:12,366 --> 0:12:13,056
当前 Apple ID 凭据的状态

291
00:12:13,856 --> 0:12:15,126
这是一个非常快速的 API 调用

292
00:12:15,666 --> 0:12:17,246
它可以返回到三件事

293
00:12:18,126 --> 0:12:19,116
我们会告诉你们 用户已获得授权

294
00:12:19,116 --> 0:12:20,326
并且你们应该让他们

295
00:12:20,326 --> 0:12:21,656
继续使用你们的 App

296
00:12:23,216 --> 0:12:24,546
凭证可能会被撤销

297
00:12:24,546 --> 0:12:28,096
你们应该在此设备上

298
00:12:28,096 --> 0:12:29,836
向用户退出你们的 App 

299
00:12:29,836 --> 0:12:33,926
并可选择引导他们重新登陆

300
00:12:34,106 --> 0:12:37,006
notFound 表示用户之前未通过

301
00:12:37,006 --> 0:12:38,806
Sign in with Apple 建立关系

302
00:12:40,376 --> 0:12:41,616
这个 API 非常快

303
00:12:42,026 --> 0:12:43,256
你们应该在 App 启动时

304
00:12:43,256 --> 0:12:44,716
调用它以确保

305
00:12:44,716 --> 0:12:45,846
为每种状态提供

306
00:12:45,846 --> 0:12:46,816
量身定制的体验

307
00:12:49,126 --> 0:12:50,576
此外 我们通过

308
00:12:50,576 --> 0:12:53,116
NotificationCenter 公开通知

309
00:12:53,116 --> 0:12:54,596
以通知你们此凭据状态何时

310
00:12:54,726 --> 0:12:55,566
更改为已撤消

311
00:12:56,256 --> 0:12:57,826
在此设备上把用户退出

312
00:12:58,326 --> 0:13:00,566
并可选择引导他们重新登录

313
00:12:58,326 --> 0:13:00,566
并可选择引导他们重新登录

314
00:13:03,046 --> 0:13:04,236
现在 用户已经与

315
00:13:04,236 --> 0:13:05,266
你们的 App 建立了关系

316
00:13:05,406 --> 0:13:06,836
他们正在使用该 App  他们创建了一个账户

317
00:13:07,146 --> 0:13:08,396
他们总会获得

318
00:13:08,396 --> 0:13:09,856
另一台设备 那么他们会再次

319
00:13:09,856 --> 0:13:10,496
使用你们的 App 

320
00:13:11,266 --> 0:13:12,546
我们来谈谈这个

321
00:13:12,546 --> 0:13:13,566
以及 Sign in with Apple 如何

322
00:13:13,566 --> 0:13:13,766
在这种情况中帮助你们

323
00:13:14,776 --> 0:13:15,796
当用户在新设备上

324
00:13:15,796 --> 0:13:18,616
重返你们的 App 时

325
00:13:18,616 --> 0:13:20,296
他们将获得一键式登录体验

326
00:13:21,556 --> 0:13:22,736
快速进行面容 ID 检查后 

327
00:13:23,046 --> 0:13:25,046
他们会回到你们的 App 中

328
00:13:28,136 --> 0:13:29,856
除此之外 我们知道

329
00:13:29,856 --> 0:13:31,446
你们的系统中已有账户

330
00:13:32,216 --> 0:13:35,256
所以现在我们通过相同的 API

331
00:13:35,256 --> 0:13:36,096
支持 iCloud 钥匙串密码

332
00:13:36,586 --> 0:13:37,236
你们应该请求 

333
00:13:37,236 --> 0:13:38,376
Apple ID 和 iCloud 钥匙串 

334
00:13:38,376 --> 0:13:39,776
请求的身份验证

335
00:13:40,516 --> 0:13:41,476
我们将提供用户继续

336
00:13:41,476 --> 0:13:44,426
使用他们现有的任何凭证

337
00:13:45,306 --> 0:13:46,676
如果重返登入错误

338
00:13:47,116 --> 0:13:48,466
那么请显示你们的常规登录流程

339
00:13:49,256 --> 0:13:50,966
为了获得最佳用户体验

340
00:13:51,266 --> 0:13:54,686
如果 App 没有现有本地账户

341
00:13:54,686 --> 0:13:55,936
则应调用此启动功能

342
00:13:57,186 --> 0:13:58,286
那么让我们来看看

343
00:13:58,286 --> 0:13:58,976
实现它是多么容易

344
00:14:03,046 --> 0:14:07,816
首先 使用 Apple ID 授权请求

345
00:14:08,116 --> 0:14:10,476
和 Apple ID 密码

346
00:14:10,476 --> 0:14:13,396
请求初始化请求数组 这就行了

347
00:14:13,596 --> 0:14:14,686
就这么简单

348
00:14:15,436 --> 0:14:18,976
传递请求数组并执行请求

349
00:14:22,276 --> 0:14:25,036
如果存在一个 Sign in with Apple 的现有连接

350
00:14:25,036 --> 0:14:26,216
则一个 AppleIDCredential 将会被

351
00:14:26,216 --> 0:14:27,726
返还到你们的 App

352
00:14:29,666 --> 0:14:31,606
如果用户具有存储的 

353
00:14:31,606 --> 0:14:33,346
iCloud 钥匙串密码

354
00:14:33,346 --> 0:14:34,526
则该凭据将会被返回到

355
00:14:34,526 --> 0:14:35,426
你们的 App

356
00:14:35,646 --> 0:14:36,646
你们应该使用从此 API 

357
00:14:36,646 --> 0:14:38,936
获得的凭据来帮用户登录

358
00:14:39,516 --> 0:14:41,696
如果用户没有现有凭据

359
00:14:41,696 --> 0:14:43,526
API 将立即返回

360
00:14:43,526 --> 0:14:44,666
报错 而且你们应该

361
00:14:44,666 --> 0:14:46,326
显示标准登录流

362
00:14:47,876 --> 0:14:49,316
通过在启动时

363
00:14:49,316 --> 0:14:51,766
执行这些请求 

364
00:14:51,766 --> 0:14:53,006
你们可以防止系统中的

365
00:14:53,006 --> 0:14:55,436
账户重复 并简化

366
00:14:55,436 --> 0:14:56,676
返回 App 然后开始使用它

367
00:14:56,676 --> 0:14:57,816
的用户体验

368
00:15:00,276 --> 0:15:01,706
现在 我想在叫 Jonathan 来舞台

369
00:15:01,706 --> 0:15:04,596
以演示如何轻松地构建它

370
00:15:05,516 --> 0:15:08,646
[掌声]

371
00:15:09,146 --> 0:15:09,646
&gt;&gt; 多谢 Dima

372
00:15:09,646 --> 0:15:10,766
大家早上好

373
00:15:11,856 --> 0:15:13,116
Sign in with Apple 可以简化

374
00:15:13,116 --> 0:15:14,636
用户创建账户或

375
00:15:14,636 --> 0:15:15,866
登录 App 的方式

376
00:15:15,866 --> 0:15:17,486
同时保持强大的账户安全性

377
00:15:18,226 --> 0:15:19,696
密码自动填充和

378
00:15:19,696 --> 0:15:21,126
自动强密码已经使你们

379
00:15:21,126 --> 0:15:22,126
可以执行其中一些操作

380
00:15:22,936 --> 0:15:24,416
Sign in with Apple 进一步

381
00:15:24,416 --> 0:15:25,656
改进它们 你们可以使用

382
00:15:25,656 --> 0:15:27,066
与 Sign in with Apple 相同的

383
00:15:27,066 --> 0:15:29,046
本机 API 与密码自动

384
00:15:29,046 --> 0:15:30,596
填充密码集成

385
00:15:30,596 --> 0:15:32,616
我将带你们看看

386
00:15:32,676 --> 0:15:34,556
三个主题 以让你们的用户

387
00:15:34,556 --> 0:15:36,996
使用 Apple ID 登录你们的 App 

388
00:15:38,196 --> 0:15:39,606
首先 我将 Sign in with Apple

389
00:15:39,606 --> 0:15:41,146
按钮添加到登录表单中

390
00:15:41,906 --> 0:15:43,146
然后 我将向你们展示

391
00:15:43,146 --> 0:15:44,576
如何实施快速登录流程

392
00:15:44,576 --> 0:15:46,826
这允许了用户只需

393
00:15:46,826 --> 0:15:49,876
轻轻一按即可登录现有凭据

394
00:15:50,696 --> 0:15:52,306
最后 我将向你们展示

395
00:15:52,346 --> 0:15:54,296
如何在 App 启动后

396
00:15:54,326 --> 0:15:56,446
检查用户标识符的凭据状态

397
00:15:56,446 --> 0:15:57,836
以确保你们的用户

398
00:15:57,836 --> 0:15:58,936
已正确登录

399
00:16:00,536 --> 0:16:02,916
为了向你们展示这一切 

400
00:16:02,916 --> 0:16:03,336
我有一个测试 App 

401
00:16:03,476 --> 0:16:04,106
名字叫《Juice》

402
00:16:05,376 --> 0:16:06,746
在这里 你们可以看到

403
00:16:06,746 --> 0:16:07,876
带有邮件和密码的

404
00:16:07,876 --> 0:16:08,286
典型登录表单

405
00:16:09,566 --> 0:16:10,246
我们将在它下面

406
00:16:10,246 --> 0:16:12,136
添加另一个选项 Sign in with Apple

407
00:16:13,666 --> 0:16:14,366
让我们开始吧

408
00:16:15,146 --> 0:16:16,496
我们在项目设置中

409
00:16:16,496 --> 0:16:17,836
有一个先决条件

410
00:16:18,076 --> 0:16:20,306
即添加 Sign in with Apple 功能

411
00:16:23,376 --> 0:16:24,976
因此 在你们的项目设置中 

412
00:16:25,096 --> 0:16:25,796
你们需要选择 App 并

413
00:16:25,796 --> 0:16:29,176
转到“Signing & Capabilities”部分

414
00:16:29,966 --> 0:16:31,336
我已经在这里添加了 

415
00:16:31,336 --> 0:16:32,686
Sign in with Apple 的功能

416
00:16:32,686 --> 0:16:35,786
要在你们的 App 中添加它

417
00:16:35,786 --> 0:16:36,916
请继续并单击 Capability

418
00:16:36,916 --> 0:16:38,246
按钮 然后搜索 

419
00:16:38,246 --> 0:16:38,776
Sign in with Apple

420
00:16:41,046 --> 0:16:42,446
执行此操作时

421
00:16:42,446 --> 0:16:43,766
Xcode 将在你们 App 的

422
00:16:43,766 --> 0:16:45,176
授权文件中添加相应的条目

423
00:16:46,306 --> 0:16:47,576
然后 这将检查

424
00:16:47,576 --> 0:16:49,006
你们是否已将 Sign in with Apple 功能

425
00:16:49,006 --> 0:16:51,906
添加到 Developer Portal 中的 Apple ID

426
00:16:55,066 --> 0:16:56,296
如果你们尚未这样做 

427
00:16:56,446 --> 0:16:57,836
则需要继续然后

428
00:16:57,836 --> 0:16:59,336
登录 Developer Portal 

429
00:16:59,336 --> 0:17:00,906
并确保已添加此功能

430
00:16:59,336 --> 0:17:00,906
并确保已添加此功能

431
00:17:06,346 --> 0:17:07,536
所以在这里 我想强调

432
00:17:07,536 --> 0:17:09,175
在这里看到的 

433
00:17:09,215 --> 0:17:10,626
Associated Domains 功能

434
00:17:11,955 --> 0:17:13,396
这将确保你们在

435
00:17:13,435 --> 0:17:15,576
创建 ASAuthorizationPassword 

436
00:17:15,576 --> 0:17:17,215
请求时将密码返回到

437
00:17:17,215 --> 0:17:20,476
凭证中并呈现给用户 

438
00:17:21,016 --> 0:17:22,086
我稍后将向你们展示如何

439
00:17:22,086 --> 0:17:23,366
在演示中添加其中一个请求

440
00:17:24,726 --> 0:17:25,836
如果你们希望密码

441
00:17:25,836 --> 0:17:27,695
请求提供

442
00:17:27,695 --> 0:17:29,406
正确的凭据

443
00:17:29,406 --> 0:17:32,176
请参键 2017 年的

444
00:17:32,176 --> 0:17:34,306
《Password Autofill for Apps》会议

445
00:17:34,306 --> 0:17:35,766
以及周四的

446
00:17:35,766 --> 0:17:36,506
《What's New in Authentication》会议

447
00:17:37,656 --> 0:17:38,646
好了 我要回到 Xcode

448
00:17:38,646 --> 0:17:41,926
来看看《Juice》App

449
00:17:45,046 --> 0:17:45,976
如你们所见 这只是一个

450
00:17:45,976 --> 0:17:48,106
简单的演示 App 

451
00:17:48,106 --> 0:17:49,556
以突出此 API 的一些关键功能

452
00:17:50,996 --> 0:17:52,816
在它或标签下面

453
00:17:52,816 --> 0:17:56,076
我有一个名为“Login Provider Stack View”

454
00:17:57,106 --> 0:17:58,256
这是我们要添加

455
00:17:58,256 --> 0:17:59,926
Sign in with Apple 按钮的地方

456
00:18:02,516 --> 0:18:03,836
添加 Sign in with Apple

457
00:18:03,836 --> 0:18:06,046
按钮需要分三步来完成

458
00:18:06,686 --> 0:18:08,356
首先 我将在我们的“Provider Stack View”

459
00:18:08,356 --> 0:18:10,086
中添加 Sign in with Apple 按钮

460
00:18:10,836 --> 0:18:13,456
然后我将定义一个函数

461
00:18:13,456 --> 0:18:15,126
该函数将在轻点按钮时

462
00:18:15,126 --> 0:18:15,776
创建并执行请求

463
00:18:15,776 --> 0:18:18,146
最后 我们将采用

464
00:18:18,146 --> 0:18:21,026
必要的身份验证服务协议

465
00:18:21,026 --> 0:18:22,166
为我们提供结果

466
00:18:23,336 --> 0:18:25,216
所以让我们开始

467
00:18:25,216 --> 0:18:26,456
通过在我们的 UI 中添加

468
00:18:26,456 --> 0:18:28,376
Sign in with Apple 按钮来实现这一点

469
00:18:28,376 --> 0:18:28,726
让我们来看看

470
00:18:28,726 --> 0:18:30,216
LoginViewController.swift 文件

471
00:18:36,046 --> 0:18:37,336
因此我们将

472
00:18:37,336 --> 0:18:38,886
使用 AuthenticationServices 模块

473
00:18:38,886 --> 0:18:40,076
那么我们将继续并

474
00:18:40,076 --> 0:18:41,116
在此处导入

475
00:18:54,076 --> 0:18:56,406
所以我在这里定义了一个

476
00:18:56,656 --> 0:18:58,296
名为 setupProviderLoginView 的函数

477
00:18:58,956 --> 0:19:00,406
它正在初始化

478
00:18:58,956 --> 0:19:00,406
它正在初始化

479
00:19:00,406 --> 0:19:02,616
ASAuthorizationAppleIDButton

480
00:19:03,236 --> 0:19:04,126
然后它添加了

481
00:19:04,126 --> 0:19:05,606
handleAuthorizationAppleID 

482
00:19:05,606 --> 0:19:07,336
ButtonPress 函数

483
00:19:07,336 --> 0:19:09,276
我在这里将其作为其动作存根 

484
00:19:10,026 --> 0:19:12,146
然后我将按钮添加到

485
00:19:12,146 --> 0:19:14,056
loginProviderStackView

486
00:19:14,056 --> 0:19:16,496
然后在我们的 UI 中显示它

487
00:19:16,496 --> 0:19:18,666
就在上面 

488
00:19:18,666 --> 0:19:20,166
我正在覆盖 viewDidLoad 函数

489
00:19:20,166 --> 0:19:21,966
这样我们就可以

490
00:19:21,966 --> 0:19:23,536
继续调用 setupProviderLoginView

491
00:19:23,536 --> 0:19:24,036
这将被添加

492
00:19:24,616 --> 0:19:26,686
那么我会继续运行 App

493
00:19:35,136 --> 0:19:36,566
很棒 按钮现在

494
00:19:36,566 --> 0:19:37,276
在我们的 UI 中可见

495
00:19:37,276 --> 0:19:41,246
但它并没有真正做任何事情

496
00:19:41,246 --> 0:19:42,886
所以让我们跳到第二步

497
00:19:42,886 --> 0:19:43,426
为我们的按钮定义动作

498
00:19:54,066 --> 0:19:55,026
好吧 我们来聊聊这个功能

499
00:19:55,026 --> 0:19:57,646
能做什么

500
00:19:57,866 --> 0:19:59,606
其实我们正在做的是

501
00:19:59,606 --> 0:20:02,496
使用 AppleIDProvider 初始化 

502
00:19:59,606 --> 0:20:02,496
使用 AppleIDProvider 初始化 

503
00:20:03,166 --> 0:20:05,606
ASAuthorizationAppleID 请求

504
00:20:05,606 --> 0:20:07,266
然后我们将其 

505
00:20:07,266 --> 0:20:10,236
requestedScopes 属性设置为

506
00:20:10,236 --> 0:20:13,826
包含全名和邮件范围的数组

507
00:20:19,046 --> 0:20:19,846
这部分很关键

508
00:20:20,316 --> 0:20:21,636
系统会要求用户

509
00:20:21,636 --> 0:20:23,286
根据你们在此处设置的范围

510
00:20:23,286 --> 0:20:24,106
来共享信息

511
00:20:24,356 --> 0:20:26,456
然后 该信息将

512
00:20:26,456 --> 0:20:27,816
返回到你们的 Apple ID 凭证  

513
00:20:27,816 --> 0:20:30,316
Apple ID 凭证中

514
00:20:30,876 --> 0:20:32,446
你们应该只要求

515
00:20:32,526 --> 0:20:33,366
你们真正需要的东西

516
00:20:34,296 --> 0:20:35,766
那么让我们回到按钮的动作

517
00:20:39,046 --> 0:20:40,336
所以我们使用我

518
00:20:41,856 --> 0:20:43,636
插入到数组中的

519
00:20:43,636 --> 0:20:45,306
请求初始化控制器

520
00:20:45,306 --> 0:20:46,426
然后将设置和代理 

521
00:20:46,426 --> 0:20:48,296
presentationContextProvider 为 self

522
00:20:49,006 --> 0:20:50,446
然后我们调用 performRequest

523
00:20:57,066 --> 0:20:57,916
现在我们已经定义了动作

524
00:20:57,916 --> 0:20:59,326
让我们继续运行 App 

525
00:21:03,126 --> 0:21:04,356
轻点 Sign in with Apple 按钮 

526
00:21:07,256 --> 0:21:08,616
正如你们所看到的 

527
00:21:08,616 --> 0:21:10,216
UI 正在询问我们

528
00:21:10,576 --> 0:21:12,366
在请求中设置的请求范围

529
00:21:15,316 --> 0:21:17,156
我现在要取消了

530
00:21:20,046 --> 0:21:21,096
还记得 presentationContextProvider

531
00:21:21,096 --> 0:21:22,626
中的这个代理吗

532
00:21:23,966 --> 0:21:25,156
我们将不得不正式采用

533
00:21:25,156 --> 0:21:29,126
为此所需的 authenticationServices 协议

534
00:21:29,696 --> 0:21:31,276
我把它抄到了下面

535
00:21:34,236 --> 0:21:38,126
因此 ASAuthorizationController

536
00:21:38,126 --> 0:21:40,076
一个返回授权

537
00:21:40,156 --> 0:21:41,596
另一个返回错误

538
00:21:45,056 --> 0:21:47,976
让我们继续 

539
00:21:51,026 --> 0:21:52,416
我们将定义 AuthorizationController 

540
00:21:52,416 --> 0:21:53,716
didCompleteWithAuthorization

541
00:21:54,446 --> 0:21:57,086
所以我们在这里做的是

542
00:21:57,086 --> 0:21:58,986
我们正在检查返回的授权

543
00:21:59,456 --> 0:22:01,666
我们将检查授权的凭证

544
00:21:59,456 --> 0:22:01,666
我们将检查授权的凭证

545
00:22:01,666 --> 0:22:06,096
然后 在它是 appleIdCredential 的情况下

546
00:22:06,096 --> 0:22:07,536
我们将为凭证的

547
00:22:07,536 --> 0:22:09,876
用户属性设置一个

548
00:22:09,876 --> 0:22:10,526
常量用户标识符

549
00:22:11,676 --> 0:22:13,726
出于演示目的 我们将

550
00:22:14,306 --> 0:22:15,696
用户标识符保存在钥匙串中

551
00:22:15,696 --> 0:22:17,156
以便我们之后后使用它

552
00:22:17,816 --> 0:22:19,496
我还将使用 

553
00:22:19,496 --> 0:22:22,436
ResultViewController 

554
00:22:22,556 --> 0:22:23,646
它将继续负责

555
00:22:23,646 --> 0:22:26,706
一些处理 appleIdCredential 

556
00:22:26,706 --> 0:22:27,646
属性的样板

557
00:22:35,046 --> 0:22:38,176
因此就在这之下 

558
00:22:38,176 --> 0:22:39,926
就在我们定义的下面

559
00:22:39,926 --> 0:22:41,426
我们有了 didCompleteWithError 函数

560
00:22:41,536 --> 0:22:43,546
在流程没有完成

561
00:22:43,546 --> 0:22:45,286
或者没有凭据的

562
00:22:45,286 --> 0:22:47,156
情况下会调用它

563
00:22:50,326 --> 0:22:51,576
最后 我们还有一个协议

564
00:22:51,576 --> 0:22:54,436
就是 ASAuthorizationController

565
00:22:54,476 --> 0:22:56,226
PresentationContextProviding

566
00:22:57,286 --> 0:22:58,326
这为控制器

567
00:22:58,556 --> 0:22:59,636
定义了一个函数

568
00:22:59,636 --> 0:23:00,136
presentationAnchor

569
00:22:59,636 --> 0:23:00,136
presentationAnchor

570
00:23:00,956 --> 0:23:03,096
这要求我们做的是

571
00:23:03,096 --> 0:23:04,646
返回我们希望 

572
00:23:04,686 --> 0:23:08,246
Authentication Services 显示 UI 的窗口

573
00:23:09,096 --> 0:23:10,976
所以让我们运行 App 

574
00:23:17,046 --> 0:23:21,856
轻点按钮并分享邮件

575
00:23:26,256 --> 0:23:27,806
只需轻点一下即可进行身份验证

576
00:23:32,046 --> 0:23:33,176
所以这里的信号

577
00:23:33,176 --> 0:23:34,406
似乎有一些问题

578
00:23:34,406 --> 0:23:35,686
但我有一个备份视频

579
00:23:35,686 --> 0:23:37,326
可以告诉你们应该发生什么

580
00:23:45,046 --> 0:23:50,006
我们正在这 我们正在共享邮件

581
00:23:50,006 --> 0:23:52,136
然后 ResultViewController 

582
00:23:52,136 --> 0:23:55,116
会在那里显示结果

583
00:23:55,286 --> 0:23:56,546
正如你们所看到的 

584
00:23:56,546 --> 0:23:58,466
我们有一个用户标识符

585
00:23:58,466 --> 0:23:59,436
全名和邮件地址

586
00:24:02,516 --> 0:24:08,976
[掌声]

587
00:24:09,476 --> 0:24:11,976
好的 实际上看起来这起作用了

588
00:24:19,046 --> 0:24:19,976
好了 我们成功了

589
00:24:20,516 --> 0:24:27,686
[掌声]

590
00:24:28,186 --> 0:24:30,186
好的 让我们回到我们的主题

591
00:24:30,676 --> 0:24:32,606
最后我们来总结一下 我们在 UI 中

592
00:24:32,606 --> 0:24:33,766
添加了一个 Sign in with Apple 按钮

593
00:24:34,306 --> 0:24:36,266
我们定义了此按钮的操作

594
00:24:36,606 --> 0:24:38,516
以及返回结果的

595
00:24:38,516 --> 0:24:39,716
身份验证服务协议

596
00:24:39,716 --> 0:24:41,576
所需的功能

597
00:24:41,576 --> 0:24:43,546
并指定了 UI 的显示位置

598
00:24:46,046 --> 0:24:46,926
现在我们已经通过

599
00:24:46,926 --> 0:24:48,706
使用 Sign in with Apple 按钮

600
00:24:48,706 --> 0:24:50,246
来创建账户

601
00:24:50,246 --> 0:24:51,976
让我们致力于使我们的用户快速登录

602
00:24:52,496 --> 0:24:54,306
为此 我们将定义一个函数

603
00:24:54,306 --> 0:24:55,766
该函数将在用户

604
00:24:55,816 --> 0:24:57,566
拥有现有凭据的

605
00:24:57,566 --> 0:24:58,866
情况下向用户显示 UI

606
00:24:59,766 --> 0:25:01,716
因此 这可以是 Apple ID 

607
00:24:59,766 --> 0:25:01,716
因此 这可以是 Apple ID 

608
00:25:01,986 --> 0:25:03,456
或使用 App 授权域的

609
00:25:03,786 --> 0:25:05,776
iCloud 钥匙串密码

610
00:25:14,406 --> 0:25:16,296
所以我在这里定义了 

611
00:25:16,366 --> 0:25:19,766
performExistingAccountSetupFlows 函数

612
00:25:19,766 --> 0:25:22,136
所以这里我们有一个数组

613
00:25:22,136 --> 0:25:23,806
其中包含 Apple ID 请求和

614
00:25:23,806 --> 0:25:27,876
使用相应提供程序的密码请求

615
00:25:28,416 --> 0:25:30,746
然后 我们使用这些

616
00:25:30,746 --> 0:25:32,776
请求初始化授权控制器

617
00:25:32,776 --> 0:25:34,676
像之前一样

618
00:25:34,846 --> 0:25:35,086
设置代理

619
00:25:35,086 --> 0:25:37,406
和 presentationContextProvider

620
00:25:37,406 --> 0:25:39,576
然后调用 performRequest

621
00:25:40,696 --> 0:25:42,096
因此 我们向控制器

622
00:25:42,096 --> 0:25:43,556
添加了另一种类型的

623
00:25:43,556 --> 0:25:44,796
凭据请求

624
00:25:44,846 --> 0:25:45,686
即密码请求

625
00:25:46,596 --> 0:25:48,096
我们希望在我们的代理中

626
00:25:48,096 --> 0:25:49,786
处理这种类型的结果

627
00:25:49,786 --> 0:25:50,846
所以让我们继续做下去

628
00:26:01,296 --> 0:26:02,966
那么我们为 ASPasswordCredential 

629
00:26:02,966 --> 0:26:04,256
设置了一个 case

630
00:26:04,886 --> 0:26:07,326
因此 在这种情况下

631
00:26:07,326 --> 0:26:10,196
ASPasswordCredential 具有

632
00:26:10,196 --> 0:26:11,386
一个用户属性和一个密码属性

633
00:26:12,216 --> 0:26:13,166
在这种情况下

634
00:26:13,166 --> 0:26:14,576
当它返回给你们时 

635
00:26:14,576 --> 0:26:15,636
你们将需要继续对

636
00:26:15,636 --> 0:26:16,906
服务器进行身份验证

637
00:26:16,906 --> 0:26:17,976
甚至不需要向你们的用户

638
00:26:17,976 --> 0:26:19,076
显示任何 UI

639
00:26:19,626 --> 0:26:22,116
那么还有最后一步

640
00:26:22,116 --> 0:26:23,446
实际就是要调用 

641
00:26:23,446 --> 0:26:25,676
performExistingAccountSetup Flows 函数

642
00:26:28,216 --> 0:26:29,466
回到我们的类上

643
00:26:33,326 --> 0:26:35,736
我将重写 viewDidAppear 以调用

644
00:26:35,736 --> 0:26:37,976
performExistingAccountSetupFlows

645
00:26:44,216 --> 0:26:45,746
让我们运行 App

646
00:26:55,116 --> 0:26:56,916
正如你们所看到的 

647
00:26:56,916 --> 0:26:58,336
当我们显示 loginViewController 时

648
00:26:58,336 --> 0:27:00,396
将向你们的用户

649
00:26:58,336 --> 0:27:00,396
将向你们的用户

650
00:27:00,396 --> 0:27:01,686
显示现有凭据

651
00:27:02,896 --> 0:27:04,096
这是我们的 QuickSigninFlow

652
00:27:04,946 --> 0:27:06,346
所以我们刚刚实现了 

653
00:27:06,346 --> 0:27:08,186
QuickSigninFlow 让我们

654
00:27:08,186 --> 0:27:09,626
继续讨论我们的最后一个主题

655
00:27:09,686 --> 0:27:10,816
即检查 AppleID 

656
00:27:10,816 --> 0:27:12,486
用户标识符的凭据状态

657
00:27:16,046 --> 0:27:17,116
在今天演示的早些时候 

658
00:27:17,116 --> 0:27:18,176
我们在创建账户时

659
00:27:18,176 --> 0:27:19,976
已将用户标识符保存到钥匙串中

660
00:27:20,806 --> 0:27:22,666
使用此标识符

661
00:27:22,666 --> 0:27:23,956
我们可以检查登录状态

662
00:27:24,236 --> 0:27:25,386
以确保我们的用户

663
00:27:25,386 --> 0:27:26,396
经过适当的身份验证

664
00:27:26,876 --> 0:27:28,396
我们将在 AppDelegate 类中执行此操作

665
00:27:28,936 --> 0:27:31,386
然后我转到 AppDelegate 类

666
00:27:35,186 --> 0:27:36,946
我要删除它

667
00:27:47,136 --> 0:27:49,066
首先 我们要检查

668
00:27:49,066 --> 0:27:50,636
钥匙串中是否有

669
00:27:50,636 --> 0:27:51,886
用户标识符

670
00:27:52,116 --> 0:27:53,946
如果是这样 我们将初始化

671
00:27:53,946 --> 0:27:55,916
ASAuthorizationAppleIDProvider

672
00:27:55,966 --> 0:27:57,056
然后使用 AppleIDProvider

673
00:27:57,056 --> 0:27:58,916
我们将调用凭证

674
00:27:58,916 --> 0:28:01,246
传递用户标识符的状态

675
00:27:58,916 --> 0:28:01,246
传递用户标识符的状态

676
00:28:04,046 --> 0:28:06,186
所以我们会得到三种不同的 三种不同

677
00:28:06,186 --> 0:28:07,206
类型的案例

678
00:28:07,806 --> 0:28:09,976
一个是授权的

679
00:28:09,976 --> 0:28:11,476
在这种情况下 你们可以

680
00:28:11,596 --> 0:28:12,756
假设用户已通过

681
00:28:12,756 --> 0:28:15,216
正确的身份验证

682
00:28:15,216 --> 0:28:17,106
你们可以继续正常的 App 操作

683
00:28:17,986 --> 0:28:18,786
在它被撤销的情况下

684
00:28:18,786 --> 0:28:20,286
你们需要调用你们

685
00:28:20,286 --> 0:28:22,716
现有的注销逻辑

686
00:28:22,716 --> 0:28:24,306
然后你可以通过 notFound 

687
00:28:24,336 --> 0:28:25,736
这个 case 来显示

688
00:28:25,736 --> 0:28:26,796
LoginViewController

689
00:28:26,886 --> 0:28:29,716
所以我要继续运行 App

690
00:28:43,076 --> 0:28:44,336
正如你们所看到的

691
00:28:44,336 --> 0:28:45,606
用户标识符显示在

692
00:28:45,606 --> 0:28:47,906
ResultViewController 中

693
00:28:47,906 --> 0:28:49,516
因为在这种情况下

694
00:28:49,516 --> 0:28:50,056
用户已经被授权

695
00:28:50,556 --> 0:28:51,866
ResultViewController 

696
00:28:51,866 --> 0:28:53,886
是故事板中的

697
00:28:53,886 --> 0:28:54,386
初始视图控制器

698
00:28:54,656 --> 0:28:58,846
这就是我要说的了 很简单吧

699
00:28:59,516 --> 0:29:03,796
[掌声]

700
00:28:59,516 --> 0:29:03,796
[掌声]

701
00:29:04,296 --> 0:29:05,276
那么我刚刚向你们

702
00:29:05,276 --> 0:29:06,466
展示了如何在登录表单中

703
00:29:06,466 --> 0:29:08,146
添加 Sign in with Apple 按钮

704
00:29:08,146 --> 0:29:09,576
如何实现 QuickSigninFlow 

705
00:29:09,806 --> 0:29:10,896
以使用现有凭证

706
00:29:10,896 --> 0:29:12,626
登录用户

707
00:29:12,946 --> 0:29:13,986
以及如何使用用户标识符

708
00:29:13,986 --> 0:29:16,246
检查凭证状态确保

709
00:29:16,416 --> 0:29:17,456
用户通过你们的 App 

710
00:29:17,506 --> 0:29:18,786
进行身份验证

711
00:29:19,126 --> 0:29:20,316
有了这个 我要把会议

712
00:29:20,316 --> 0:29:21,506
交还给 Gokul 他将涵盖

713
00:29:21,506 --> 0:29:23,536
多平台的主题 Gokul

714
00:29:24,516 --> 0:29:29,666
[掌声]

715
00:29:30,166 --> 0:29:31,356
&gt;&gt; 谢谢你 Jonathan

716
00:29:31,356 --> 0:29:33,006
我们刚刚看到 Jonathan

717
00:29:33,006 --> 0:29:36,576
从一个测试 App 开始

718
00:29:36,576 --> 0:29:38,046
添加一个按钮 

719
00:29:38,106 --> 0:29:39,276
解决请求和响应

720
00:29:39,276 --> 0:29:40,036
最后处理现有账户

721
00:29:40,716 --> 0:29:43,216
一切易于实施

722
00:29:43,276 --> 0:29:44,986
为用户提供了极好的体验

723
00:29:45,146 --> 0:29:46,346
那其实是一个非常快速的演示

724
00:29:47,296 --> 0:29:48,796
现在让我们来谈谈跨平台

725
00:29:49,386 --> 0:29:51,466
跨平台很重要

726
00:29:51,606 --> 0:29:54,606
它通过一个简单的

727
00:29:54,726 --> 0:29:56,386
JavaScript 库启用

728
00:29:57,236 --> 0:29:59,216
使用此库 你们可以

729
00:29:59,216 --> 0:30:01,046
让用户在任何平台

730
00:29:59,216 --> 0:30:01,046
让用户在任何平台

731
00:30:01,446 --> 0:30:03,656
（如 Windows 或 Android）

732
00:30:03,826 --> 0:30:05,256
上 Sign in with Apple

733
00:30:05,846 --> 0:30:10,036
轻点熟悉的 Sign in with Apple 按钮将

734
00:30:10,036 --> 0:30:12,686
重定向到 Apple

735
00:30:12,686 --> 0:30:16,066
用户可以在其中输入 Apple ID 并登录

736
00:30:17,036 --> 0:30:19,436
登录后 它会重定向回来

737
00:30:21,366 --> 0:30:23,206
你们收到的调用和

738
00:30:23,206 --> 0:30:26,166
信息都与本机 API 非常相似

739
00:30:26,946 --> 0:30:29,426
如果你们提出要求 

740
00:30:29,426 --> 0:30:30,816
你们将获得 ID 令牌

741
00:30:30,816 --> 0:30:31,236
甚至姓名或邮件

742
00:30:32,356 --> 0:30:33,746
一旦你们获得 ID 和令牌 

743
00:30:33,746 --> 0:30:36,526
你们就可以将其

744
00:30:36,926 --> 0:30:41,086
转换为 App 中的 App 会话

745
00:30:42,036 --> 0:30:45,236
最重要的是 

746
00:30:45,236 --> 0:30:47,326
对 Safari 的支持是内置于 Safari 中的

747
00:30:48,876 --> 0:30:51,736
因此 当你们的用户轻点该按钮时

748
00:30:51,736 --> 0:30:54,966
Safari 将显示一个类似

749
00:30:54,966 --> 0:30:56,866
本地 Apple Pay 的工作表

750
00:30:57,716 --> 0:31:00,606
你们的用户可以

751
00:30:57,716 --> 0:31:00,606
你们的用户可以

752
00:31:00,606 --> 0:31:02,306
简单地使用触控 ID 他们可以

753
00:31:02,306 --> 0:31:04,466
立即登录并快速使用你的网站

754
00:31:04,466 --> 0:31:06,116
这是一次非常棒的体验

755
00:31:06,536 --> 0:31:08,066
所以它内置于 Safari 中

756
00:31:09,976 --> 0:31:11,366
与 JavaScript 库集成

757
00:31:11,596 --> 0:31:13,976
只需四个简单的步骤

758
00:31:17,056 --> 0:31:19,186
首先 在 HTML 中

759
00:31:19,186 --> 0:31:21,916
包含 JavaScript 库

760
00:31:21,966 --> 0:31:26,146
如图所示 一个简单的 div 渲染按钮

761
00:31:27,076 --> 0:31:28,506
你们可以使用许多参数设置样式

762
00:31:28,506 --> 0:31:30,556
以自定义适合

763
00:31:30,556 --> 0:31:32,446
你们网站的内容

764
00:31:33,176 --> 0:31:34,946
使用一些参数配置它

765
00:31:35,096 --> 0:31:36,526
例如你们是否需要名称

766
00:31:36,526 --> 0:31:39,946
邮件和重定向 redirectURI

767
00:31:42,046 --> 0:31:43,546
最后 当用户

768
00:31:43,546 --> 0:31:45,516
完成登录时

769
00:31:45,626 --> 0:31:47,896
结果将使用表单编码值

770
00:31:47,896 --> 0:31:50,346
发回到重定向 redirectURI

771
00:31:51,346 --> 0:31:53,556
你们验证令牌 身份验证代码

772
00:31:53,556 --> 0:31:56,376
并将其转换为 App 会话

773
00:31:56,746 --> 0:31:59,466
并且你们可以决定希望 会话存在多长时间

774
00:31:59,556 --> 0:32:02,826
这样就快速了解了

775
00:31:59,556 --> 0:32:02,826
这样就快速了解了

776
00:32:02,826 --> 0:32:04,706
JavaScript 库的

777
00:32:04,706 --> 0:32:05,946
跨平台支持

778
00:32:08,046 --> 0:32:09,346
最后 让我们通过一些

779
00:32:09,346 --> 0:32:11,346
最佳实践来看看

780
00:32:11,816 --> 0:32:13,926
与 Sign in with Apple 集成的实例

781
00:32:16,146 --> 0:32:17,676
以下是一些一般性

782
00:32:17,676 --> 0:32:18,296
指导原则

783
00:32:18,986 --> 0:32:20,166
如 App Store 指南中所述

784
00:32:20,166 --> 0:32:22,286
除非你们的 App 

785
00:32:22,286 --> 0:32:23,796
需要重要的

786
00:32:23,866 --> 0:32:25,846
基于账户的功能 否则就让人们

787
00:32:25,846 --> 0:32:27,596
无需登录即可使用它

788
00:32:28,076 --> 0:32:30,186
例如 你们可以指导

789
00:32:30,186 --> 0:32:32,326
用户在购买后 Sign in with Apple

790
00:32:32,326 --> 0:32:33,916
这样你们就

791
00:32:34,336 --> 0:32:36,396
可以将购买与

792
00:32:36,396 --> 0:32:38,606
他们可以轻松

793
00:32:39,126 --> 0:32:40,536
返回的账户绑定

794
00:32:40,536 --> 0:32:41,866
如果你们只需要唯一标识符

795
00:32:41,866 --> 0:32:43,746
来标识用户 

796
00:32:44,316 --> 0:32:45,716
请不要收集姓名或邮件

797
00:32:46,756 --> 0:32:47,476
你不需要它

798
00:32:48,356 --> 0:32:49,606
如果你们通过登录 Apple 

799
00:32:50,816 --> 0:32:52,366
收集邮件 

800
00:32:52,366 --> 0:32:54,916
请确保你们尊重用户的选择

801
00:32:57,156 --> 0:32:58,166
以下是与 API 集成时

802
00:32:58,166 --> 0:32:59,836
要记住的一些

803
00:32:59,956 --> 0:33:01,366
其他最佳实践

804
00:32:59,956 --> 0:33:01,366
其他最佳实践

805
00:33:02,646 --> 0:33:04,606
首次启动 App 时

806
00:33:05,096 --> 0:33:07,026
请使用 API

807
00:33:07,026 --> 0:33:08,146
检查现有账户

808
00:33:08,806 --> 0:33:10,826
这样 用户可以

809
00:33:10,826 --> 0:33:11,926
快速使用他们

810
00:33:11,926 --> 0:33:13,776
已经拥有的 App 账户

811
00:33:14,306 --> 0:33:15,706
无论是 iCloud 钥匙串密码

812
00:33:16,196 --> 0:33:18,456
还是现有的 Apple 账户

813
00:33:19,086 --> 0:33:20,406
并且你们的 App 中

814
00:33:20,406 --> 0:33:21,376
没有任何重复的账户

815
00:33:22,866 --> 0:33:24,896
计划为返回

816
00:33:24,926 --> 0:33:27,966
真实用户标识符的用户

817
00:33:28,186 --> 0:33:29,196
提供最佳体验

818
00:33:29,406 --> 0:33:32,096
如果它返回未知

819
00:33:32,096 --> 0:33:33,446
请像对待系统中的

820
00:33:33,446 --> 0:33:34,376
任何新账户一样对待它们

821
00:33:34,966 --> 0:33:38,746
使用 Button API 来绘制按钮

822
00:33:40,376 --> 0:33:41,586
当你们使用 API​ ​

823
00:33:41,696 --> 0:33:43,866
绘制按钮时 将其连接到

824
00:33:43,896 --> 0:33:46,026
代码中的 Apple ID 提供程序

825
00:33:47,466 --> 0:33:51,156
最后 一旦用户 Sign in with Apple

826
00:33:51,156 --> 0:33:52,916
他们就会期望

827
00:33:52,916 --> 0:33:55,516
在你们的 App 所在的

828
00:33:55,516 --> 0:33:56,186
所有平台上看到它

829
00:33:56,576 --> 0:33:58,916
所以在所有平台上实现它

830
00:34:00,166 --> 0:34:03,226
以上是最佳实践

831
00:34:03,496 --> 0:34:05,586
总而言之 Sign in with Apple

832
00:34:05,806 --> 0:34:07,906
可以快速轻松地设置

833
00:34:07,906 --> 0:34:09,896
账户并登录你们的 App

834
00:34:10,286 --> 0:34:12,356
简化的一键账户设置

835
00:34:12,356 --> 0:34:14,516
没有繁琐的表单

836
00:34:15,126 --> 0:34:16,735
已验证的邮件地址

837
00:34:16,735 --> 0:34:18,255
即时可用 而且你们可以

838
00:34:18,255 --> 0:34:19,505
用于任何通信

839
00:34:20,606 --> 0:34:24,235
内置安全性没有新密码

840
00:34:24,235 --> 0:34:25,886
每个账户双重认证

841
00:34:26,886 --> 0:34:28,536
真实用户指示器

842
00:34:28,536 --> 0:34:29,666
帮助你们打击账户欺诈

843
00:34:29,666 --> 0:34:32,525
跨平台支持 

844
00:34:32,525 --> 0:34:34,646
这样你们的用户

845
00:34:34,646 --> 0:34:36,606
就可以在你们的 App 所在的

846
00:34:36,656 --> 0:34:37,646
每个平台上 Sign in with Apple

847
00:34:39,036 --> 0:34:41,466
请于 10:00 加入我们的实验室

848
00:34:41,466 --> 0:34:43,085
我们很乐意在那

849
00:34:43,085 --> 0:34:44,386
回答你们的任何问题

850
00:34:45,065 --> 0:34:46,156
身份验证服务

851
00:34:46,156 --> 0:34:47,126
框架中还有更多内容

852
00:34:47,126 --> 0:34:49,136
可帮助你们协助

853
00:34:49,136 --> 0:34:51,136
用户登录和

854
00:34:51,136 --> 0:34:52,286
处理密码

855
00:34:52,766 --> 0:34:53,775
请参加明天的

856
00:34:53,775 --> 0:34:55,315
《What's New in Authentication》会议

857
00:34:55,616 --> 0:34:56,196
来了解更多

858
00:34:56,815 --> 0:34:58,416
并且 Sign in with Apple 

859
00:34:58,536 --> 0:35:00,406
可在独立的 Watch App 很好地运行

860
00:34:58,536 --> 0:35:00,406
可在独立的 Watch App 很好地运行

861
00:35:00,776 --> 0:35:02,166
请收听 WWDC App 上的

862
00:35:02,166 --> 0:35:04,646
《Creating Independent Watch Apps》

863
00:35:04,646 --> 0:35:06,966
以了解更多信息 就是这样

864
00:35:07,066 --> 0:35:07,926
感谢你们加入我们的会话

865
00:35:07,926 --> 0:35:09,866
希望你们享受了一次很棒的会议 谢谢大家

866
00:35:10,016 --> 0:35:12,000
[掌声]
