1
00:00:01,516 --> 0:00:05,500
[ Music ]

2
00:00:10,516 --> 0:00:17,856
[ Applause ]

3
00:00:18,356 --> 0:00:20,496
&gt;&gt; Hi. I'm Danny Mandel.

4
00:00:20,496 --> 0:00:22,166
And welcome to Introducing

5
00:00:22,216 --> 0:00:23,386
SiriKit Media Intents.

6
00:00:24,366 --> 0:00:25,946
We've added media domain support

7
00:00:25,946 --> 0:00:27,806
to SiriKit for audio use cases

8
00:00:27,976 --> 0:00:29,986
and we're super excited to tell

9
00:00:29,986 --> 0:00:32,366
you all about it.

10
00:00:33,196 --> 0:00:34,096
So what are we going to cover in

11
00:00:34,096 --> 0:00:34,556
this session?

12
00:00:35,316 --> 0:00:36,836
The first thing we'll do is

13
00:00:36,836 --> 0:00:38,816
introduce the new SiriKit Media

14
00:00:38,816 --> 0:00:40,456
Intents and talk about their

15
00:00:40,456 --> 0:00:41,026
capabilities.

16
00:00:42,346 --> 0:00:43,796
Then we'll talk about what's

17
00:00:43,796 --> 0:00:45,286
required for you to handle

18
00:00:45,356 --> 0:00:46,616
SiriKit Media requests on your

19
00:00:47,306 --> 0:00:47,376
app.

20
00:00:47,946 --> 0:00:49,496
And finally, we'll talk about

21
00:00:49,496 --> 0:00:50,726
some best practices you're going

22
00:00:50,726 --> 0:00:52,466
to want to follow to provide the

23
00:00:52,466 --> 0:00:54,126
best user experience possible

24
00:00:54,446 --> 0:00:55,646
when you add SiriKit Media

25
00:00:55,646 --> 0:00:57,326
Support to your app.

26
00:00:58,216 --> 0:01:01,386
This year, we're allowing you to

27
00:00:58,216 --> 0:01:01,386
This year, we're allowing you to

28
00:01:01,386 --> 0:01:03,966
control audio in a whole new way

29
00:01:04,066 --> 0:01:05,536
with SiriKit Media Intents.

30
00:01:06,046 --> 0:01:07,276
And we think people are going to

31
00:01:07,276 --> 0:01:08,856
love using the Siri Media

32
00:01:08,856 --> 0:01:10,226
capabilities you build into your

33
00:01:10,416 --> 0:01:10,626
apps.

34
00:01:11,436 --> 0:01:12,796
With SiriKit Media Intents,

35
00:01:13,166 --> 0:01:14,506
people will be able to do things

36
00:01:14,506 --> 0:01:17,226
like play audio, update taste

37
00:01:17,226 --> 0:01:19,216
profiles, add to collections,

38
00:01:19,676 --> 0:01:20,236
and search.

39
00:01:21,226 --> 0:01:22,276
This means that they'll be able

40
00:01:22,276 --> 0:01:24,366
to use the rich natural language

41
00:01:24,366 --> 0:01:26,136
processing capabilities of Siri

42
00:01:26,936 --> 0:01:28,996
to say things like "Play Khalid

43
00:01:28,996 --> 0:01:31,386
on my app," to immediately begin

44
00:01:31,716 --> 0:01:35,286
playing Khalid in your app.

45
00:01:36,676 --> 0:01:37,946
Let's take a look at the new

46
00:01:38,036 --> 0:01:39,746
SiriKit Media Intents and their

47
00:01:39,746 --> 0:01:40,436
capabilities.

48
00:01:42,056 --> 0:01:44,486
There are four SiriKit Media

49
00:01:44,486 --> 0:01:44,876
Intents.

50
00:01:45,806 --> 0:01:46,816
The first intent is

51
00:01:46,876 --> 0:01:48,006
INPlayMediaIntent.

52
00:01:49,106 --> 0:01:51,056
INPlayMediaIntent allows people

53
00:01:51,056 --> 0:01:52,516
to play audio by saying

54
00:01:52,566 --> 0:01:54,676
something like "Play Outer Peace

55
00:01:54,676 --> 0:01:55,746
in my app."

56
00:01:56,046 --> 0:01:58,346
Now, you might remember that we

57
00:01:58,346 --> 0:01:59,816
launched Media Playback Support

58
00:01:59,816 --> 0:02:01,746
in IOS 12 with Shortcuts.

59
00:01:59,816 --> 0:02:01,746
in IOS 12 with Shortcuts.

60
00:02:02,256 --> 0:02:03,696
And this year, we're adding

61
00:02:03,696 --> 0:02:04,826
SiriKit features to

62
00:02:04,966 --> 0:02:07,206
INPlayMediaIntent.

63
00:02:07,796 --> 0:02:09,765
The next intent is

64
00:02:09,866 --> 0:02:10,946
INAddMediaIntent.

65
00:02:11,846 --> 0:02:14,046
INAddMediaIntent allows people

66
00:02:14,536 --> 0:02:16,146
to add items to their playlists

67
00:02:16,186 --> 0:02:16,926
and libraries.

68
00:02:17,626 --> 0:02:20,376
An example of this could be "add

69
00:02:20,406 --> 0:02:21,676
this song to my road trip

70
00:02:21,676 --> 0:02:24,486
playlist in my app."

71
00:02:25,096 --> 0:02:25,526
We have

72
00:02:25,526 --> 0:02:27,636
INUpdateMediaAffinityIntent,

73
00:02:27,756 --> 0:02:29,096
which allows people to express

74
00:02:29,096 --> 0:02:30,456
affinity for media items.

75
00:02:31,556 --> 0:02:32,746
People can say this by saying

76
00:02:32,746 --> 0:02:34,456
something as simple as "I like

77
00:02:34,456 --> 0:02:34,916
this song."

78
00:02:35,046 --> 0:02:38,186
And finally, we have

79
00:02:38,326 --> 0:02:40,416
INSearchForMediaIntent, which

80
00:02:40,416 --> 0:02:41,746
lets people search your app for

81
00:02:41,746 --> 0:02:43,156
a particular media item.

82
00:02:43,586 --> 0:02:46,156
For example, "Find Billie Eilish

83
00:02:46,156 --> 0:02:48,886
in my app."

84
00:02:50,126 --> 0:02:51,076
Let's talk about the supported

85
00:02:51,076 --> 0:02:52,496
media types in SiriKit Media.

86
00:02:53,366 --> 0:02:54,906
SiriKit Media supports a number

87
00:02:54,906 --> 0:02:56,206
of different audio types, with

88
00:02:56,206 --> 0:02:57,276
the first one being music.

89
00:02:58,036 --> 0:03:00,066
And music support is going to

90
00:02:58,036 --> 0:03:00,066
And music support is going to

91
00:03:00,066 --> 0:03:01,636
let you say things like "Play

92
00:03:01,636 --> 0:03:03,246
the song Awesome Song in my

93
00:03:03,246 --> 0:03:03,486
app."

94
00:03:04,766 --> 0:03:06,296
In addition to songs, we have

95
00:03:06,296 --> 0:03:07,696
support for albums, artists,

96
00:03:07,966 --> 0:03:09,756
playlists, genres, and many

97
00:03:09,756 --> 0:03:09,956
more.

98
00:03:09,956 --> 0:03:11,926
So you're going to want to check

99
00:03:11,926 --> 0:03:13,236
out the documentation for

100
00:03:13,236 --> 0:03:14,956
INMediaSearch to get the full

101
00:03:14,956 --> 0:03:16,386
list of supported search terms.

102
00:03:16,826 --> 0:03:18,506
And we want you to adopt as many

103
00:03:18,506 --> 0:03:20,386
of them as possible to provide

104
00:03:20,386 --> 0:03:22,286
the best Siri user experience in

105
00:03:22,286 --> 0:03:23,256
your app.

106
00:03:23,706 --> 0:03:24,976
Additionally, we have playback

107
00:03:24,976 --> 0:03:27,406
controls, like shuffle, repeat,

108
00:03:27,516 --> 0:03:28,256
and playback queues.

109
00:03:28,506 --> 0:03:30,566
And this lets people say things

110
00:03:30,566 --> 0:03:32,246
like "Play Khalid shuffle in my

111
00:03:32,246 --> 0:03:34,926
app," or, "Play Outer Peace next

112
00:03:35,196 --> 0:03:35,646
in my app."

113
00:03:38,916 --> 0:03:40,386
The next supported audio type is

114
00:03:40,446 --> 0:03:40,916
Podcasts.

115
00:03:41,866 --> 0:03:42,826
People can begin playing

116
00:03:42,826 --> 0:03:44,026
podcasts by saying something

117
00:03:44,026 --> 0:03:45,416
like "Put on the Stuff You

118
00:03:45,416 --> 0:03:46,806
Should Know podcast for my app."

119
00:03:47,956 --> 0:03:49,626
Additionally, people can also

120
00:03:49,626 --> 0:03:51,076
control the playback order and

121
00:03:51,076 --> 0:03:53,106
speeds of podcast episodes.

122
00:03:53,996 --> 0:03:55,266
This lets people say something

123
00:03:55,266 --> 0:03:56,916
like "Play the newest episode of

124
00:03:56,916 --> 0:03:58,246
Stuff You Should Know podcast in

125
00:03:58,246 --> 0:04:00,286
my app," or, "Play the Stuff You

126
00:03:58,246 --> 0:04:00,286
my app," or, "Play the Stuff You

127
00:04:00,286 --> 0:04:01,836
Should Know podcast in my app at

128
00:04:01,836 --> 0:04:02,456
double speed."

129
00:04:05,686 --> 0:04:07,046
Moving on, we have audiobook

130
00:04:07,046 --> 0:04:07,546
support.

131
00:04:08,336 --> 0:04:09,846
This lets people say things like

132
00:04:10,256 --> 0:04:11,646
"Play the audiobook Becoming in

133
00:04:11,646 --> 0:04:11,986
my app."

134
00:04:12,426 --> 0:04:14,536
And like Podcasts, people can

135
00:04:14,536 --> 0:04:16,005
begin to playback at a specific

136
00:04:16,005 --> 0:04:17,065
speed when asking to play

137
00:04:17,065 --> 0:04:17,516
audiobooks.

138
00:04:18,276 --> 0:04:20,616
And finally, we have radio

139
00:04:20,616 --> 0:04:20,966
support.

140
00:04:21,875 --> 0:04:23,536
Radio support allows people to

141
00:04:23,536 --> 0:04:25,346
ask for a specific radio station

142
00:04:25,346 --> 0:04:26,556
in your Radio Playback app.

143
00:04:27,206 --> 0:04:29,796
For example, "Play 89.1 FM in my

144
00:04:29,796 --> 0:04:29,956
app."

145
00:04:32,586 --> 0:04:33,956
And don't worry if your app

146
00:04:33,956 --> 0:04:35,006
doesn't fall into one of the

147
00:04:35,006 --> 0:04:36,586
previous media types, you can

148
00:04:36,586 --> 0:04:37,996
still adopt the SiriKit Media

149
00:04:37,996 --> 0:04:39,826
Intent and get the full power.

150
00:04:40,926 --> 0:04:41,706
People will be able to say

151
00:04:41,706 --> 0:04:43,456
things like "Play search term in

152
00:04:43,456 --> 0:04:44,886
my app," and you'll be able to

153
00:04:44,886 --> 0:04:45,986
look up search term in your app

154
00:04:45,986 --> 0:04:46,636
and play it.

155
00:04:46,926 --> 0:04:48,796
The only thing that will be

156
00:04:48,796 --> 0:04:49,986
missing will be support for

157
00:04:49,986 --> 0:04:51,216
strongly parsed media types.

158
00:04:51,746 --> 0:04:52,976
So say you had a nature sounds

159
00:04:52,976 --> 0:04:55,356
app and you said "Play reptile

160
00:04:55,356 --> 0:04:57,296
sounds in my app," or, "Play

161
00:04:57,296 --> 0:04:59,426
mammal sounds in my app," Siri

162
00:04:59,426 --> 0:05:00,326
is not going to know that those

163
00:04:59,426 --> 0:05:00,326
is not going to know that those

164
00:05:00,326 --> 0:05:01,196
are two different types of

165
00:05:01,196 --> 0:05:01,796
animal sounds.

166
00:05:02,116 --> 0:05:04,306
So you'd get a string of mammal

167
00:05:04,306 --> 0:05:07,716
sounds or reptile sounds, and

168
00:05:07,976 --> 0:05:09,066
you could look it up and play

169
00:05:09,066 --> 0:05:09,166
it.

170
00:05:09,306 --> 0:05:10,856
So not quite as structured as

171
00:05:10,856 --> 0:05:12,396
the other types but still

172
00:05:14,766 --> 0:05:15,026
supported.

173
00:05:16,536 --> 0:05:17,456
Let's look at how we handle

174
00:05:17,456 --> 0:05:19,106
these intents in SiriKit.

175
00:05:21,276 --> 0:05:23,666
So the first thing to know about

176
00:05:24,076 --> 0:05:25,336
how to request with SiriKit

177
00:05:25,336 --> 0:05:26,936
Media is that SiriKit Media

178
00:05:26,936 --> 0:05:28,436
Intents are just like any other

179
00:05:28,436 --> 0:05:29,156
SiriKit domain.

180
00:05:30,196 --> 0:05:31,486
So all the intent-handling

181
00:05:31,806 --> 0:05:32,906
happens in your Intents app

182
00:05:32,906 --> 0:05:35,136
extension, where you conform to

183
00:05:35,136 --> 0:05:36,266
the SiriKit Media Intent

184
00:05:36,266 --> 0:05:36,966
handling protocols.

185
00:05:37,516 --> 0:05:39,626
The details of SiriKit request

186
00:05:39,626 --> 0:05:40,516
handling have been covered

187
00:05:40,516 --> 0:05:42,326
really well in previous WWDC

188
00:05:42,326 --> 0:05:44,086
talks, so I'd refer you to those

189
00:05:44,156 --> 0:05:45,906
talks and to the developer

190
00:05:45,906 --> 0:05:47,616
documentation online for more

191
00:05:47,616 --> 0:05:49,596
general details about SiriKit

192
00:05:49,596 --> 0:05:50,276
Request Processing.

193
00:05:53,196 --> 0:05:54,846
Now let's look at what happens

194
00:05:54,846 --> 0:05:56,516
for a typical request in the

195
00:05:56,586 --> 0:05:57,546
SiriKit Media domain.

196
00:05:58,986 --> 0:06:00,236
The request processing begins

197
00:05:58,986 --> 0:06:00,236
The request processing begins

198
00:06:00,436 --> 0:06:01,886
when someone says "Play cool

199
00:06:01,886 --> 0:06:02,826
song in my app."

200
00:06:03,346 --> 0:06:04,726
And Siri is going to recognize

201
00:06:04,726 --> 0:06:05,796
that this is a request for your

202
00:06:05,796 --> 0:06:07,146
app, it's going to launch your

203
00:06:07,146 --> 0:06:07,906
Intents Extension.

204
00:06:08,806 --> 0:06:09,906
Now, there are three steps in

205
00:06:09,906 --> 0:06:11,116
SiriKit Request Processing:

206
00:06:11,926 --> 0:06:13,456
resolve, confirm, and handle.

207
00:06:13,706 --> 0:06:16,856
The first step in request

208
00:06:16,856 --> 0:06:18,206
processing is the resolve step.

209
00:06:18,726 --> 0:06:20,666
In the media domain, the resolve

210
00:06:20,666 --> 0:06:21,886
step is where we take the

211
00:06:21,886 --> 0:06:24,086
intents' INMediaSearch object

212
00:06:24,426 --> 0:06:26,306
and we run a search against our

213
00:06:26,306 --> 0:06:26,966
app catalog.

214
00:06:27,896 --> 0:06:29,406
The output of resolve is one or

215
00:06:29,406 --> 0:06:31,436
more concrete media item objects

216
00:06:31,436 --> 0:06:31,756
to play.

217
00:06:33,056 --> 0:06:34,696
Alternatively, if we didn't find

218
00:06:34,696 --> 0:06:36,526
anything that matched or another

219
00:06:36,526 --> 0:06:38,276
error occurred, we can return an

220
00:06:38,276 --> 0:06:39,986
unsupported result, which will

221
00:06:39,986 --> 0:06:41,346
tell Siri to display the

222
00:06:41,346 --> 0:06:44,776
appropriate error dialog.

223
00:06:45,276 --> 0:06:46,306
The next step in Request

224
00:06:46,306 --> 0:06:47,576
Processing is the confirm step.

225
00:06:48,706 --> 0:06:50,426
And typically, we discourage use

226
00:06:50,426 --> 0:06:51,646
of the confirm step in the Media

227
00:06:51,646 --> 0:06:51,926
domain.

228
00:06:52,826 --> 0:06:54,156
In looking at usage in our own

229
00:06:54,156 --> 0:06:56,516
apps, we find that using confirm

230
00:06:57,136 --> 0:06:58,526
actually lowers the likelihood

231
00:06:58,526 --> 0:06:59,866
that people will continue on to

232
00:06:59,896 --> 0:07:00,376
play media.

233
00:06:59,896 --> 0:07:00,376
play media.

234
00:07:00,876 --> 0:07:01,926
So we don't recommend using the

235
00:07:01,926 --> 0:07:03,156
confirm step in the Media

236
00:07:03,156 --> 0:07:03,456
domain.

237
00:07:04,076 --> 0:07:06,976
The final step in Request

238
00:07:06,976 --> 0:07:09,066
Processing is the handle step.

239
00:07:09,226 --> 0:07:11,716
Now, for INPlayMediaIntent, this

240
00:07:11,716 --> 0:07:12,776
ends up being really simple,

241
00:07:12,996 --> 0:07:13,996
because we're going to return

242
00:07:13,996 --> 0:07:15,766
the response code "handle an

243
00:07:15,946 --> 0:07:17,256
app," which is going to do a

244
00:07:17,256 --> 0:07:18,456
background app launch.

245
00:07:19,426 --> 0:07:23,076
And inside of our background app

246
00:07:23,076 --> 0:07:25,116
launch, we're just going to play

247
00:07:25,116 --> 0:07:26,846
media like we normally do in our

248
00:07:26,906 --> 0:07:26,973
app.

249
00:07:26,973 --> 0:07:29,106
The only tricky part here is

250
00:07:29,166 --> 0:07:29,446
testing.

251
00:07:29,446 --> 0:07:30,566
You're going to want to make

252
00:07:30,566 --> 0:07:31,676
sure everything plays because

253
00:07:31,676 --> 0:07:32,466
there's not going to be any UI

254
00:07:32,466 --> 0:07:33,146
on screen.

255
00:07:33,146 --> 0:07:34,106
You're also going to want to

256
00:07:34,106 --> 0:07:35,506
make sure that you test in a

257
00:07:35,506 --> 0:07:36,746
variety of situations.

258
00:07:37,086 --> 0:07:39,576
For example, in CarPlay or when

259
00:07:39,576 --> 0:07:40,336
you're wearing headphones.

260
00:07:40,726 --> 0:07:41,766
So now that we've seen an

261
00:07:41,766 --> 0:07:43,526
overview of SiriKit Request

262
00:07:43,526 --> 0:07:45,386
Processing, let's take a look at

263
00:07:45,386 --> 0:07:46,826
a simplified resolve media items

264
00:07:46,826 --> 0:07:47,106
method.

265
00:07:47,406 --> 0:07:48,986
And the first thing to note is

266
00:07:48,986 --> 0:07:50,366
that the parameters are going to

267
00:07:50,366 --> 0:07:52,166
be slightly different but the

268
00:07:52,216 --> 0:07:53,636
same resolve logic is going to

269
00:07:53,636 --> 0:07:55,286
be the same for all four media

270
00:07:55,286 --> 0:07:55,776
intents.

271
00:07:56,686 --> 0:07:58,406
Resolve's job is to search the

272
00:07:58,406 --> 0:07:59,086
app catalog.

273
00:07:59,086 --> 0:08:00,296
And you're going to want to do

274
00:07:59,086 --> 0:08:00,296
And you're going to want to do

275
00:08:00,296 --> 0:08:01,516
it the same way for all four

276
00:08:02,446 --> 0:08:02,676
intents.

277
00:08:03,616 --> 0:08:06,126
So we'll initialize a result to

278
00:08:06,126 --> 0:08:07,056
the unsupported result.

279
00:08:07,056 --> 0:08:08,676
And this is going to tell Siri

280
00:08:08,676 --> 0:08:09,726
to say the appropriate error

281
00:08:09,726 --> 0:08:11,566
dialogue if we don't find

282
00:08:11,566 --> 0:08:14,536
anything in our app catalog.

283
00:08:15,466 --> 0:08:16,976
INMediaSearch is the intent

284
00:08:16,976 --> 0:08:18,426
field that contains the details

285
00:08:18,426 --> 0:08:19,466
about what the user asks to

286
00:08:19,466 --> 0:08:19,666
play.

287
00:08:20,686 --> 0:08:22,166
INMediaSearch represents the

288
00:08:22,166 --> 0:08:23,216
universe of all the

289
00:08:23,216 --> 0:08:24,666
audio-related queries that Siri

290
00:08:24,666 --> 0:08:25,206
supports.

291
00:08:26,196 --> 0:08:27,716
Our job in Resolve is to go from

292
00:08:27,716 --> 0:08:29,006
that universe of possibilities

293
00:08:29,536 --> 0:08:30,716
to a single item to play.

294
00:08:31,626 --> 0:08:33,246
And in this example, the first

295
00:08:33,246 --> 0:08:34,946
thing we're going to do is read

296
00:08:34,946 --> 0:08:36,236
the media name off the

297
00:08:36,236 --> 0:08:37,166
INMediaSearch.

298
00:08:39,376 --> 0:08:40,926
Then we're going to retrieve a

299
00:08:40,926 --> 0:08:42,246
list of items from our app

300
00:08:42,246 --> 0:08:42,716
catalog.

301
00:08:43,676 --> 0:08:46,436
And we're going to use the media

302
00:08:46,436 --> 0:08:47,496
name property off the media

303
00:08:47,496 --> 0:08:48,906
search to compare against the

304
00:08:48,906 --> 0:08:50,786
item's name property.

305
00:08:51,296 --> 0:08:53,956
And we'll talk a little bit more

306
00:08:53,956 --> 0:08:55,346
about this later on, but this

307
00:08:55,386 --> 0:08:56,276
isn't really something you're

308
00:08:56,276 --> 0:08:57,416
going to want to do in your

309
00:08:57,416 --> 0:08:58,906
shipping app.

310
00:08:59,696 --> 0:09:02,346
But if we had an exact match on

311
00:08:59,696 --> 0:09:02,346
But if we had an exact match on

312
00:09:02,346 --> 0:09:04,326
the name, we found the item to

313
00:09:04,326 --> 0:09:05,996
play, and we're going to create

314
00:09:05,996 --> 0:09:07,796
a success result using that

315
00:09:07,796 --> 0:09:08,506
item's properties.

316
00:09:10,096 --> 0:09:11,996
Then we'll call a completion

317
00:09:11,996 --> 0:09:13,826
handler and move on to handle.

318
00:09:14,326 --> 0:09:17,386
And in this case, as we said

319
00:09:17,386 --> 0:09:19,196
before, handle ends up being

320
00:09:19,196 --> 0:09:20,786
very short, since all we're

321
00:09:20,786 --> 0:09:21,996
going to do is return the

322
00:09:22,076 --> 0:09:23,726
handleInApp success response

323
00:09:23,806 --> 0:09:23,996
code.

324
00:09:24,056 --> 0:09:25,586
And this is going to start the

325
00:09:25,586 --> 0:09:26,746
process of background launching

326
00:09:26,746 --> 0:09:27,116
our app.

327
00:09:28,186 --> 0:09:29,396
Now let's take a look at

328
00:09:29,456 --> 0:09:30,376
background app launch.

329
00:09:32,156 --> 0:09:33,666
The method that we implement in

330
00:09:33,666 --> 0:09:35,546
our app delegate to support

331
00:09:35,596 --> 0:09:36,886
background app launch is

332
00:09:37,276 --> 0:09:38,886
application handling intent

333
00:09:39,216 --> 0:09:39,856
completion handler.

334
00:09:41,846 --> 0:09:43,306
Again, this is a pretty short

335
00:09:43,306 --> 0:09:44,026
implementation.

336
00:09:44,026 --> 0:09:47,416
We're going to read the first

337
00:09:47,416 --> 0:09:48,966
media item to play out of the

338
00:09:48,966 --> 0:09:51,796
intent and then we're going to

339
00:09:51,796 --> 0:09:53,216
just play it in our app the way

340
00:09:53,216 --> 0:09:53,836
we normally do.

341
00:09:55,796 --> 0:09:57,256
And finally, we'll call the

342
00:09:57,256 --> 0:09:58,886
completion handler with our

343
00:09:58,886 --> 0:10:00,786
success response code.

344
00:09:58,886 --> 0:10:00,786
success response code.

345
00:10:01,856 --> 0:10:03,446
So now that we've seen the new

346
00:10:03,446 --> 0:10:04,786
intents and how they all fit

347
00:10:04,866 --> 0:10:06,526
together, let's hand it over to

348
00:10:06,526 --> 0:10:08,286
Ryan Klems, who's going to show

349
00:10:08,286 --> 0:10:09,906
us how this all works in a real

350
00:10:10,096 --> 0:10:10,166
app.

351
00:10:11,516 --> 0:10:17,216
[ Applause ]

352
00:10:17,716 --> 0:10:18,346
&gt;&gt; Thanks, Danny.

353
00:10:20,816 --> 0:10:22,066
Adding SiriKit Media Intent

354
00:10:22,066 --> 0:10:23,216
handling to your existing media

355
00:10:23,216 --> 0:10:24,196
application is easy.

356
00:10:24,616 --> 0:10:25,536
Here we have our music

357
00:10:25,536 --> 0:10:26,846
application and all we need to

358
00:10:26,846 --> 0:10:29,176
do to add Siri support is to add

359
00:10:29,176 --> 0:10:30,636
the Siri extension target, add a

360
00:10:30,636 --> 0:10:33,496
few methods, and then we'll up

361
00:10:33,496 --> 0:10:34,816
and handling Siri requests in no

362
00:10:34,816 --> 0:10:35,086
time.

363
00:10:36,056 --> 0:10:36,966
To add to the intent's

364
00:10:36,966 --> 0:10:38,176
extension, all we have to do is

365
00:10:38,176 --> 0:10:41,226
go to file, new, target, select

366
00:10:42,516 --> 0:10:45,326
the intents extension and click

367
00:10:45,326 --> 0:10:45,796
next.

368
00:10:46,236 --> 0:10:50,896
Give it a name and then click

369
00:10:50,896 --> 0:10:51,336
finish.

370
00:10:53,716 --> 0:10:55,396
It will go ahead and create our

371
00:10:55,396 --> 0:10:56,516
intent handler for us.

372
00:10:57,256 --> 0:10:59,486
We'll want to go ahead and add

373
00:10:59,756 --> 0:11:01,196
the Siri capability to our

374
00:10:59,756 --> 0:11:01,196
the Siri capability to our

375
00:11:01,196 --> 0:11:01,836
application.

376
00:11:05,576 --> 0:11:07,166
And then we'll come over to our

377
00:11:07,166 --> 0:11:09,896
control extension and we will

378
00:11:09,896 --> 0:11:12,406
add our intents that we support,

379
00:11:12,406 --> 0:11:13,456
and in this example, we'll just

380
00:11:13,456 --> 0:11:14,736
go ahead and support the

381
00:11:15,806 --> 0:11:19,266
INPlayMediaIntent and the

382
00:11:19,266 --> 0:11:20,406
INAddMediaIntent.

383
00:11:27,046 --> 0:11:27,836
We'll go ahead and select the

384
00:11:27,836 --> 0:11:28,656
music type.

385
00:11:30,646 --> 0:11:31,896
We have a few methods here that

386
00:11:31,896 --> 0:11:33,406
we want to add to make sure that

387
00:11:33,406 --> 0:11:34,836
we build in our extension.

388
00:11:40,726 --> 0:11:41,666
And we'll want to make sure to

389
00:11:41,666 --> 0:11:44,976
turn on our proper code signing.

390
00:11:46,156 --> 0:11:47,396
Now we'll come over to our

391
00:11:47,396 --> 0:11:49,496
intent handler and all we need

392
00:11:49,496 --> 0:11:51,086
to do is add support for the

393
00:11:51,086 --> 0:11:52,516
INPlayMediaIntent handling

394
00:11:52,516 --> 0:11:53,016
protocol.

395
00:11:53,716 --> 0:11:57,636
And then we'll drop in some

396
00:11:57,636 --> 0:12:01,526
stubs for our resolve and handle

397
00:11:57,636 --> 0:12:01,526
stubs for our resolve and handle

398
00:12:02,586 --> 0:12:03,196
methods.

399
00:12:03,276 --> 0:12:06,436
For this beginning example,

400
00:12:06,526 --> 0:12:07,436
we're just going to return the

401
00:12:07,436 --> 0:12:10,566
unsupported result from resolve

402
00:12:10,566 --> 0:12:11,856
media items, which will cause

403
00:12:11,856 --> 0:12:13,096
Siri to speak to the fact that

404
00:12:13,136 --> 0:12:14,256
it couldn't find the item.

405
00:12:15,096 --> 0:12:16,296
So we'll go ahead and try that

406
00:12:16,296 --> 0:12:16,506
out.

407
00:12:16,846 --> 0:12:17,536
This is what that would've

408
00:12:17,536 --> 0:12:17,936
looked like.

409
00:12:28,096 --> 0:12:30,376
So Siri speaks to the fact that

410
00:12:30,376 --> 0:12:32,446
it couldn't find the item due to

411
00:12:32,446 --> 0:12:33,326
the fact that we returned the

412
00:12:33,326 --> 0:12:35,656
unsupported from the intent

413
00:12:35,656 --> 0:12:35,936
handler.

414
00:12:37,366 --> 0:12:39,286
So what we'll do now is we'll go

415
00:12:39,286 --> 0:12:41,326
ahead and hook this up to our

416
00:12:41,326 --> 0:12:42,766
existing search implementation.

417
00:12:48,056 --> 0:12:50,456
And in this case, the first

418
00:12:50,456 --> 0:12:51,076
thing that we're going to want

419
00:12:51,076 --> 0:12:52,496
to do is determine what the user

420
00:12:52,496 --> 0:12:53,206
is searching for.

421
00:12:53,206 --> 0:12:55,096
So for this simple example,

422
00:12:55,096 --> 0:12:57,136
we'll just search for an artist.

423
00:12:57,846 --> 0:13:03,046
And in the method, we'll go

424
00:12:57,846 --> 0:13:03,046
And in the method, we'll go

425
00:13:03,046 --> 0:13:06,106
ahead and resolve the media

426
00:13:06,106 --> 0:13:06,476
item.

427
00:13:24,046 --> 0:13:25,146
And once we resolve the media

428
00:13:25,146 --> 0:13:27,196
item, then we will return to our

429
00:13:27,196 --> 0:13:28,966
handle method and we're just

430
00:13:28,966 --> 0:13:30,456
going to return the handleInApp

431
00:13:31,236 --> 0:13:33,176
method response code, which will

432
00:13:33,176 --> 0:13:34,656
cause us to background launch

433
00:13:34,656 --> 0:13:35,346
the application.

434
00:13:35,346 --> 0:13:36,326
So in order to do that, we'll

435
00:13:36,326 --> 0:13:37,566
switch over to our app delegate

436
00:13:38,436 --> 0:13:41,176
and we need to add the handle

437
00:13:41,176 --> 0:13:41,866
intent method.

438
00:13:42,356 --> 0:13:43,796
And this will just extract the

439
00:13:43,796 --> 0:13:45,806
INMediaItem that we passed, that

440
00:13:45,806 --> 0:13:46,886
we resolved, in the previous

441
00:13:46,886 --> 0:13:48,796
step, and pass that to playback.

442
00:13:49,506 --> 0:13:51,656
And so we'll go ahead and play

443
00:13:51,656 --> 0:13:53,506
what that would look like.

444
00:13:59,456 --> 0:14:00,766
So you can see, we return the

445
00:13:59,456 --> 0:14:00,766
So you can see, we return the

446
00:14:00,896 --> 0:14:02,896
INMediaItem and it has resolved

447
00:14:02,896 --> 0:14:04,706
that, handed it back to the

448
00:14:04,706 --> 0:14:06,456
application, and begun playback.

449
00:14:07,436 --> 0:14:08,486
So now that we've done that, why

450
00:14:08,486 --> 0:14:09,476
don't we go ahead and add

451
00:14:09,476 --> 0:14:12,696
support for the add method.

452
00:14:12,756 --> 0:14:14,436
So to do that, we'll just extend

453
00:14:14,436 --> 0:14:16,446
this by adding the

454
00:14:16,446 --> 0:14:17,776
INAddMediaIntent handling

455
00:14:17,776 --> 0:14:18,256
protocol.

456
00:14:22,836 --> 0:14:25,146
And then we'll add our methods

457
00:14:25,186 --> 0:14:27,706
for resolving and handling for

458
00:14:27,706 --> 0:14:28,356
the add method.

459
00:14:29,316 --> 0:14:30,166
So you notice here that the

460
00:14:30,166 --> 0:14:31,636
resolve media items for add

461
00:14:31,636 --> 0:14:33,646
looks pretty much identical to

462
00:14:33,646 --> 0:14:35,066
the resolve method for play.

463
00:14:36,966 --> 0:14:38,456
Additionally, now for ad, we'll

464
00:14:38,456 --> 0:14:39,706
also have a resolve media

465
00:14:39,706 --> 0:14:40,456
destination.

466
00:14:40,536 --> 0:14:41,316
And this is where we're going to

467
00:14:41,316 --> 0:14:42,166
determine whether the user's

468
00:14:42,166 --> 0:14:43,396
trying to add to the library or

469
00:14:43,396 --> 0:14:44,196
to a playlist.

470
00:14:45,186 --> 0:14:46,316
And in the case of a playlist,

471
00:14:46,316 --> 0:14:47,126
you might want to do something

472
00:14:47,126 --> 0:14:49,246
like "Return playlist name not

473
00:14:49,246 --> 0:14:51,526
found," if the playlist that the

474
00:14:51,526 --> 0:14:53,236
user specified was not present

475
00:14:53,236 --> 0:14:53,966
in their library.

476
00:14:56,686 --> 0:14:59,136
And also, what's different in

477
00:14:59,196 --> 0:15:00,716
the ad is there's no reason to

478
00:14:59,196 --> 0:15:00,716
the ad is there's no reason to

479
00:15:00,716 --> 0:15:02,196
go back to the application like

480
00:15:02,306 --> 0:15:03,816
to begin playback like we do in

481
00:15:03,816 --> 0:15:04,866
the Play Media Intent.

482
00:15:05,316 --> 0:15:06,476
So in this case what we would do

483
00:15:06,476 --> 0:15:07,336
is we would actually handle

484
00:15:07,396 --> 0:15:08,746
everything in the extension

485
00:15:08,746 --> 0:15:09,146
itself.

486
00:15:09,776 --> 0:15:11,756
So we have the resolved media

487
00:15:11,756 --> 0:15:12,786
item, and we'll just go ahead

488
00:15:12,786 --> 0:15:15,646
and use our applications methods

489
00:15:15,646 --> 0:15:16,966
to add to the library or to the

490
00:15:17,066 --> 0:15:17,566
playlist.

491
00:15:17,966 --> 0:15:18,766
And in this case, we're just

492
00:15:18,766 --> 0:15:19,896
going to use the media player

493
00:15:19,896 --> 0:15:21,366
utilities to add to it.

494
00:15:22,126 --> 0:15:23,226
So let's go ahead and take a

495
00:15:23,226 --> 0:15:24,026
look at what that would look

496
00:15:24,076 --> 0:15:24,246
like.

497
00:15:37,316 --> 0:15:38,546
So it speaks to the item that is

498
00:15:38,546 --> 0:15:39,976
added to the playlist as well as

499
00:15:39,976 --> 0:15:41,076
the playlist name, because those

500
00:15:41,076 --> 0:15:43,426
are specified in the request.

501
00:15:44,456 --> 0:15:45,846
So as you can see, it's

502
00:15:45,846 --> 0:15:47,376
relatively easy to add support

503
00:15:47,376 --> 0:15:48,236
to your application.

504
00:15:48,236 --> 0:15:49,186
And we really look forward to

505
00:15:49,186 --> 0:15:50,606
seeing what you do in your

506
00:15:50,606 --> 0:15:51,156
application.

507
00:15:51,336 --> 0:15:51,626
Thank you.

508
00:15:52,016 --> 0:15:53,586
[ Applause ]

509
00:15:53,586 --> 0:15:54,246
Danny, back to you.

510
00:15:57,756 --> 0:15:58,356
&gt;&gt; Thanks, Ryan.

511
00:15:58,966 --> 0:16:00,216
So what did Ryan show us?

512
00:15:58,966 --> 0:16:00,216
So what did Ryan show us?

513
00:16:00,826 --> 0:16:02,306
First, he showed us how to add

514
00:16:02,306 --> 0:16:03,776
our intents extension to our

515
00:16:04,516 --> 0:16:04,596
app.

516
00:16:04,596 --> 0:16:06,536
Then he showed us how to specify

517
00:16:06,536 --> 0:16:08,066
our supported intents and

518
00:16:08,066 --> 0:16:09,076
supported media types.

519
00:16:09,486 --> 0:16:11,106
And finally, he showed us how to

520
00:16:11,106 --> 0:16:13,676
implement resolve and handle for

521
00:16:13,676 --> 0:16:15,486
INPlayMediaIntent and

522
00:16:15,486 --> 0:16:17,416
INAddMediaIntent so we could

523
00:16:17,416 --> 0:16:19,646
immediately begin playing and

524
00:16:19,646 --> 0:16:22,286
adding media using Siri.

525
00:16:23,556 --> 0:16:25,036
So let's look at some best

526
00:16:25,036 --> 0:16:26,106
practices you're going to want

527
00:16:26,106 --> 0:16:27,936
to follow when you adopt SiriKit

528
00:16:27,936 --> 0:16:28,246
Media.

529
00:16:28,866 --> 0:16:31,686
We have great news if you've

530
00:16:31,686 --> 0:16:33,036
already implemented shortcut

531
00:16:33,036 --> 0:16:34,326
support for media playback.

532
00:16:35,116 --> 0:16:36,966
SiriKit Media uses the same code

533
00:16:37,056 --> 0:16:38,596
and handle and for background

534
00:16:38,596 --> 0:16:39,106
app launch.

535
00:16:40,176 --> 0:16:41,916
While Shortcuts operates on

536
00:16:41,916 --> 0:16:43,656
previously donated intents which

537
00:16:43,656 --> 0:16:45,206
don't require intent resolution,

538
00:16:45,886 --> 0:16:47,626
SiriKit does require a resolve

539
00:16:47,626 --> 0:16:47,896
step.

540
00:16:48,446 --> 0:16:49,416
So the two things you're going

541
00:16:49,416 --> 0:16:51,516
to need to add are your resolve

542
00:16:51,516 --> 0:16:52,976
method and your intent handler,

543
00:16:53,546 --> 0:16:54,226
and you're going to need to

544
00:16:54,226 --> 0:16:55,696
update your intents extension

545
00:16:55,696 --> 0:16:57,286
supported media types in Xcode

546
00:16:57,976 --> 0:16:59,556
so Siri knows what content types

547
00:16:59,556 --> 0:17:00,286
your app supports.

548
00:16:59,556 --> 0:17:00,286
your app supports.

549
00:17:01,516 --> 0:17:03,256
The extensions handle method

550
00:17:03,256 --> 0:17:04,396
should be the same between both

551
00:17:04,396 --> 0:17:05,876
implementations and the

552
00:17:05,876 --> 0:17:08,205
background app launch to the app

553
00:17:08,205 --> 0:17:10,016
delegate's handle intent can be

554
00:17:10,016 --> 0:17:11,766
the same, as long as you use the

555
00:17:11,806 --> 0:17:13,705
same identifiers for your media

556
00:17:13,705 --> 0:17:14,036
items.

557
00:17:14,036 --> 0:17:17,096
So let's see what this looks

558
00:17:17,236 --> 0:17:17,415
like.

559
00:17:17,756 --> 0:17:18,695
Here's our Shortcuts

560
00:17:18,695 --> 0:17:19,915
implementation from last year.

561
00:17:20,445 --> 0:17:21,406
You'll notice that there's no

562
00:17:21,406 --> 0:17:22,516
resolve method, but the rest of

563
00:17:22,516 --> 0:17:22,976
it's the same.

564
00:17:23,705 --> 0:17:25,056
So to go from Shortcuts to

565
00:17:25,056 --> 0:17:27,546
SiriKit, we just add in our

566
00:17:27,546 --> 0:17:30,016
resolve method and we're good to

567
00:17:31,396 --> 0:17:31,476
go.

568
00:17:31,726 --> 0:17:32,926
Now let's talk about what you

569
00:17:32,926 --> 0:17:34,096
need to do to bring SiriKit

570
00:17:34,096 --> 0:17:37,656
Media Support to the Apple

571
00:17:37,656 --> 0:17:37,906
Watch.

572
00:17:37,906 --> 0:17:39,186
On watchOS, apps launch in the

573
00:17:39,186 --> 0:17:39,696
foreground.

574
00:17:40,086 --> 0:17:41,376
And the way you do that is by

575
00:17:41,376 --> 0:17:44,516
returning INPlayMediaIntent

576
00:17:44,516 --> 0:17:46,636
response code continueInApp from

577
00:17:46,906 --> 0:17:47,906
your handle method in your

578
00:17:47,906 --> 0:17:48,686
intent's extension.

579
00:17:50,196 --> 0:17:51,246
This code is going to do a

580
00:17:51,246 --> 0:17:52,776
foreground app launch and

581
00:17:52,776 --> 0:17:53,906
forward the intent to your

582
00:17:53,906 --> 0:17:55,386
WKExtension delegate in your

583
00:17:55,456 --> 0:17:55,546
app.

584
00:17:55,546 --> 0:17:59,486
You'll note that the apps handle

585
00:17:59,486 --> 0:18:00,676
method looks pretty similar to

586
00:17:59,486 --> 0:18:00,676
method looks pretty similar to

587
00:18:00,676 --> 0:18:01,526
the one in iOS.

588
00:18:02,186 --> 0:18:03,596
The method signature is slightly

589
00:18:03,596 --> 0:18:05,006
different, but you're going to

590
00:18:05,006 --> 0:18:06,616
want to read the intent off the

591
00:18:06,616 --> 0:18:08,616
NSUser activities interaction

592
00:18:08,616 --> 0:18:09,066
property.

593
00:18:09,316 --> 0:18:11,256
And then, just like on iOS, you

594
00:18:11,256 --> 0:18:13,376
read the media item to play and

595
00:18:13,376 --> 0:18:15,406
start playback in your app.

596
00:18:16,516 --> 0:18:17,696
One word of caution.

597
00:18:17,696 --> 0:18:19,136
You're going to want to use the

598
00:18:19,136 --> 0:18:21,266
on-device cache in your resolve

599
00:18:21,266 --> 0:18:22,436
method on watchOS.

600
00:18:22,746 --> 0:18:24,446
Only go over the network if it's

601
00:18:24,546 --> 0:18:25,626
absolutely necessary.

602
00:18:26,446 --> 0:18:29,676
So we know that when someone

603
00:18:29,676 --> 0:18:31,876
says "Play Awesome Song in my

604
00:18:31,876 --> 0:18:33,926
app," the first step in Request

605
00:18:33,926 --> 0:18:35,566
Processing is to resolve the

606
00:18:35,566 --> 0:18:36,476
media items to play.

607
00:18:36,476 --> 0:18:38,506
And we looked at a previous

608
00:18:38,506 --> 0:18:40,276
implementation where we checked

609
00:18:40,276 --> 0:18:41,336
the value of the media item's

610
00:18:41,376 --> 0:18:43,356
name against the intent's media

611
00:18:43,356 --> 0:18:43,996
name property.

612
00:18:45,146 --> 0:18:46,796
And it was an exact match.

613
00:18:47,406 --> 0:18:49,076
So what are some edge cases that

614
00:18:49,076 --> 0:18:50,066
we didn't cover in that

615
00:18:50,066 --> 0:18:50,786
implementation?

616
00:18:51,306 --> 0:18:53,786
The first place that our

617
00:18:53,786 --> 0:18:54,856
previous method won't do the

618
00:18:54,856 --> 0:18:56,206
right thing is if we have a

619
00:18:56,206 --> 0:18:58,036
mismatch on either case or

620
00:18:58,036 --> 0:18:58,616
punctuation.

621
00:18:59,376 --> 0:19:01,426
So in this example, "Play hello

622
00:18:59,376 --> 0:19:01,426
So in this example, "Play hello

623
00:19:01,426 --> 0:19:02,896
in my app," we can see a few

624
00:19:02,896 --> 0:19:04,066
cases where exact string

625
00:19:04,066 --> 0:19:05,096
comparison will fail.

626
00:19:06,296 --> 0:19:07,666
The exact song title is

627
00:19:07,876 --> 0:19:09,206
uppercase HELLO with an

628
00:19:09,206 --> 0:19:09,986
exclamation point.

629
00:19:10,606 --> 0:19:11,856
But it's possible that the Siri

630
00:19:11,856 --> 0:19:13,096
speech engine could give us

631
00:19:13,296 --> 0:19:14,076
lowercase hello.

632
00:19:14,726 --> 0:19:16,026
Or maybe it gives us uppercase

633
00:19:16,026 --> 0:19:17,246
HELLO without the exclamation

634
00:19:17,246 --> 0:19:17,496
point.

635
00:19:18,026 --> 0:19:19,806
So it's really important that we

636
00:19:19,806 --> 0:19:21,916
ignore case and punctuation in

637
00:19:21,916 --> 0:19:23,426
our resolve method.

638
00:19:25,476 --> 0:19:27,736
Similarly, a lot of music

639
00:19:27,736 --> 0:19:28,876
entities have things in the

640
00:19:28,876 --> 0:19:30,686
title that people either won't

641
00:19:30,726 --> 0:19:33,026
say or they're going to say in a

642
00:19:33,026 --> 0:19:34,826
way that doesn't exactly match

643
00:19:34,826 --> 0:19:35,706
with the item's title.

644
00:19:36,556 --> 0:19:37,726
For instance, a lot of albums

645
00:19:37,816 --> 0:19:39,116
come in a deluxe edition

646
00:19:39,116 --> 0:19:39,536
variant.

647
00:19:39,886 --> 0:19:41,086
And people aren't going to say

648
00:19:41,086 --> 0:19:42,606
this when they ask to play the

649
00:19:42,606 --> 0:19:42,986
album.

650
00:19:44,346 --> 0:19:45,846
They aren't going to say "Play

651
00:19:45,846 --> 0:19:47,226
the album Outer Peace deluxe

652
00:19:47,226 --> 0:19:48,846
edition in my app," they'll say

653
00:19:48,846 --> 0:19:50,196
"Play the album Outer Peace in

654
00:19:50,306 --> 0:19:50,566
my app."

655
00:19:51,986 --> 0:19:53,086
And soundtracks are another

656
00:19:53,086 --> 0:19:53,506
example.

657
00:19:54,526 --> 0:19:55,596
People aren't going to say --

658
00:19:55,596 --> 0:19:57,006
they'll say "Play the Rocket Man

659
00:19:57,066 --> 0:19:58,016
soundtrack in my app."

660
00:19:58,836 --> 0:19:59,836
And they aren't going to say

661
00:19:59,836 --> 0:20:01,046
"Music from the motion picture."

662
00:19:59,836 --> 0:20:01,046
"Music from the motion picture."

663
00:20:02,536 --> 0:20:03,786
And finally, a lot of hip-hop

664
00:20:03,786 --> 0:20:05,376
songs have this featuring

665
00:20:05,376 --> 0:20:06,546
abbreviation in their title.

666
00:20:07,126 --> 0:20:09,966
So people either won't say it or

667
00:20:09,966 --> 0:20:10,696
they'll say the word

668
00:20:10,696 --> 0:20:11,166
"featuring."

669
00:20:11,346 --> 0:20:12,706
So exact match isn't going to

670
00:20:12,706 --> 0:20:13,666
work here either.

671
00:20:19,476 --> 0:20:21,756
And podcasts also have some

672
00:20:21,756 --> 0:20:23,036
cases where there is a mismatch

673
00:20:23,296 --> 0:20:25,076
between what people say and what

674
00:20:25,076 --> 0:20:26,126
entity titles are.

675
00:20:27,106 --> 0:20:29,116
So some podcasts have the word

676
00:20:29,116 --> 0:20:30,156
"podcast" in their title.

677
00:20:30,796 --> 0:20:32,616
So if someone said "Play the

678
00:20:32,686 --> 0:20:34,246
Stuff You Should Know podcast in

679
00:20:34,246 --> 0:20:36,706
my app," Siri could parse it as

680
00:20:37,136 --> 0:20:39,316
stuff you should know in a media

681
00:20:39,316 --> 0:20:40,836
item type of podcast.

682
00:20:41,436 --> 0:20:42,976
So an exact match isn't going to

683
00:20:42,976 --> 0:20:43,806
work here either.

684
00:20:44,726 --> 0:20:46,696
And additionally, some podcasts

685
00:20:46,806 --> 0:20:49,326
come in audio or video variants,

686
00:20:49,326 --> 0:20:50,676
and that audio or video word

687
00:20:50,916 --> 0:20:51,726
appears in the title.

688
00:20:52,606 --> 0:20:54,376
But SiriKit Media implies the

689
00:20:54,376 --> 0:20:56,426
audio variety, so people aren't

690
00:20:56,426 --> 0:20:59,716
going to say that either.

691
00:20:59,946 --> 0:21:01,076
Finally, remember that you're

692
00:20:59,946 --> 0:21:01,076
Finally, remember that you're

693
00:21:01,076 --> 0:21:01,866
working with a speech

694
00:21:01,866 --> 0:21:03,756
recognizer, and the speech

695
00:21:03,756 --> 0:21:05,566
recognizer can come with word

696
00:21:05,566 --> 0:21:06,586
formatting variations.

697
00:21:06,996 --> 0:21:08,166
So if someone asks to play the

698
00:21:08,166 --> 0:21:10,106
song 81st, you can get the

699
00:21:10,106 --> 0:21:12,286
number 81 st or you can get the

700
00:21:12,326 --> 0:21:13,796
hyphenated eighty-first.

701
00:21:15,286 --> 0:21:16,416
Or if someone asks to play the

702
00:21:16,416 --> 0:21:17,866
song I Love You Son, you could

703
00:21:17,866 --> 0:21:19,786
get sun or son.

704
00:21:19,846 --> 0:21:23,116
Now, Siri is going to do the

705
00:21:23,116 --> 0:21:25,056
best job it can to give you the

706
00:21:25,056 --> 0:21:26,386
entity titles for the things

707
00:21:26,386 --> 0:21:27,086
that it knows about.

708
00:21:27,746 --> 0:21:30,496
But it's better for you to be

709
00:21:30,496 --> 0:21:33,546
flexible in your resolve method.

710
00:21:35,096 --> 0:21:38,136
When you implement your SiriKit

711
00:21:38,136 --> 0:21:39,846
Media Support, you control what

712
00:21:39,846 --> 0:21:42,246
Siri says by the INMediaItem

713
00:21:42,246 --> 0:21:43,446
objects you return from your

714
00:21:43,446 --> 0:21:44,046
resolve method.

715
00:21:44,976 --> 0:21:46,906
As you can see here, the user

716
00:21:46,906 --> 0:21:48,106
asks to play the song Maybe

717
00:21:48,106 --> 0:21:49,986
Sometime by Special Disaster

718
00:21:49,986 --> 0:21:51,436
team in Control Audio.

719
00:21:51,936 --> 0:21:53,856
And Siri said, "Here's Maybe

720
00:21:53,856 --> 0:21:55,536
Sometime by Special Disaster

721
00:21:55,536 --> 0:21:57,146
Team from Control Audio."

722
00:21:57,896 --> 0:22:00,316
In this case the returned

723
00:21:57,896 --> 0:22:00,316
In this case the returned

724
00:22:00,486 --> 0:22:02,826
INMediaItem had a title property

725
00:22:02,826 --> 0:22:04,756
of Maybe Sometime and an artist

726
00:22:04,756 --> 0:22:06,226
property of Special Disaster

727
00:22:06,226 --> 0:22:06,416
team.

728
00:22:07,306 --> 0:22:08,966
So make sure you always populate

729
00:22:09,486 --> 0:22:12,216
title, artist, and type in the

730
00:22:12,216 --> 0:22:13,946
returned media items, as these

731
00:22:13,976 --> 0:22:15,586
can all influence what Siri

732
00:22:15,586 --> 0:22:15,866
says.

733
00:22:16,686 --> 0:22:18,396
And one thing to note, if you

734
00:22:18,396 --> 0:22:19,686
return more than one item in

735
00:22:19,686 --> 0:22:21,226
your resolve method, Siri is

736
00:22:21,226 --> 0:22:22,376
going to speak to the first item

737
00:22:22,376 --> 0:22:23,506
in the list.

738
00:22:25,146 --> 0:22:26,966
It's super important that you

739
00:22:27,046 --> 0:22:28,596
handle error cases appropriately

740
00:22:28,596 --> 0:22:29,426
in SiriKit Media.

741
00:22:30,456 --> 0:22:31,426
When you're interacting with an

742
00:22:31,426 --> 0:22:32,926
intelligent assistant like Siri,

743
00:22:32,926 --> 0:22:34,996
it can be unclear why something

744
00:22:34,996 --> 0:22:35,946
happened when it happened.

745
00:22:36,376 --> 0:22:37,586
And handling error cases

746
00:22:37,586 --> 0:22:39,036
appropriately is going to allow

747
00:22:39,036 --> 0:22:40,506
you to give the user the best

748
00:22:40,506 --> 0:22:41,476
idea of what happened when

749
00:22:41,476 --> 0:22:42,186
something goes wrong.

750
00:22:43,136 --> 0:22:44,576
So the most common case you're

751
00:22:44,576 --> 0:22:45,906
going to run into is when you

752
00:22:45,906 --> 0:22:47,116
don't find something in your app

753
00:22:47,116 --> 0:22:48,136
catalog that someone's asked

754
00:22:48,136 --> 0:22:48,356
for.

755
00:22:48,476 --> 0:22:50,776
And you handle this case by just

756
00:22:50,776 --> 0:22:52,006
returning the unsupported

757
00:22:52,006 --> 0:22:53,626
resolution result from resolve

758
00:22:53,626 --> 0:22:54,186
media items.

759
00:22:55,236 --> 0:22:56,016
But there's a lot of other

760
00:22:56,016 --> 0:22:57,686
errors that could happen.

761
00:22:57,686 --> 0:22:58,676
Maybe someone asks to play

762
00:22:58,736 --> 0:23:00,416
something that requires cellular

763
00:22:58,736 --> 0:23:00,416
something that requires cellular

764
00:23:00,416 --> 0:23:02,026
data but they have the cellular

765
00:23:02,026 --> 0:23:03,216
data switch turned off for your

766
00:23:04,186 --> 0:23:04,276
app.

767
00:23:04,696 --> 0:23:06,206
Or maybe they ask to play

768
00:23:06,206 --> 0:23:07,306
something that requires a

769
00:23:07,306 --> 0:23:08,836
subscription and they don't have

770
00:23:08,836 --> 0:23:09,016
one.

771
00:23:10,586 --> 0:23:11,426
The full list is in

772
00:23:11,556 --> 0:23:12,986
INPlayMediaMediaItem

773
00:23:12,986 --> 0:23:13,826
UnsupportedReason.

774
00:23:14,216 --> 0:23:15,476
And there's generally similar

775
00:23:15,476 --> 0:23:17,536
naming for all four intents, so

776
00:23:17,536 --> 0:23:18,766
make sure you adopt them for all

777
00:23:18,766 --> 0:23:19,756
the intents you support.

778
00:23:20,296 --> 0:23:21,846
Now let's talk about some of the

779
00:23:21,846 --> 0:23:23,316
variety of things that people

780
00:23:23,316 --> 0:23:25,106
say to Siri and how you can do a

781
00:23:25,106 --> 0:23:27,146
good job handling of them in

782
00:23:27,146 --> 0:23:28,086
your SiriKit Media

783
00:23:28,086 --> 0:23:28,826
implementation.

784
00:23:29,466 --> 0:23:32,306
So one of the most popular

785
00:23:32,306 --> 0:23:33,626
things that people say to Siri

786
00:23:33,626 --> 0:23:35,486
is "Play my app."

787
00:23:35,816 --> 0:23:36,906
They don't tell you exactly what

788
00:23:36,906 --> 0:23:38,196
it is that they want to play,

789
00:23:39,346 --> 0:23:41,386
and it's your job as a SiriKit

790
00:23:41,386 --> 0:23:43,276
Media developer to choose the

791
00:23:43,276 --> 0:23:45,816
right thing to do for your app.

792
00:23:46,036 --> 0:23:47,186
Now, this might be something as

793
00:23:47,186 --> 0:23:48,656
simple as resuming an existing

794
00:23:48,656 --> 0:23:49,036
queue.

795
00:23:49,716 --> 0:23:51,386
If you're not an audiobooks or

796
00:23:51,386 --> 0:23:53,196
podcasting app, this is probably

797
00:23:53,196 --> 0:23:54,356
the most reasonable behavior to

798
00:23:54,356 --> 0:23:54,726
implement.

799
00:23:55,976 --> 0:23:57,236
But you can make the behavior as

800
00:23:57,236 --> 0:23:58,096
dynamic as you like.

801
00:23:58,926 --> 0:24:00,996
Maybe you want to direct them to

802
00:23:58,926 --> 0:24:00,996
Maybe you want to direct them to

803
00:24:00,996 --> 0:24:02,976
a recommended playlist or some

804
00:24:02,976 --> 0:24:04,036
hot new trending music.

805
00:24:04,616 --> 0:24:05,426
The choice is yours.

806
00:24:06,186 --> 0:24:07,266
And how do you know that someone

807
00:24:07,266 --> 0:24:09,336
said, "Play my app," well, there

808
00:24:09,336 --> 0:24:10,626
will be no search criteria

809
00:24:10,626 --> 0:24:12,306
specified in the INMediaSearch

810
00:24:12,306 --> 0:24:12,646
object.

811
00:24:13,246 --> 0:24:14,426
One thing that might seem like a

812
00:24:14,426 --> 0:24:16,396
good idea is to ask someone what

813
00:24:16,396 --> 0:24:17,016
they want to play.

814
00:24:17,016 --> 0:24:19,186
But for the same reason that we

815
00:24:19,186 --> 0:24:20,646
don't recommend using confirm,

816
00:24:21,196 --> 0:24:22,596
we don't recommend this

817
00:24:22,596 --> 0:24:22,986
approach.

818
00:24:23,746 --> 0:24:24,946
Putting dialogue prompts in

819
00:24:24,946 --> 0:24:26,686
front of people is one of the

820
00:24:26,686 --> 0:24:27,876
most common ways that they'll

821
00:24:27,876 --> 0:24:29,146
quit the SiriKit Media

822
00:24:29,146 --> 0:24:29,636
experience.

823
00:24:30,326 --> 0:24:33,766
People can ask to initiate

824
00:24:33,766 --> 0:24:34,706
playback with additional

825
00:24:34,706 --> 0:24:36,526
controls, and some of the

826
00:24:36,526 --> 0:24:37,876
supported options are repeat,

827
00:24:37,966 --> 0:24:39,466
shuffle, resume, and playback

828
00:24:39,466 --> 0:24:40,126
queue location.

829
00:24:41,136 --> 0:24:43,366
And if you support these in your

830
00:24:43,366 --> 0:24:45,216
app, make sure you support them

831
00:24:45,216 --> 0:24:46,866
in your INPlayMediaIntent

832
00:24:47,446 --> 0:24:48,456
implementation as well.

833
00:24:50,026 --> 0:24:51,196
And people can also ask to play

834
00:24:51,196 --> 0:24:52,326
content with a variety of search

835
00:24:52,326 --> 0:24:52,776
options.

836
00:24:53,586 --> 0:24:54,476
And one of the most useful

837
00:24:54,476 --> 0:24:55,726
search options is the sort

838
00:24:55,726 --> 0:24:56,156
parameter.

839
00:24:56,976 --> 0:24:58,196
You can say things like "Play

840
00:24:58,196 --> 0:24:59,406
the new Stuff You Should Know

841
00:24:59,406 --> 0:25:00,896
podcast in my app," and you'll

842
00:24:59,406 --> 0:25:00,896
podcast in my app," and you'll

843
00:25:00,896 --> 0:25:02,446
get INMediaSortOrder newest.

844
00:25:03,306 --> 0:25:04,436
Or you can ask for the best

845
00:25:04,436 --> 0:25:05,816
album by an artist, and you'll

846
00:25:05,816 --> 0:25:08,006
get INMediaSortOrder best.

847
00:25:08,126 --> 0:25:09,566
Or you can ask your app for a

848
00:25:09,686 --> 0:25:11,296
recommendation, and you'll get

849
00:25:11,406 --> 0:25:13,026
INMediaSortOrder recommended.

850
00:25:13,866 --> 0:25:14,926
Check out the full list in

851
00:25:15,016 --> 0:25:15,966
INMediaSortOrder.

852
00:25:16,146 --> 0:25:19,396
And another powerful search

853
00:25:19,396 --> 0:25:20,876
option is the reference

854
00:25:20,876 --> 0:25:22,266
property, which can have

855
00:25:22,416 --> 0:25:23,696
INMediaReferenceCurrently

856
00:25:23,696 --> 0:25:24,046
Playing.

857
00:25:25,166 --> 0:25:26,356
This is really useful for

858
00:25:26,356 --> 0:25:27,766
INAddMediaIntent or

859
00:25:27,766 --> 0:25:30,056
INUpdateMediaIntent, because

860
00:25:30,056 --> 0:25:31,816
people can easily add the

861
00:25:31,816 --> 0:25:33,066
currently playing item to a

862
00:25:33,066 --> 0:25:35,206
library or a playlist, or they

863
00:25:35,206 --> 0:25:36,656
can tell your app that they love

864
00:25:36,656 --> 0:25:37,746
or they hate their currently

865
00:25:37,786 --> 0:25:38,306
playing item.

866
00:25:39,146 --> 0:25:41,006
And one thing to note too is if

867
00:25:41,006 --> 0:25:42,336
you've populated the external

868
00:25:42,336 --> 0:25:43,576
content identifier in

869
00:25:43,576 --> 0:25:46,096
MPNowPlayingInfo center, that

870
00:25:46,096 --> 0:25:47,436
identifier is going to be in

871
00:25:47,436 --> 0:25:48,876
INMediaSearch's identifier

872
00:25:48,876 --> 0:25:50,586
property, so you know exactly

873
00:25:50,586 --> 0:25:54,036
what item to find.

874
00:25:54,496 --> 0:25:56,556
Now, telling Siri more about how

875
00:25:56,556 --> 0:25:58,726
your customer uses your app is

876
00:25:58,786 --> 0:26:00,306
going to help Siri provide a

877
00:25:58,786 --> 0:26:00,306
going to help Siri provide a

878
00:26:00,306 --> 0:26:01,806
wonderful SiriKit Media

879
00:26:01,806 --> 0:26:02,346
experience.

880
00:26:06,256 --> 0:26:08,256
So when you give user vocabulary

881
00:26:08,256 --> 0:26:10,426
to Siri, this helps Siri

882
00:26:10,476 --> 0:26:11,626
understand the parts of your

883
00:26:11,626 --> 0:26:13,446
catalog that are interesting to

884
00:26:13,446 --> 0:26:13,966
your customer.

885
00:26:14,906 --> 0:26:16,266
It's important to note it's not

886
00:26:16,266 --> 0:26:17,806
the entire contents of your app

887
00:26:17,806 --> 0:26:19,806
catalog, it's only the pieces of

888
00:26:19,836 --> 0:26:21,086
content that your customer is

889
00:26:21,086 --> 0:26:21,876
specifically interested in.

890
00:26:23,406 --> 0:26:25,056
It's also important to note that

891
00:26:25,056 --> 0:26:26,746
the vocabulary is ordered, so

892
00:26:26,746 --> 0:26:28,236
make sure that you include the

893
00:26:28,236 --> 0:26:29,916
most important items at the

894
00:26:29,916 --> 0:26:30,926
beginning of the collection.

895
00:26:32,146 --> 0:26:33,076
And depending on the type of

896
00:26:33,076 --> 0:26:34,706
media your app supports, you're

897
00:26:34,706 --> 0:26:35,776
going to send different types to

898
00:26:35,776 --> 0:26:36,106
Siri.

899
00:26:37,316 --> 0:26:39,466
Music apps should use playlist

900
00:26:39,466 --> 0:26:41,006
title and music artist name.

901
00:26:41,816 --> 0:26:43,206
Audiobook apps should use

902
00:26:43,336 --> 0:26:44,816
audiobook title and audiobook

903
00:26:44,816 --> 0:26:45,196
author.

904
00:26:45,926 --> 0:26:47,496
And podcasting apps should use

905
00:26:48,056 --> 0:26:48,636
show title.

906
00:26:50,256 --> 0:26:51,516
And for those things that are

907
00:26:51,516 --> 0:26:53,806
applicable to everybody that

908
00:26:53,806 --> 0:26:55,346
uses your app, check out the

909
00:26:55,346 --> 0:26:57,196
global vocabulary support in

910
00:26:57,196 --> 0:26:57,706
SiriKit.

911
00:26:58,486 --> 0:27:02,136
So in conclusion, we're

912
00:26:58,486 --> 0:27:02,136
So in conclusion, we're

913
00:27:02,136 --> 0:27:03,746
launching new SiriKit Media

914
00:27:03,746 --> 0:27:05,906
Intents to allow you to use Siri

915
00:27:05,906 --> 0:27:07,776
to control your audio apps.

916
00:27:08,006 --> 0:27:09,796
You'll be able to play, add,

917
00:27:10,366 --> 0:27:11,976
update taste profiles, and

918
00:27:12,026 --> 0:27:13,336
search for media using the new

919
00:27:13,336 --> 0:27:13,716
intents.

920
00:27:14,876 --> 0:27:16,056
It's very important that you

921
00:27:16,056 --> 0:27:17,266
provide the best experience

922
00:27:17,266 --> 0:27:17,766
possible.

923
00:27:18,396 --> 0:27:20,486
And you can do this by embracing

924
00:27:20,486 --> 0:27:21,546
search flexibility.

925
00:27:22,296 --> 0:27:24,426
Because people don't say exactly

926
00:27:24,426 --> 0:27:25,226
what they want to play.

927
00:27:26,246 --> 0:27:27,366
You can handle errors

928
00:27:27,366 --> 0:27:29,486
appropriately, so people know

929
00:27:29,486 --> 0:27:30,756
what's happened when something

930
00:27:30,756 --> 0:27:31,206
goes wrong.

931
00:27:31,826 --> 0:27:32,816
And you're going to you want to

932
00:27:32,816 --> 0:27:34,006
make sure that you construct

933
00:27:34,326 --> 0:27:35,856
your INMediaItem objects

934
00:27:35,856 --> 0:27:37,996
appropriately so Siri can speak

935
00:27:38,116 --> 0:27:39,716
the best dialogue possible.

936
00:27:40,786 --> 0:27:42,336
And finally, make sure you give

937
00:27:42,336 --> 0:27:44,506
Siri the important contextual

938
00:27:44,506 --> 0:27:46,736
information possible so Siri can

939
00:27:46,736 --> 0:27:48,516
make the best choices possible

940
00:27:49,136 --> 0:27:50,326
on your customer's behalf.

941
00:27:51,106 --> 0:27:54,686
So come see us at the labs and

942
00:27:54,686 --> 0:27:55,796
check out the documentation

943
00:27:55,796 --> 0:27:56,106
online.

944
00:27:56,916 --> 0:27:57,756
We think you're going to love

945
00:27:57,756 --> 0:27:59,206
building apps with the new

946
00:27:59,206 --> 0:28:00,906
SiriKit Media Intents and we

947
00:27:59,206 --> 0:28:00,906
SiriKit Media Intents and we

948
00:28:00,906 --> 0:28:01,916
can't wait to see what you'll

949
00:28:01,916 --> 0:28:02,166
build.

950
00:28:02,766 --> 0:28:03,076
Thank you.

951
00:28:04,516 --> 0:28:07,500
[ Applause ]
