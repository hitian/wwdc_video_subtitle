1
00:00:00,506 --> 0:00:05,500
[ Music ]

2
00:00:08,516 --> 0:00:11,546
[ Cheering and Applause ]

3
00:00:12,046 --> 0:00:12,376
&gt;&gt; Welcome.

4
00:00:15,496 --> 0:00:16,696
My name is Steve Breen, and I'm

5
00:00:16,696 --> 0:00:18,256
an engineer on the UIKit Team.

6
00:00:18,426 --> 0:00:19,586
And today, I'm joined by my

7
00:00:19,586 --> 0:00:21,186
colleagues, Troy Stevens from

8
00:00:21,186 --> 0:00:22,456
the AppKit team, and Jacob

9
00:00:22,456 --> 0:00:24,336
clapper from the App Store team.

10
00:00:25,366 --> 0:00:27,096
And today, we're going to talk a

11
00:00:27,216 --> 0:00:29,416
bit about UI data sources.

12
00:00:30,296 --> 0:00:30,986
[Chuckles] All right, so today's

13
00:00:30,986 --> 0:00:32,156
talk is going to be broken into

14
00:00:32,156 --> 0:00:33,006
four segments.

15
00:00:33,626 --> 0:00:34,656
First, I want to talk about the

16
00:00:34,656 --> 0:00:35,936
current state-of-the-art.

17
00:00:36,076 --> 0:00:37,346
How do we interact with data

18
00:00:37,346 --> 0:00:38,876
sources today in the shipping

19
00:00:38,876 --> 0:00:39,636
platforms?

20
00:00:40,636 --> 0:00:41,656
And then we're going to talk

21
00:00:41,656 --> 0:00:43,196
about a brand new approach we're

22
00:00:43,196 --> 0:00:45,566
bring into iOS, tvOS, and the

23
00:00:45,566 --> 0:00:45,856
Mac.

24
00:00:46,556 --> 0:00:48,156
Then we're going to transition

25
00:00:48,156 --> 0:00:50,146
to some demos, get some hands-on

26
00:00:50,146 --> 0:00:51,926
time with this brand new API.

27
00:00:52,646 --> 0:00:54,236
And then finally, we're going to

28
00:00:54,236 --> 0:00:55,466
go on some more detailed

29
00:00:55,466 --> 0:00:56,576
considerations of how to get the

30
00:00:56,706 --> 0:00:59,466
best out of this new API.

31
00:01:00,256 --> 0:01:01,246
All right, so let's talk a

32
00:01:01,246 --> 0:01:02,056
little bit about the current

33
00:01:02,056 --> 0:01:02,636
state-of-the-art.

34
00:01:02,636 --> 0:01:05,495
How do we interact with UI data

35
00:01:05,495 --> 0:01:07,206
sources today, in UITableView

36
00:01:07,206 --> 0:01:08,436
and CollectionViews?

37
00:01:09,836 --> 0:01:12,256
So here we see an example

38
00:01:12,256 --> 0:01:13,546
implementation of the

39
00:01:13,546 --> 0:01:15,046
UICollectionView data source.

40
00:01:15,926 --> 0:01:16,896
Now, if you've worked with

41
00:01:16,896 --> 0:01:18,456
UITableView or CollectionViews,

42
00:01:18,456 --> 0:01:19,346
you've seen this before.

43
00:01:19,966 --> 0:01:21,886
Here, we're providing three of

44
00:01:21,886 --> 0:01:24,006
the required two methods in this

45
00:01:24,006 --> 0:01:24,496
protocol.

46
00:01:24,496 --> 0:01:26,676
And it's pretty straightforward,

47
00:01:26,676 --> 0:01:26,836
right?

48
00:01:26,836 --> 0:01:28,466
We have asked about the number

49
00:01:28,466 --> 0:01:29,576
of sections and the number of

50
00:01:29,576 --> 0:01:30,886
items in each of those sections.

51
00:01:31,096 --> 0:01:32,676
And as content renders, we're

52
00:01:32,676 --> 0:01:33,796
going to ask for cells.

53
00:01:34,406 --> 0:01:34,976
Pretty straightforward.

54
00:01:37,056 --> 0:01:38,136
And this has served us really

55
00:01:38,136 --> 0:01:39,566
well for about ten years now,

56
00:01:39,796 --> 0:01:39,936
right?

57
00:01:40,146 --> 0:01:41,686
And it's got a couple things

58
00:01:41,686 --> 0:01:42,186
going for it.

59
00:01:42,186 --> 0:01:42,946
It's super simple.

60
00:01:43,356 --> 0:01:44,266
You can reason about it right

61
00:01:44,266 --> 0:01:44,486
away.

62
00:01:44,486 --> 0:01:46,296
If you want to provide just two

63
00:01:46,296 --> 0:01:48,446
methods, the number of items in

64
00:01:48,446 --> 0:01:49,126
a section, if you have a

65
00:01:49,176 --> 0:01:50,426
one-dimensional data source,

66
00:01:50,426 --> 0:01:51,606
that's pretty straightforward.

67
00:01:52,576 --> 0:01:53,626
And you can iterate on it pretty

68
00:01:53,626 --> 0:01:53,966
quickly.

69
00:01:54,566 --> 0:01:56,566
But it's also very flexible,

70
00:01:56,636 --> 0:01:56,886
right?

71
00:01:56,936 --> 0:01:58,516
Because you don't really have to

72
00:01:58,596 --> 0:02:00,586
use any particular kind of data

73
00:01:58,596 --> 0:02:00,586
use any particular kind of data

74
00:02:00,586 --> 0:02:02,396
structure to back your data

75
00:02:02,396 --> 0:02:02,896
source.

76
00:02:04,116 --> 0:02:05,276
It could be as simple as a

77
00:02:05,346 --> 0:02:06,386
one-dimensional array.

78
00:02:07,426 --> 0:02:08,826
And if you had a multi-itemed,

79
00:02:08,826 --> 0:02:10,906
multi-sectioned data source, it

80
00:02:10,906 --> 0:02:11,796
could be two-dimensional, right?

81
00:02:11,796 --> 0:02:12,256
Very simple, very

82
00:02:12,256 --> 0:02:12,946
straightforward.

83
00:02:15,606 --> 0:02:17,926
Well, apps are often a little

84
00:02:17,926 --> 0:02:19,146
more complicated than a, you

85
00:02:19,146 --> 0:02:19,936
know, a one-dimensional or

86
00:02:19,936 --> 0:02:20,706
two-dimensional array.

87
00:02:22,456 --> 0:02:23,446
And apps get more and more

88
00:02:23,446 --> 0:02:24,216
complex every year.

89
00:02:24,216 --> 0:02:25,166
They do more things.

90
00:02:25,166 --> 0:02:26,886
Our users demand more features.

91
00:02:26,886 --> 0:02:29,576
And oftentimes, these data

92
00:02:29,576 --> 0:02:31,316
sources are backed by complex

93
00:02:31,316 --> 0:02:32,746
controllers inside of our app.

94
00:02:33,686 --> 0:02:35,326
And these controllers can do a

95
00:02:35,326 --> 0:02:35,946
variety of things.

96
00:02:35,946 --> 0:02:36,876
They can interact with Core

97
00:02:36,876 --> 0:02:38,676
Data, and they could talk to web

98
00:02:38,676 --> 0:02:39,186
service.

99
00:02:39,186 --> 0:02:40,546
They just do a number of

100
00:02:40,546 --> 0:02:41,426
different things.

101
00:02:41,626 --> 0:02:43,486
And I want to visualize this

102
00:02:43,486 --> 0:02:43,916
real quick.

103
00:02:45,296 --> 0:02:46,906
And let's show a conversation

104
00:02:46,906 --> 0:02:49,166
between your UI layer and this

105
00:02:49,166 --> 0:02:50,166
controller layer that's doing

106
00:02:50,166 --> 0:02:51,576
all this heavy lifting to get

107
00:02:51,576 --> 0:02:52,516
your data.

108
00:02:52,516 --> 0:02:52,786
All right?

109
00:02:53,686 --> 0:02:54,906
And the conversation starts out

110
00:02:54,906 --> 0:02:55,576
very civil.

111
00:02:56,106 --> 0:02:56,846
It's like, "Hey, give me a

112
00:02:56,846 --> 0:02:57,946
number of items in a section, or

113
00:02:57,946 --> 0:02:59,456
give me a cell as we render

114
00:02:59,456 --> 0:03:00,046
content."

115
00:02:59,456 --> 0:03:00,046
content."

116
00:03:00,486 --> 0:03:01,456
Very straightforward.

117
00:03:01,526 --> 0:03:02,956
And so far, smooth sailing.

118
00:03:06,056 --> 0:03:07,276
But things get more complicated

119
00:03:07,276 --> 0:03:08,016
over time, right?

120
00:03:08,016 --> 0:03:09,076
You get -- like let's say this

121
00:03:09,076 --> 0:03:10,516
controller has a web service

122
00:03:10,516 --> 0:03:11,896
request that it gets a response

123
00:03:11,896 --> 0:03:12,366
from, right?

124
00:03:12,366 --> 0:03:14,196
It's like, oh, I've got data for

125
00:03:14,196 --> 0:03:15,776
your tweets or whatever, right?

126
00:03:16,396 --> 0:03:18,096
Well, now this controller layer,

127
00:03:18,196 --> 0:03:19,716
which is complex unto itself,

128
00:03:20,376 --> 0:03:21,926
lets the world know, "Hey, I

129
00:03:21,926 --> 0:03:22,416
changed.

130
00:03:22,416 --> 0:03:23,226
Something changed."

131
00:03:23,846 --> 0:03:25,546
All right, so here's where

132
00:03:25,546 --> 0:03:27,766
things get a bit more complex,

133
00:03:27,796 --> 0:03:27,996
right?

134
00:03:27,996 --> 0:03:31,066
So now, it's up to the UI layer

135
00:03:31,066 --> 0:03:33,486
to decide, "Hey, things changed.

136
00:03:33,486 --> 0:03:34,856
Now, I need to -- can change

137
00:03:34,856 --> 0:03:37,096
this into updates for our UI

138
00:03:37,486 --> 0:03:37,816
layer.

139
00:03:38,486 --> 0:03:40,086
And this involves all the

140
00:03:40,086 --> 0:03:41,426
mutations that have to occur

141
00:03:41,426 --> 0:03:42,256
against TableView and

142
00:03:42,256 --> 0:03:42,756
CollectionView.

143
00:03:42,756 --> 0:03:44,246
It can be a bit complex.

144
00:03:44,246 --> 0:03:46,076
And we covered this complexity

145
00:03:46,076 --> 0:03:48,236
last year in our talk Of Tour of

146
00:03:48,236 --> 0:03:49,086
UICollectionView.

147
00:03:49,946 --> 0:03:51,436
And how to construct those batch

148
00:03:51,436 --> 0:03:53,726
updates properly, and mutate

149
00:03:53,726 --> 0:03:54,636
your backing store, all those

150
00:03:54,636 --> 0:03:54,976
kinds of things.

151
00:03:57,586 --> 0:03:58,596
But sometimes, no matter how

152
00:03:58,596 --> 0:03:59,276
hard you try--

153
00:04:00,516 --> 0:04:02,626
[ Laughter ]

154
00:04:03,126 --> 0:04:04,226
You know, things go wrong.

155
00:04:04,606 --> 0:04:05,586
It's an imperfect world.

156
00:04:07,186 --> 0:04:08,746
And judging by the laughter,

157
00:04:08,886 --> 0:04:10,006
you've probably hit this before,

158
00:04:10,006 --> 0:04:10,246
right?

159
00:04:11,196 --> 0:04:12,336
It's not an uncommon thing.

160
00:04:12,336 --> 0:04:13,756
And it's really frustrating,

161
00:04:13,756 --> 0:04:13,936
right?

162
00:04:13,936 --> 0:04:14,726
You hit this, and you're like,

163
00:04:14,726 --> 0:04:14,996
"All right.

164
00:04:14,996 --> 0:04:15,656
What did I do wrong?"

165
00:04:16,356 --> 0:04:18,875
It's me. And as you dig through

166
00:04:18,875 --> 0:04:20,616
your code, okay, fine.

167
00:04:20,616 --> 0:04:21,716
You Google on Stack Overflow,

168
00:04:21,716 --> 0:04:22,886
see what's going on.

169
00:04:23,206 --> 0:04:25,146
And eventually, you might get

170
00:04:25,146 --> 0:04:26,006
frustrated and just call

171
00:04:26,006 --> 0:04:26,516
reloadData.

172
00:04:26,516 --> 0:04:27,806
And we talked about this last

173
00:04:27,806 --> 0:04:29,506
year, and that's fine.

174
00:04:29,706 --> 0:04:30,266
That's correct.

175
00:04:30,386 --> 0:04:31,616
Your app looks okay.

176
00:04:32,676 --> 0:04:33,736
But when you call reloadData,

177
00:04:33,736 --> 0:04:35,186
you get this non-animated

178
00:04:35,186 --> 0:04:35,616
effect.

179
00:04:36,306 --> 0:04:37,656
And it detracts from the user

180
00:04:37,656 --> 0:04:38,446
experience.

181
00:04:39,836 --> 0:04:41,356
So that's not great.

182
00:04:44,046 --> 0:04:44,506
Okay, I want to get

183
00:04:44,506 --> 0:04:45,816
philosophical just for one

184
00:04:45,816 --> 0:04:46,156
slide.

185
00:04:46,156 --> 0:04:46,896
I promise.

186
00:04:48,136 --> 0:04:48,716
What's the problem?

187
00:04:49,636 --> 0:04:51,786
Well, the problem here is

188
00:04:51,786 --> 0:04:52,456
where's our truth?

189
00:04:53,786 --> 0:04:55,386
You know? I mean, who got his?

190
00:04:55,386 --> 0:04:56,696
And who has all the answers?

191
00:04:57,806 --> 0:04:59,256
And the big issue here is that

192
00:04:59,256 --> 0:05:01,016
our data controller -- or it's

193
00:04:59,256 --> 0:05:01,016
our data controller -- or it's

194
00:05:01,016 --> 0:05:02,186
acting as a data source -- has

195
00:05:02,186 --> 0:05:03,356
its own version of the truth,

196
00:05:03,356 --> 0:05:04,466
which changes over time.

197
00:05:04,946 --> 0:05:06,736
And the UI has a version of the

198
00:05:06,736 --> 0:05:07,136
truth.

199
00:05:08,336 --> 0:05:09,866
And the UILayerCode is

200
00:05:09,866 --> 0:05:11,256
responsible for mitigating that,

201
00:05:11,256 --> 0:05:12,446
making sure that it's always in

202
00:05:12,446 --> 0:05:12,796
sync.

203
00:05:13,526 --> 0:05:15,476
As we saw, it's sometimes hard.

204
00:05:16,816 --> 0:05:18,576
So our current approach is error

205
00:05:18,576 --> 0:05:19,036
prone.

206
00:05:19,726 --> 0:05:20,626
And primarily because there's

207
00:05:20,626 --> 0:05:22,856
just no notion of a centralized

208
00:05:22,856 --> 0:05:22,976
truth.

209
00:05:26,626 --> 0:05:27,196
All right, so that's the

210
00:05:27,196 --> 0:05:27,766
state-of-the-art.

211
00:05:27,766 --> 0:05:28,476
That's where we are today.

212
00:05:28,476 --> 0:05:29,206
But where are we going?

213
00:05:30,546 --> 0:05:31,716
Well, I'm happy to announce that

214
00:05:31,716 --> 0:05:33,726
for iOS, TVoS, and MacOS this

215
00:05:33,726 --> 0:05:35,116
year, we're bringing a brand new

216
00:05:35,636 --> 0:05:36,326
approach.

217
00:05:37,106 --> 0:05:38,046
And we're calling this

218
00:05:38,496 --> 0:05:39,556
DiffableDataSource.

219
00:05:40,516 --> 0:05:44,546
[ Cheering and Applause ]

220
00:05:45,046 --> 0:05:45,576
All right, so let's dig in.

221
00:05:45,576 --> 0:05:45,976
What is this thing?

222
00:05:49,076 --> 0:05:50,126
No performBatchUpdates.

223
00:05:50,126 --> 0:05:50,576
Let's go on.

224
00:05:51,056 --> 0:05:52,356
And along with it, all the

225
00:05:52,356 --> 0:05:53,976
crashes, hassles, complexity,

226
00:05:53,976 --> 0:05:54,776
all of the stuff that you don't

227
00:05:54,776 --> 0:05:56,166
want to deal with, has been

228
00:05:56,166 --> 0:05:56,726
jettisoned.

229
00:05:57,806 --> 0:05:59,086
Instead, we have a single method

230
00:05:59,086 --> 0:05:59,986
we call Apply.

231
00:06:00,546 --> 0:06:01,196
What is Apply?

232
00:06:01,806 --> 0:06:03,176
Apply is simple, automatic,

233
00:06:03,176 --> 0:06:04,496
hassle-free diffing.

234
00:06:07,386 --> 0:06:09,136
So we do this with a brand new

235
00:06:09,136 --> 0:06:10,766
construct we call a Snapshot.

236
00:06:10,826 --> 0:06:12,156
And it's a very simple idea.

237
00:06:12,296 --> 0:06:13,846
It's effectively the truth of

238
00:06:13,846 --> 0:06:14,826
the current UI state.

239
00:06:15,536 --> 0:06:18,306
And instead of IndexPaths, it's

240
00:06:18,306 --> 0:06:20,076
an association or a collection

241
00:06:20,346 --> 0:06:21,816
of section identifiers that are

242
00:06:21,816 --> 0:06:24,066
all unique and item identifiers.

243
00:06:25,336 --> 0:06:26,766
And you update these not with

244
00:06:26,766 --> 0:06:28,736
IndexPaths, with identifiers.

245
00:06:29,486 --> 0:06:30,226
All right, let's look at

246
00:06:30,226 --> 0:06:32,086
something visual to see what's

247
00:06:32,086 --> 0:06:32,666
going on here.

248
00:06:34,156 --> 0:06:35,276
Okay, I'm really creative guy.

249
00:06:35,276 --> 0:06:37,146
So we've got these FOO, BAR, and

250
00:06:37,226 --> 0:06:38,256
BIF onscreen, right.

251
00:06:38,256 --> 0:06:38,936
And that's what we're

252
00:06:38,936 --> 0:06:39,486
interacting with.

253
00:06:39,486 --> 0:06:41,516
These are identifiers in our

254
00:06:41,516 --> 0:06:41,736
app.

255
00:06:43,146 --> 0:06:44,146
And let's say that our

256
00:06:44,146 --> 0:06:45,156
controller changed.

257
00:06:45,156 --> 0:06:46,546
And now we've got this brand new

258
00:06:46,606 --> 0:06:48,316
Snapshot that we want to apply.

259
00:06:49,116 --> 0:06:49,916
But this is our current

260
00:06:49,916 --> 0:06:50,316
Snapshot.

261
00:06:50,316 --> 0:06:52,676
How do we get from our new truth

262
00:06:53,686 --> 0:06:54,676
to the current Snapshot?

263
00:06:56,686 --> 0:06:57,916
Well, we can see here we've

264
00:06:57,916 --> 0:06:59,486
configured a brand new Snapshot

265
00:06:59,486 --> 0:07:01,496
with BAR, FOO, and BAZ.

266
00:06:59,486 --> 0:07:01,496
with BAR, FOO, and BAZ.

267
00:07:01,496 --> 0:07:02,656
And we have some items that are

268
00:07:02,656 --> 0:07:03,656
coming along for the ride that

269
00:07:03,656 --> 0:07:05,036
have just changed order, and

270
00:07:05,036 --> 0:07:06,796
then a new item coming in.

271
00:07:07,516 --> 0:07:10,136
So conceptually an Apply knows

272
00:07:10,136 --> 0:07:11,796
about the current state and

273
00:07:11,796 --> 0:07:12,996
knows about the new state, which

274
00:07:12,996 --> 0:07:14,566
are going to apply to the UI

275
00:07:14,566 --> 0:07:14,976
element.

276
00:07:17,356 --> 0:07:18,376
And there's no step two.

277
00:07:18,376 --> 0:07:19,096
That's just it.

278
00:07:19,096 --> 0:07:20,906
Mm-hmm. All right, so how do we

279
00:07:20,936 --> 0:07:21,336
do this?

280
00:07:21,336 --> 0:07:23,206
Well, we have four classes

281
00:07:23,376 --> 0:07:24,576
across all the platforms.

282
00:07:25,226 --> 0:07:26,836
For iOS and TVoS, we have

283
00:07:26,836 --> 0:07:27,686
UICollectionView

284
00:07:27,686 --> 0:07:29,456
DiffableDataSource and

285
00:07:29,456 --> 0:07:31,666
UITableView DiffableDataSource.

286
00:07:31,666 --> 0:07:33,256
And then on the Mac, we have

287
00:07:33,636 --> 0:07:34,306
NSCollectionView

288
00:07:34,306 --> 0:07:35,276
DiffableDataSource.

289
00:07:36,046 --> 0:07:37,696
And common for all the platforms

290
00:07:37,756 --> 0:07:39,796
is this Snapshot class, which is

291
00:07:39,796 --> 0:07:40,856
responsible for the current

292
00:07:40,856 --> 0:07:43,006
UIState NSDiffableData

293
00:07:43,006 --> 0:07:43,846
SourceSnapshot.

294
00:07:44,896 --> 0:07:46,456
Okay, so enough background.

295
00:07:46,456 --> 0:07:48,126
Let's go on, look at some code.

296
00:07:48,186 --> 0:07:49,376
And for that, I'm going to bring

297
00:07:49,376 --> 0:07:51,536
up my colleague, Troy Stevens.

298
00:07:51,766 --> 0:07:51,976
Troy?

299
00:07:52,266 --> 0:07:54,266
[ Applause ]

300
00:07:54,516 --> 0:07:55,456
&gt;&gt; Thanks very much, Steve.

301
00:07:56,116 --> 0:07:57,706
I am delighted to get to walk

302
00:07:57,706 --> 0:07:59,266
you all through some examples of

303
00:07:59,266 --> 0:08:00,746
using this powerful, yet

304
00:07:59,266 --> 0:08:00,746
using this powerful, yet

305
00:08:00,746 --> 0:08:02,446
beautifully simple new API

306
00:08:02,446 --> 0:08:02,956
today.

307
00:08:03,286 --> 0:08:04,526
So make sure to download the

308
00:08:04,526 --> 0:08:06,086
sample project for this talk if

309
00:08:06,086 --> 0:08:06,886
you haven't already.

310
00:08:07,336 --> 0:08:08,746
That way, you can follow along,

311
00:08:08,966 --> 0:08:10,116
study it at your leisure.

312
00:08:10,466 --> 0:08:12,616
And most importantly, use that

313
00:08:12,616 --> 0:08:14,946
example to really grasp the

314
00:08:14,946 --> 0:08:16,216
mechanics of how all of this

315
00:08:16,216 --> 0:08:16,616
works.

316
00:08:16,776 --> 0:08:17,776
It's not a lot of code.

317
00:08:18,066 --> 0:08:19,186
It's really simple.

318
00:08:19,556 --> 0:08:20,956
Now, when you look at that

319
00:08:20,956 --> 0:08:22,076
example project, you're going to

320
00:08:22,076 --> 0:08:23,416
notice that in addition to the

321
00:08:23,416 --> 0:08:24,796
three examples of

322
00:08:24,846 --> 0:08:26,336
DiffableDataSource usage that

323
00:08:26,336 --> 0:08:27,406
we're going to look at today,

324
00:08:27,926 --> 0:08:29,816
the same project also contains

325
00:08:29,816 --> 0:08:31,266
illustrations of the powerful,

326
00:08:31,266 --> 0:08:32,645
new compositional layout API

327
00:08:32,645 --> 0:08:34,596
that we introduced in Session

328
00:08:34,596 --> 0:08:35,645
215.

329
00:08:36,046 --> 0:08:37,626
Those examples just happened to

330
00:08:37,626 --> 0:08:39,905
use DiffableDataSource as a

331
00:08:40,006 --> 0:08:41,905
really easy way to just populate

332
00:08:41,905 --> 0:08:42,936
their CollectionViews with

333
00:08:42,936 --> 0:08:43,746
sample content.

334
00:08:44,256 --> 0:08:45,636
So let's go to our demo machines

335
00:08:45,636 --> 0:08:45,976
and take a look.

336
00:08:49,416 --> 0:08:50,746
So I've got our demo app up

337
00:08:50,746 --> 0:08:51,116
here.

338
00:08:51,496 --> 0:08:52,926
And as we walk through our

339
00:08:52,926 --> 0:08:54,496
different examples today, we're

340
00:08:54,776 --> 0:08:56,216
going to notice a repeating

341
00:08:56,216 --> 0:08:56,566
pattern.

342
00:08:56,566 --> 0:08:57,956
It's a simple three-step

343
00:08:57,956 --> 0:08:58,676
process.

344
00:08:59,186 --> 0:09:00,986
So anytime you want to put a new

345
00:08:59,186 --> 0:09:00,986
So anytime you want to put a new

346
00:09:00,986 --> 0:09:02,186
set of changes, a new set of

347
00:09:02,186 --> 0:09:04,296
data into a Collection View or

348
00:09:04,296 --> 0:09:05,776
UITableView with the full data

349
00:09:05,776 --> 0:09:07,976
source, all you do is you create

350
00:09:07,976 --> 0:09:08,676
a Snapshot.

351
00:09:09,306 --> 0:09:10,846
You populate that Snapshot with

352
00:09:10,846 --> 0:09:12,296
the description of the items you

353
00:09:12,296 --> 0:09:13,476
want to display in that update

354
00:09:13,476 --> 0:09:13,856
cycle.

355
00:09:13,906 --> 0:09:15,756
And then you apply the Snapshot

356
00:09:16,116 --> 0:09:17,376
to automatically commit the

357
00:09:17,376 --> 0:09:19,356
changes to your UI.

358
00:09:19,356 --> 0:09:20,786
DiffableDataSource takes care of

359
00:09:20,786 --> 0:09:22,386
all the diffing and issuing the

360
00:09:22,386 --> 0:09:23,556
changes to the UI element.

361
00:09:24,426 --> 0:09:25,466
So let's look at a concrete

362
00:09:25,466 --> 0:09:25,946
example.

363
00:09:25,946 --> 0:09:27,376
I'm going to open up Mountain

364
00:09:27,376 --> 0:09:27,946
Search.

365
00:09:29,046 --> 0:09:30,526
And this is a fairly typical

366
00:09:30,526 --> 0:09:31,236
search UI, right?

367
00:09:31,236 --> 0:09:33,086
We can all look at it and reason

368
00:09:33,086 --> 0:09:33,966
about what it does.

369
00:09:34,216 --> 0:09:35,826
You might see this in a Contacts

370
00:09:35,826 --> 0:09:37,006
app, for example, but in this

371
00:09:37,006 --> 0:09:38,736
case, we're looking at mountain

372
00:09:38,736 --> 0:09:39,776
peaks around the world.

373
00:09:40,626 --> 0:09:42,666
So as you can imagine, there's a

374
00:09:42,666 --> 0:09:43,626
search field at the top.

375
00:09:43,626 --> 0:09:45,046
As I start typing in that search

376
00:09:45,046 --> 0:09:46,666
field, we would expect to see

377
00:09:46,666 --> 0:09:48,556
the list automatically filtered

378
00:09:48,556 --> 0:09:49,606
to just the matches.

379
00:09:49,676 --> 0:09:51,426
And we'll see that if I start

380
00:09:51,426 --> 0:09:54,176
typing, we can do just that.

381
00:09:54,506 --> 0:09:55,456
And it all happens very

382
00:09:55,456 --> 0:09:57,456
automatically and with nice

383
00:09:57,546 --> 0:09:58,356
animations.

384
00:09:59,656 --> 0:10:01,626
This is all incredibly easy to

385
00:09:59,656 --> 0:10:01,626
This is all incredibly easy to

386
00:10:01,626 --> 0:10:03,896
do with extraordinarily little

387
00:10:03,976 --> 0:10:05,336
code using DiffableDataSource.

388
00:10:05,336 --> 0:10:06,306
So let's take a look at how it

389
00:10:06,306 --> 0:10:06,696
works.

390
00:10:08,336 --> 0:10:09,976
For this example, look at the

391
00:10:09,976 --> 0:10:11,456
MountainsView ControllerSource

392
00:10:11,456 --> 0:10:11,746
file.

393
00:10:13,486 --> 0:10:15,386
And all the action starts when

394
00:10:15,386 --> 0:10:16,586
the user types in the search

395
00:10:16,586 --> 0:10:17,136
bar, right?

396
00:10:17,936 --> 0:10:19,256
So we have our callback here,

397
00:10:19,256 --> 0:10:20,876
searchBarTextDidChange.

398
00:10:20,876 --> 0:10:22,276
It's going to be sent to our

399
00:10:22,276 --> 0:10:22,826
controller.

400
00:10:24,316 --> 0:10:25,796
And from there, we just call out

401
00:10:25,836 --> 0:10:27,556
to our own performQuery function

402
00:10:27,736 --> 0:10:29,466
passing it, the search text that

403
00:10:29,466 --> 0:10:30,926
we got from that search bar.

404
00:10:31,306 --> 0:10:33,096
Now performQuery itself is

405
00:10:33,096 --> 0:10:34,116
remarkably simple.

406
00:10:34,676 --> 0:10:37,236
All we do is call out to our

407
00:10:37,236 --> 0:10:38,106
MountainsController.

408
00:10:38,106 --> 0:10:39,566
That's our model layer object.

409
00:10:40,186 --> 0:10:42,106
And we ask it for a filtered

410
00:10:42,106 --> 0:10:44,266
sorted list of the mountains

411
00:10:44,266 --> 0:10:45,636
that match our search term.

412
00:10:46,356 --> 0:10:47,566
So now we've got that list of

413
00:10:47,566 --> 0:10:48,126
mountains.

414
00:10:49,616 --> 0:10:51,046
We go through that three-step

415
00:10:51,046 --> 0:10:52,156
process that I mentioned.

416
00:10:52,196 --> 0:10:54,546
We create a new NSDiffableData

417
00:10:54,546 --> 0:10:55,536
SourceSnapshot.

418
00:10:56,476 --> 0:10:58,266
Now this Snapshot is initially

419
00:10:58,266 --> 0:10:58,556
empty.

420
00:10:58,556 --> 0:10:59,456
It contains nothing.

421
00:10:59,456 --> 0:11:01,136
So it's up to us to populate it

422
00:10:59,456 --> 0:11:01,136
So it's up to us to populate it

423
00:11:01,136 --> 0:11:02,766
with the sections and items that

424
00:11:02,766 --> 0:11:03,466
we want.

425
00:11:04,296 --> 0:11:05,246
In this case, we only have a

426
00:11:05,246 --> 0:11:06,646
single section to display.

427
00:11:07,216 --> 0:11:08,436
So we're just going to append

428
00:11:08,716 --> 0:11:09,896
one section, and we're just

429
00:11:09,896 --> 0:11:11,376
going to arbitrarily call it the

430
00:11:11,376 --> 0:11:11,976
main section.

431
00:11:14,336 --> 0:11:17,356
Next, we append the identifiers

432
00:11:17,356 --> 0:11:18,796
of the items that we want to

433
00:11:18,796 --> 0:11:20,386
display in this update.

434
00:11:21,156 --> 0:11:22,376
Now formally speaking, we

435
00:11:22,376 --> 0:11:23,446
usually pass an array of

436
00:11:23,446 --> 0:11:24,386
identifiers here.

437
00:11:24,896 --> 0:11:27,126
But in Swift, you can also make

438
00:11:27,126 --> 0:11:29,196
things a lot more elegant by

439
00:11:29,366 --> 0:11:31,036
working with your own native

440
00:11:31,036 --> 0:11:31,646
types here.

441
00:11:31,646 --> 0:11:32,916
So if you have a native type,

442
00:11:32,916 --> 0:11:34,456
and it can even be a value type,

443
00:11:34,456 --> 0:11:36,486
such as a struct or an enum, if

444
00:11:36,796 --> 0:11:38,396
you make that type hashable,

445
00:11:38,506 --> 0:11:39,756
then you can just pass your own

446
00:11:39,756 --> 0:11:41,076
native objects in terms of the

447
00:11:41,076 --> 0:11:42,226
Swift syntax of what you're

448
00:11:42,226 --> 0:11:42,716
doing.

449
00:11:42,716 --> 0:11:43,796
And we'll look at the

450
00:11:43,796 --> 0:11:45,106
implications of how that works

451
00:11:45,106 --> 0:11:46,166
in just a little bit.

452
00:11:46,526 --> 0:11:47,766
So now, we've constructed our

453
00:11:47,766 --> 0:11:48,286
Snapshot.

454
00:11:48,286 --> 0:11:49,036
It's ready to go.

455
00:11:49,796 --> 0:11:51,876
All we have to do is call to our

456
00:11:51,876 --> 0:11:53,126
DiffableDataSource, ask it to

457
00:11:53,126 --> 0:11:54,766
please apply that Snapshot,

458
00:11:55,196 --> 0:11:56,196
animating the differences.

459
00:11:56,196 --> 0:11:57,776
DiffableDataSource goes off and

460
00:11:57,776 --> 0:11:59,606
automatically figures out what's

461
00:11:59,606 --> 0:12:00,906
changed between the previous

462
00:11:59,606 --> 0:12:00,906
changed between the previous

463
00:12:00,906 --> 0:12:01,866
update and the next.

464
00:12:02,276 --> 0:12:03,496
Notice that there's no code at

465
00:12:03,496 --> 0:12:05,296
all here, where we had to stop

466
00:12:05,296 --> 0:12:07,186
and figure out -- reason about

467
00:12:07,186 --> 0:12:08,286
what we were displaying in the

468
00:12:08,286 --> 0:12:09,786
previous update cycle before the

469
00:12:09,786 --> 0:12:10,306
user type.

470
00:12:10,346 --> 0:12:12,206
That one more character, it all

471
00:12:12,206 --> 0:12:13,176
happens automatically.

472
00:12:13,176 --> 0:12:14,226
There's nothing to worry about.

473
00:12:14,226 --> 0:12:14,926
We're not dealing with

474
00:12:14,926 --> 0:12:16,976
IndexPaths, which are fragile

475
00:12:16,976 --> 0:12:18,046
and ephemeral, right?

476
00:12:18,086 --> 0:12:19,426
They refer to a certain

477
00:12:19,616 --> 0:12:20,856
particular update, and have a

478
00:12:20,856 --> 0:12:21,536
different meaning and a

479
00:12:21,536 --> 0:12:22,306
different update.

480
00:12:22,716 --> 0:12:24,166
We're dealing with identifiers

481
00:12:24,166 --> 0:12:26,446
that are robust and enduring.

482
00:12:26,566 --> 0:12:28,456
So everything is just really

483
00:12:28,456 --> 0:12:29,236
simple to do here.

484
00:12:30,636 --> 0:12:31,686
Before we leave this bit of

485
00:12:31,686 --> 0:12:32,726
code, I want you to notice

486
00:12:32,726 --> 0:12:34,376
something about Snapshot, which

487
00:12:34,376 --> 0:12:35,326
you may have already noticed.

488
00:12:35,326 --> 0:12:37,816
It is a generic class in Swift,

489
00:12:37,816 --> 0:12:39,916
so it's parameterized by the

490
00:12:39,916 --> 0:12:42,126
SectionIdentifierType and the

491
00:12:42,126 --> 0:12:43,846
ItemIdentifierType that we've

492
00:12:43,846 --> 0:12:44,696
decided to use.

493
00:12:45,246 --> 0:12:46,536
So let's look first at our

494
00:12:46,536 --> 0:12:48,226
SectionIdentifierType, which is

495
00:12:48,226 --> 0:12:48,816
pretty trivial.

496
00:12:48,816 --> 0:12:50,146
This is a really handy technique

497
00:12:50,576 --> 0:12:51,906
for the common case, where you

498
00:12:51,906 --> 0:12:52,906
just have a single section,

499
00:12:52,906 --> 0:12:53,136
right?

500
00:12:53,436 --> 0:12:54,936
You can just declare an enum

501
00:12:54,936 --> 0:12:55,606
type for this.

502
00:12:56,166 --> 0:12:57,436
And one nice thing about enums

503
00:12:57,436 --> 0:12:58,376
in Swift is that they're

504
00:12:58,446 --> 0:12:59,796
automatically hashable.

505
00:12:59,796 --> 0:13:01,376
Hashability is synthesized for

506
00:12:59,796 --> 0:13:01,376
Hashability is synthesized for

507
00:13:01,376 --> 0:13:01,536
them.

508
00:13:01,976 --> 0:13:03,246
So here, we just have a trivial

509
00:13:03,246 --> 0:13:05,196
case of an enum with one case,

510
00:13:05,196 --> 0:13:05,886
and there's nothing more to do

511
00:13:05,886 --> 0:13:05,976
there.

512
00:13:09,046 --> 0:13:10,076
For our mountain type, we'll

513
00:13:10,076 --> 0:13:10,866
look at our Mountains

514
00:13:10,866 --> 0:13:13,566
Controller, which is again, our

515
00:13:13,566 --> 0:13:14,276
model layer.

516
00:13:14,866 --> 0:13:16,586
And here, we see that we've

517
00:13:16,586 --> 0:13:18,176
declared mountain as a Swift

518
00:13:18,176 --> 0:13:18,746
struct.

519
00:13:19,296 --> 0:13:21,066
And we declared that struct type

520
00:13:21,066 --> 0:13:23,076
as hashable so that we can use

521
00:13:23,076 --> 0:13:24,186
it with DiffableDataSource

522
00:13:24,186 --> 0:13:25,586
natively rather than explicitly

523
00:13:25,586 --> 0:13:26,966
have to pass an identifier.

524
00:13:27,356 --> 0:13:28,816
And the important requirement

525
00:13:28,816 --> 0:13:31,186
there is just that each mountain

526
00:13:31,246 --> 0:13:32,906
be uniquely identifiable by its

527
00:13:32,906 --> 0:13:33,516
hash value.

528
00:13:34,086 --> 0:13:36,866
So we achieve this by giving

529
00:13:36,866 --> 0:13:38,726
each mountain an automatically

530
00:13:38,726 --> 0:13:40,786
generated unique identifier.

531
00:13:43,016 --> 0:13:44,366
And here, where we implement

532
00:13:44,366 --> 0:13:45,966
that hashability conformance

533
00:13:45,966 --> 0:13:48,606
that we promised, we use just

534
00:13:48,606 --> 0:13:50,916
that identifier to provide the

535
00:13:50,916 --> 0:13:51,666
hash value.

536
00:13:52,246 --> 0:13:53,156
So in this way, we're going to

537
00:13:53,156 --> 0:13:54,496
have each mountain, even though

538
00:13:54,636 --> 0:13:55,866
mountains, again, are value

539
00:13:55,866 --> 0:13:56,206
types.

540
00:13:56,206 --> 0:13:57,476
They just get passed around by

541
00:13:57,476 --> 0:13:58,096
copying.

542
00:13:58,356 --> 0:13:59,316
There's no pointer you can

543
00:13:59,316 --> 0:13:59,746
reference.

544
00:14:00,026 --> 0:14:01,766
But the identifier and the hash

545
00:14:01,766 --> 0:14:02,886
value specifically of that

546
00:14:02,886 --> 0:14:04,716
identifier makes them unique

547
00:14:04,716 --> 0:14:06,056
enough for DiffableDataSource to

548
00:14:06,056 --> 0:14:07,376
track them from what -- one

549
00:14:07,376 --> 0:14:08,296
update to the next.

550
00:14:08,506 --> 0:14:09,926
And as part of hashability,

551
00:14:09,926 --> 0:14:11,486
we're implementing equality

552
00:14:11,486 --> 0:14:12,466
tests here, too.

553
00:14:12,946 --> 0:14:14,826
So we've looked at how you issue

554
00:14:14,826 --> 0:14:16,216
changes to DiffableDataSource.

555
00:14:16,216 --> 0:14:17,566
What about how we set one up to

556
00:14:17,566 --> 0:14:18,056
use?

557
00:14:19,146 --> 0:14:20,166
Let's go back to our

558
00:14:20,166 --> 0:14:21,176
MountainsViewController.

559
00:14:23,936 --> 0:14:25,636
And conveniently enough, we've

560
00:14:25,636 --> 0:14:26,766
created a function called

561
00:14:26,906 --> 0:14:28,066
ConfigureDataSource, where we

562
00:14:28,066 --> 0:14:29,376
configure our data source.

563
00:14:29,726 --> 0:14:30,806
And it's really just a little

564
00:14:30,806 --> 0:14:31,516
bit of code here.

565
00:14:33,106 --> 0:14:34,146
So in this case, we're working

566
00:14:34,146 --> 0:14:35,666
with a UICollectionView.

567
00:14:35,666 --> 0:14:36,666
So we instantiate a

568
00:14:36,666 --> 0:14:37,876
UICollectionView

569
00:14:37,876 --> 0:14:38,966
DiffableDataSource.

570
00:14:39,446 --> 0:14:41,886
We parameterize it with our

571
00:14:41,886 --> 0:14:43,696
section and item types.

572
00:14:44,656 --> 0:14:45,866
Pass it a pointer to the

573
00:14:45,866 --> 0:14:46,886
CollectionView that we want to

574
00:14:46,886 --> 0:14:47,286
work with.

575
00:14:47,956 --> 0:14:49,236
Now DiffableDataSource will take

576
00:14:49,236 --> 0:14:50,546
that pointer and automatically

577
00:14:50,546 --> 0:14:52,586
wire itself up as the data

578
00:14:52,586 --> 0:14:53,746
source of that CollectionView.

579
00:14:53,746 --> 0:14:54,766
So there's nothing else for us

580
00:14:54,766 --> 0:14:54,906
to do.

581
00:14:57,406 --> 0:14:59,226
Lastly, we have this trailing

582
00:14:59,226 --> 0:15:00,586
closure parameter, the

583
00:14:59,226 --> 0:15:00,586
closure parameter, the

584
00:15:00,586 --> 0:15:01,526
DiffableDataSource to the

585
00:15:01,526 --> 0:15:02,226
initializer.

586
00:15:02,746 --> 0:15:04,366
And all this is, is the code

587
00:15:04,366 --> 0:15:05,406
that you would normally have to

588
00:15:05,406 --> 0:15:06,256
write if you were implementing

589
00:15:06,256 --> 0:15:07,726
your own data source from

590
00:15:07,726 --> 0:15:09,396
scratch, you would implement the

591
00:15:09,396 --> 0:15:11,766
cellForItemAt IndexPath method.

592
00:15:12,156 --> 0:15:13,896
That's data source callback

593
00:15:13,896 --> 0:15:15,426
method, where you're expected to

594
00:15:15,426 --> 0:15:16,806
do exactly what we do here.

595
00:15:17,236 --> 0:15:18,946
We call back to our

596
00:15:18,946 --> 0:15:22,226
CollectionView and ask it for a

597
00:15:22,226 --> 0:15:24,246
cell of the appropriate type to

598
00:15:24,246 --> 0:15:25,766
display the data we want to.

599
00:15:25,766 --> 0:15:28,296
And we populate that cell with

600
00:15:28,296 --> 0:15:29,276
what we want to show, and then

601
00:15:29,276 --> 0:15:30,386
we return it back.

602
00:15:30,526 --> 0:15:31,786
So this is just taking that

603
00:15:31,786 --> 0:15:34,116
cellForItemAt IndexPath code and

604
00:15:34,256 --> 0:15:35,526
conveniently transplanting it

605
00:15:35,526 --> 0:15:36,906
into a nice closure

606
00:15:36,906 --> 0:15:38,646
encapsulation that we pass when

607
00:15:38,646 --> 0:15:40,046
we instantiate the data source.

608
00:15:40,726 --> 0:15:41,766
One thing that's nice and

609
00:15:41,766 --> 0:15:42,786
convenient and different here is

610
00:15:42,786 --> 0:15:44,346
that in addition to being given

611
00:15:44,346 --> 0:15:46,186
the IndexPath of the item that

612
00:15:46,186 --> 0:15:47,866
we're being asked for, we're

613
00:15:47,866 --> 0:15:49,846
also given its identifier, or in

614
00:15:49,846 --> 0:15:52,486
this case, the native Swift

615
00:15:52,546 --> 0:15:54,376
value type that we -- that

616
00:15:54,536 --> 0:15:55,686
corresponds to that particular

617
00:15:55,686 --> 0:15:56,566
item we want to show.

618
00:15:57,506 --> 0:15:59,636
So we get our mountain passed

619
00:15:59,636 --> 0:16:00,746
in, there's no more work to do.

620
00:15:59,636 --> 0:16:00,746
in, there's no more work to do.

621
00:16:00,746 --> 0:16:02,086
We don't have to go take that

622
00:16:02,086 --> 0:16:04,326
IndexPath and go look up which

623
00:16:04,326 --> 0:16:06,306
of our model layer objects it

624
00:16:06,436 --> 0:16:07,146
pertains to.

625
00:16:07,456 --> 0:16:08,696
We just have our mountain passed

626
00:16:08,846 --> 0:16:09,436
in for us.

627
00:16:09,436 --> 0:16:10,756
So we just can get the name of

628
00:16:10,756 --> 0:16:13,096
the mountain and set it as the

629
00:16:13,096 --> 0:16:14,676
label text of that cell.

630
00:16:15,676 --> 0:16:17,096
And that's all there is to it.

631
00:16:17,416 --> 0:16:18,916
Everything else about how you

632
00:16:18,916 --> 0:16:20,196
set up and configure your

633
00:16:20,196 --> 0:16:22,006
Collection View is the same as

634
00:16:22,066 --> 0:16:22,636
before.

635
00:16:22,906 --> 0:16:24,666
There's no performBatchUpdates

636
00:16:24,666 --> 0:16:25,826
code hiding anywhere in this

637
00:16:25,826 --> 0:16:26,556
sample code.

638
00:16:26,966 --> 0:16:27,916
That's all there is to it.

639
00:16:27,916 --> 0:16:28,996
It's very easy.

640
00:16:29,196 --> 0:16:29,976
Let's look at another example.

641
00:16:34,066 --> 0:16:36,536
So here, we have a mockup of the

642
00:16:36,536 --> 0:16:39,116
familiar Wi-Fi Settings UI from

643
00:16:39,116 --> 0:16:39,526
iOS.

644
00:16:39,526 --> 0:16:41,266
And this one's only going to be

645
00:16:41,266 --> 0:16:42,626
slightly more complicated than

646
00:16:42,626 --> 0:16:43,936
the last because we have two

647
00:16:43,936 --> 0:16:45,176
different sections that we're

648
00:16:45,176 --> 0:16:46,006
working with here.

649
00:16:46,396 --> 0:16:47,906
We have what we call the Config

650
00:16:47,906 --> 0:16:49,466
section at the top, where we

651
00:16:49,466 --> 0:16:51,216
have the Wi-Fi enable/disable

652
00:16:51,216 --> 0:16:51,686
switch.

653
00:16:52,056 --> 0:16:53,966
And the display of the current

654
00:16:53,966 --> 0:16:55,646
network that we're connected to.

655
00:16:55,816 --> 0:16:57,286
And then below that, we have

656
00:16:57,286 --> 0:16:58,136
another section that's

657
00:16:58,136 --> 0:17:00,386
dynamically updating that shows

658
00:16:58,136 --> 0:17:00,386
dynamically updating that shows

659
00:17:00,386 --> 0:17:02,446
us a list of detected networks

660
00:17:02,476 --> 0:17:03,386
that we could potentially

661
00:17:03,386 --> 0:17:03,986
connect to.

662
00:17:05,205 --> 0:17:06,386
And another thing to notice

663
00:17:06,386 --> 0:17:07,626
here, if we tap the Wi-Fi

664
00:17:07,626 --> 0:17:10,286
disabled switch, or toggle it

665
00:17:10,286 --> 0:17:11,646
back on, we get a nice,

666
00:17:12,556 --> 0:17:15,546
animated, collapse or reexpand

667
00:17:15,546 --> 0:17:16,136
of our UI.

668
00:17:16,136 --> 0:17:17,846
And that all comes for free with

669
00:17:17,846 --> 0:17:18,826
DiffableDataSource.

670
00:17:18,965 --> 0:17:20,746
So let's take a look at how this

671
00:17:20,746 --> 0:17:22,356
dynamic UI is implemented.

672
00:17:23,626 --> 0:17:24,205
Going to our

673
00:17:24,205 --> 0:17:25,906
WiFiSettingsViewController,

674
00:17:28,036 --> 0:17:29,876
we're going to look at the

675
00:17:29,876 --> 0:17:31,186
updateUI function, which is just

676
00:17:31,186 --> 0:17:32,586
a function we've named updateUI.

677
00:17:32,586 --> 0:17:34,046
And we've taken care to make

678
00:17:34,046 --> 0:17:35,286
sure that this gets called

679
00:17:35,626 --> 0:17:37,596
anytime there's a change in what

680
00:17:37,596 --> 0:17:38,486
we need to display.

681
00:17:38,936 --> 0:17:39,896
Now most of the time, that might

682
00:17:39,896 --> 0:17:41,436
be because we've detected a

683
00:17:41,436 --> 0:17:42,576
different set of networks that's

684
00:17:42,576 --> 0:17:43,186
now available.

685
00:17:43,186 --> 0:17:44,406
But it could also be because the

686
00:17:44,406 --> 0:17:46,056
user has toggled that Wi-Fi

687
00:17:46,056 --> 0:17:47,096
enable/disable button.

688
00:17:47,366 --> 0:17:48,566
Anything that changes our UI,

689
00:17:48,566 --> 0:17:49,936
we've ensured that this will be

690
00:17:49,936 --> 0:17:50,386
called.

691
00:17:51,786 --> 0:17:53,456
So we still have here that same

692
00:17:53,456 --> 0:17:54,806
three-step process.

693
00:17:55,316 --> 0:17:57,266
After getting the data that we

694
00:17:57,266 --> 0:17:58,776
want to display, we start with

695
00:17:58,776 --> 0:18:00,106
just getting those config items,

696
00:17:58,776 --> 0:18:00,106
just getting those config items,

697
00:18:00,106 --> 0:18:01,006
because we're usually going to

698
00:18:01,006 --> 0:18:01,606
want those.

699
00:18:02,206 --> 0:18:03,536
We go ahead and create a

700
00:18:03,536 --> 0:18:04,146
Snapshot.

701
00:18:04,736 --> 0:18:05,876
And this Snapshot again is

702
00:18:05,876 --> 0:18:06,726
initially empty.

703
00:18:06,726 --> 0:18:07,566
So let's populate it with what

704
00:18:07,566 --> 0:18:07,976
we want to show.

705
00:18:10,776 --> 0:18:12,366
We append the first section, our

706
00:18:12,366 --> 0:18:13,626
config section, that appears at

707
00:18:13,626 --> 0:18:14,016
the top.

708
00:18:15,046 --> 0:18:16,386
And we append its items.

709
00:18:16,386 --> 0:18:17,286
So there's going to be one or

710
00:18:17,286 --> 0:18:18,376
two items depending whether

711
00:18:18,376 --> 0:18:19,326
Wi-Fi is enabled.

712
00:18:21,476 --> 0:18:23,076
Now if Wi-Fi is enabled, we also

713
00:18:23,076 --> 0:18:25,026
want to talk to our backend, to

714
00:18:25,026 --> 0:18:25,716
our model layer.

715
00:18:25,716 --> 0:18:27,316
Ask it for lists, the current

716
00:18:27,316 --> 0:18:28,836
list of available networks.

717
00:18:29,396 --> 0:18:31,806
And we're going to wrap that

718
00:18:31,806 --> 0:18:34,226
list in some item types that

719
00:18:34,226 --> 0:18:35,546
we're going to look at in just a

720
00:18:35,546 --> 0:18:35,946
moment.

721
00:18:38,256 --> 0:18:39,916
We append this section for that

722
00:18:39,916 --> 0:18:40,886
list of networks.

723
00:18:41,316 --> 0:18:43,326
And then we're going to append

724
00:18:43,326 --> 0:18:44,456
the items that go in that

725
00:18:44,456 --> 0:18:44,876
section.

726
00:18:45,396 --> 0:18:46,246
And notice that because we're

727
00:18:46,246 --> 0:18:47,296
working with two different

728
00:18:47,396 --> 0:18:49,266
sections here, we can be

729
00:18:49,266 --> 0:18:50,866
explicit about which section

730
00:18:51,026 --> 0:18:51,916
were appending each set of items

731
00:18:51,916 --> 0:18:51,983
to.

732
00:18:55,056 --> 0:18:55,746
That's it.

733
00:18:55,746 --> 0:18:56,316
We're ready to go.

734
00:18:56,316 --> 0:18:57,346
We've described everything we

735
00:18:57,346 --> 0:18:58,086
want to display.

736
00:18:58,336 --> 0:18:59,266
So we just ask our

737
00:18:59,266 --> 0:19:00,756
DiffableDataSource to apply

738
00:18:59,266 --> 0:19:00,756
DiffableDataSource to apply

739
00:19:00,756 --> 0:19:02,636
those changes, optionally

740
00:19:02,666 --> 0:19:03,796
animating the differences.

741
00:19:04,236 --> 0:19:05,596
Now there may be times where you

742
00:19:05,596 --> 0:19:06,816
want to choose not to animate

743
00:19:06,816 --> 0:19:07,386
the differences.

744
00:19:07,386 --> 0:19:08,626
For example, when you're first

745
00:19:08,626 --> 0:19:09,776
bringing up your UI, and you're

746
00:19:09,776 --> 0:19:11,306
showing the initial set of data,

747
00:19:11,626 --> 0:19:12,596
you might or might not want it

748
00:19:12,596 --> 0:19:13,116
to animate.

749
00:19:13,396 --> 0:19:14,416
Oftentimes, you want it to be

750
00:19:14,416 --> 0:19:15,306
instantaneous.

751
00:19:15,536 --> 0:19:16,506
So you'll pass false for

752
00:19:16,636 --> 0:19:17,516
animating differences, as we do

753
00:19:17,516 --> 0:19:17,976
in this example.

754
00:19:22,436 --> 0:19:23,826
Looking at our types that we're

755
00:19:23,826 --> 0:19:24,596
working with here, we've got a

756
00:19:24,596 --> 0:19:26,166
section type and then item type

757
00:19:26,166 --> 0:19:27,466
that parameterize the

758
00:19:27,466 --> 0:19:28,426
DiffableDataSource.

759
00:19:29,226 --> 0:19:30,606
Looking back at the top, we can

760
00:19:30,606 --> 0:19:31,646
see, as we might imagine, that

761
00:19:31,646 --> 0:19:33,066
section is still an enum type.

762
00:19:33,066 --> 0:19:34,286
We just need two different

763
00:19:34,286 --> 0:19:35,666
sections to work with here.

764
00:19:37,106 --> 0:19:39,586
And again, section as enum type

765
00:19:39,586 --> 0:19:40,836
is automatically hashable in

766
00:19:40,836 --> 0:19:41,886
Swift, so we're good to go with

767
00:19:41,886 --> 0:19:41,976
that.

768
00:19:44,206 --> 0:19:45,316
And then here we've declared an

769
00:19:45,316 --> 0:19:45,796
item type.

770
00:19:45,866 --> 0:19:47,306
This is a struct type again, as

771
00:19:47,306 --> 0:19:47,966
with the mountains.

772
00:19:48,296 --> 0:19:49,496
And we've declared it as

773
00:19:49,496 --> 0:19:50,046
hashable.

774
00:19:50,756 --> 0:19:52,226
And the reason for declaring

775
00:19:52,226 --> 0:19:53,536
this type is that when we look

776
00:19:53,536 --> 0:19:55,416
at our list, it mostly contains

777
00:19:55,416 --> 0:19:57,736
lists -- network items in it.

778
00:19:57,736 --> 0:19:58,766
But in addition to that, it's

779
00:19:58,766 --> 0:20:00,026
got this oddball item at the

780
00:19:58,766 --> 0:20:00,026
got this oddball item at the

781
00:20:00,026 --> 0:20:00,406
top.

782
00:20:00,406 --> 0:20:01,836
It's the Wi-Fi enable/disable

783
00:20:01,836 --> 0:20:02,136
switch.

784
00:20:02,136 --> 0:20:03,236
That's not a network items.

785
00:20:03,236 --> 0:20:04,586
So we have a heterogeneous list

786
00:20:04,586 --> 0:20:04,826
here.

787
00:20:05,126 --> 0:20:06,266
And all we're doing is

788
00:20:06,266 --> 0:20:08,336
encapsulating each item in this

789
00:20:08,336 --> 0:20:09,586
generic wrapper type.

790
00:20:10,446 --> 0:20:11,946
But that wrapper type, since

791
00:20:11,946 --> 0:20:12,946
that's the type of item we're

792
00:20:12,946 --> 0:20:13,556
going to hand off the

793
00:20:13,556 --> 0:20:14,666
DiffableDataSource, we have to

794
00:20:14,666 --> 0:20:16,236
take care to make sure that it

795
00:20:16,236 --> 0:20:17,696
conforms to hashable and that

796
00:20:17,696 --> 0:20:18,686
the items are uniquely

797
00:20:18,686 --> 0:20:20,186
identified by their hash value.

798
00:20:21,026 --> 0:20:23,796
So for the network items, we can

799
00:20:23,796 --> 0:20:25,866
just get that unique identifier

800
00:20:25,866 --> 0:20:26,816
from the network item and

801
00:20:26,816 --> 0:20:28,716
transplant it into the capital

802
00:20:28,716 --> 0:20:29,306
item.

803
00:20:30,786 --> 0:20:32,146
And for the config items, we

804
00:20:32,146 --> 0:20:33,606
just dynamically generate a

805
00:20:33,606 --> 0:20:34,426
UUID.

806
00:20:36,866 --> 0:20:38,026
Looking down here at our hash

807
00:20:38,026 --> 0:20:40,296
function, again, it's just

808
00:20:40,366 --> 0:20:42,176
computing a hash based on that

809
00:20:42,176 --> 0:20:43,406
unique identifier value.

810
00:20:43,406 --> 0:20:44,616
And that's all it takes for

811
00:20:44,616 --> 0:20:45,916
DiffableDataSource to be able to

812
00:20:45,916 --> 0:20:47,516
identify the items that are the

813
00:20:47,516 --> 0:20:49,716
same from one update cycle to

814
00:20:49,716 --> 0:20:50,176
the next.

815
00:20:51,616 --> 0:20:52,816
Let's look at where we configure

816
00:20:52,816 --> 0:20:53,696
our data source.

817
00:20:55,616 --> 0:20:57,486
This is really very similar to

818
00:20:57,486 --> 0:20:59,256
before, except this time, we're

819
00:20:59,256 --> 0:20:59,946
actually working with the

820
00:20:59,946 --> 0:21:00,886
UITableView.

821
00:20:59,946 --> 0:21:00,886
UITableView.

822
00:21:01,306 --> 0:21:02,696
And from the perspective of

823
00:21:02,766 --> 0:21:04,886
creating and committing

824
00:21:04,886 --> 0:21:06,336
Snapshots, it really doesn't

825
00:21:06,336 --> 0:21:07,396
matter, the API is very similar.

826
00:21:07,396 --> 0:21:08,986
But for the setup, we've got to

827
00:21:08,986 --> 0:21:10,236
instantiate the right type of

828
00:21:10,266 --> 0:21:11,186
DiffableDataSource.

829
00:21:11,286 --> 0:21:12,456
So we got a UITableView

830
00:21:12,456 --> 0:21:13,496
DiffableDataSource.

831
00:21:14,406 --> 0:21:16,066
We parameterize that class name

832
00:21:16,066 --> 0:21:17,366
with the section and item types

833
00:21:17,366 --> 0:21:18,506
that we're going to use.

834
00:21:18,506 --> 0:21:19,486
And we pass a pointer to the

835
00:21:19,486 --> 0:21:20,996
table view, which again, gets

836
00:21:21,066 --> 0:21:24,056
automatically wired up with this

837
00:21:24,056 --> 0:21:25,696
DiffableDataSource as its data

838
00:21:25,696 --> 0:21:26,196
source.

839
00:21:27,646 --> 0:21:29,326
Lastly, we've got that trailing

840
00:21:29,356 --> 0:21:30,526
item provider closure.

841
00:21:30,696 --> 0:21:32,926
And this looks more complex at

842
00:21:32,926 --> 0:21:35,126
first glance, but really, it's

843
00:21:35,126 --> 0:21:36,386
only that way because we have a

844
00:21:36,386 --> 0:21:37,616
variety of different types of

845
00:21:37,616 --> 0:21:37,896
items.

846
00:21:37,896 --> 0:21:38,846
We have those heterogeneous

847
00:21:38,846 --> 0:21:39,606
items to display.

848
00:21:39,606 --> 0:21:41,056
Basically three types of items,

849
00:21:41,396 --> 0:21:42,176
and we're handling them

850
00:21:42,176 --> 0:21:42,646
differently.

851
00:21:43,696 --> 0:21:44,626
But this code, even if we

852
00:21:44,626 --> 0:21:45,036
weren't using

853
00:21:45,036 --> 0:21:46,106
DiffableDataSource, it would be

854
00:21:46,106 --> 0:21:46,366
there.

855
00:21:46,366 --> 0:21:47,886
It would just be in your cell

856
00:21:47,966 --> 0:21:49,486
for ItemIndexPath method.

857
00:21:50,166 --> 0:21:52,416
So again, very simple to set up

858
00:21:52,416 --> 0:21:52,846
this UI.

859
00:21:52,846 --> 0:21:54,346
And even configuring the

860
00:21:54,346 --> 0:21:55,726
DiffableDataSource is not that

861
00:21:55,726 --> 0:21:55,976
hard.

862
00:21:57,416 --> 0:22:00,166
So our last example is maybe the

863
00:21:57,416 --> 0:22:00,166
So our last example is maybe the

864
00:22:00,166 --> 0:22:01,226
most fun to watch.

865
00:22:01,556 --> 0:22:02,566
Here we've got a

866
00:22:02,566 --> 0:22:05,036
UICollectionView again that is

867
00:22:05,036 --> 0:22:06,286
displaying items that are

868
00:22:06,286 --> 0:22:08,276
represented as color swatches.

869
00:22:08,746 --> 0:22:09,786
And they're initially in a

870
00:22:09,786 --> 0:22:12,036
randomized order, color wise.

871
00:22:12,626 --> 0:22:14,916
If I tap the Sort button, we can

872
00:22:14,916 --> 0:22:16,666
watch them be iteratively sorted

873
00:22:16,806 --> 0:22:18,426
into spectral order.

874
00:22:19,316 --> 0:22:20,976
So in addition to being really

875
00:22:20,976 --> 0:22:21,976
mesmerizing and fun to watch

876
00:22:21,976 --> 0:22:22,043
[chuckles] --

877
00:22:22,543 --> 0:22:25,576
[ Applause ]

878
00:22:26,076 --> 0:22:27,516
Credit to Steve on this one.

879
00:22:28,666 --> 0:22:29,806
In addition to being really

880
00:22:29,806 --> 0:22:31,466
mesmerizing, and fun to watch,

881
00:22:31,726 --> 0:22:33,256
this example is just a little

882
00:22:33,256 --> 0:22:34,776
bit different than the others in

883
00:22:34,776 --> 0:22:36,706
the way that we construct and

884
00:22:36,706 --> 0:22:38,346
commit the updates.

885
00:22:39,036 --> 0:22:41,786
So if we wanted to, if we were

886
00:22:41,786 --> 0:22:42,976
just -- if our goal was just to

887
00:22:42,976 --> 0:22:44,396
sort everything and jump to the

888
00:22:44,396 --> 0:22:45,616
end state, we could do that

889
00:22:45,616 --> 0:22:46,116
here, right?

890
00:22:46,386 --> 0:22:48,296
This demo is set up so that we

891
00:22:48,296 --> 0:22:51,006
can watch the sort progress

892
00:22:51,046 --> 0:22:52,296
iteratively through each

893
00:22:52,326 --> 0:22:53,536
intermediate stage.

894
00:22:54,136 --> 0:22:55,586
So in order to do that, we've

895
00:22:55,586 --> 0:22:57,146
got our sword implementation

896
00:22:57,146 --> 0:22:58,176
that goes through the stages and

897
00:22:58,176 --> 0:22:59,646
gives them to us one at a time.

898
00:22:59,646 --> 0:23:01,366
It gives us each successive new

899
00:22:59,646 --> 0:23:01,366
It gives us each successive new

900
00:23:01,366 --> 0:23:03,356
state, and we create a Snapshot

901
00:23:03,356 --> 0:23:05,286
and apply a Snapshot each time

902
00:23:05,286 --> 0:23:06,536
that happens, each time we do an

903
00:23:06,536 --> 0:23:07,146
update cycle.

904
00:23:07,146 --> 0:23:08,286
And that gives us this nice,

905
00:23:08,336 --> 0:23:09,876
fun, animated view.

906
00:23:10,936 --> 0:23:11,786
So let's look at how we

907
00:23:11,786 --> 0:23:12,686
implement this and how it's

908
00:23:12,686 --> 0:23:12,976
different.

909
00:23:16,996 --> 0:23:17,776
We're going to look at the

910
00:23:17,776 --> 0:23:19,226
InsertionSortViewController

911
00:23:19,226 --> 0:23:19,496
here.

912
00:23:21,576 --> 0:23:23,126
And all the interesting action

913
00:23:23,126 --> 0:23:25,246
happens in this PerformSortStep

914
00:23:25,246 --> 0:23:25,666
function.

915
00:23:26,876 --> 0:23:29,006
So as I said, we always have

916
00:23:29,006 --> 0:23:30,266
that three-step cycle.

917
00:23:30,266 --> 0:23:31,356
We're going to get a Snapshot,

918
00:23:31,356 --> 0:23:33,506
populate it, and then apply it.

919
00:23:33,626 --> 0:23:36,916
But in this case, instead of

920
00:23:36,916 --> 0:23:38,166
asking for a new, empty

921
00:23:38,166 --> 0:23:39,736
Snapshot, we're going to take

922
00:23:39,736 --> 0:23:41,016
advantage of the ability to ask

923
00:23:41,436 --> 0:23:43,006
our DiffableDataSource for its

924
00:23:43,006 --> 0:23:43,986
current Snapshot.

925
00:23:44,386 --> 0:23:46,046
Now this Snapshot is

926
00:23:46,076 --> 0:23:47,766
prepopulated with the current

927
00:23:47,856 --> 0:23:49,376
truth of what's being shown in

928
00:23:49,376 --> 0:23:50,596
that UICollectionView as the

929
00:23:50,596 --> 0:23:51,526
CollectionView sees it.

930
00:23:52,576 --> 0:23:53,876
So we don't have to start over

931
00:23:53,876 --> 0:23:54,626
from scratch.

932
00:23:54,776 --> 0:23:56,306
We can start from that state and

933
00:23:56,306 --> 0:23:58,096
compute the next intermediate

934
00:23:58,556 --> 0:23:58,686
state.

935
00:24:00,286 --> 0:24:01,496
Down here, where we populate our

936
00:24:01,496 --> 0:24:02,786
Snapshot, we'll see that

937
00:24:02,786 --> 0:24:05,156
familiar AppendItems function

938
00:24:05,156 --> 0:24:05,726
being called.

939
00:24:05,726 --> 0:24:07,346
But we also have a DeleteItems

940
00:24:07,346 --> 0:24:07,936
function here.

941
00:24:08,236 --> 0:24:09,576
And when you look at the

942
00:24:09,576 --> 0:24:10,986
Snapshot API, you're going to

943
00:24:10,986 --> 0:24:12,296
see there are whole variety of

944
00:24:12,296 --> 0:24:13,596
functions for modifying an

945
00:24:13,596 --> 0:24:14,756
existing Snapshot for when

946
00:24:14,756 --> 0:24:15,786
you're doing this kind of usage.

947
00:24:15,786 --> 0:24:17,356
You can move items from one

948
00:24:17,356 --> 0:24:18,816
place to another, and so on.

949
00:24:19,656 --> 0:24:20,656
But in other respects, this is

950
00:24:20,706 --> 0:24:21,666
pretty much the same thing.

951
00:24:21,666 --> 0:24:22,736
We're just trying to set up the

952
00:24:22,736 --> 0:24:24,376
new final state of what we want

953
00:24:24,376 --> 0:24:24,996
to display.

954
00:24:24,996 --> 0:24:27,066
And we're just working with

955
00:24:27,066 --> 0:24:28,866
identifiers and not IndexPaths,

956
00:24:28,866 --> 0:24:29,776
which is really nice.

957
00:24:30,566 --> 0:24:33,386
So lastly, when we're done, all

958
00:24:33,386 --> 0:24:35,176
we have to do is apply that

959
00:24:35,176 --> 0:24:36,706
Snapshot to our

960
00:24:36,706 --> 0:24:37,726
DiffableDataSource.

961
00:24:38,556 --> 0:24:39,756
And we get this nice,

962
00:24:40,446 --> 0:24:41,486
progressive sorting.

963
00:24:42,146 --> 0:24:42,976
So pretty cool.

964
00:24:43,041 --> 0:24:45,041
[ Applause ]

965
00:24:45,066 --> 0:24:45,336
Thank you.

966
00:24:46,516 --> 0:24:49,556
[ Applause ]

967
00:24:50,056 --> 0:24:51,286
And here's where we set up our

968
00:24:51,286 --> 0:24:52,226
DiffableDataSource.

969
00:24:52,226 --> 0:24:52,806
Again, it's for a

970
00:24:52,806 --> 0:24:54,246
UICollectionView.

971
00:24:54,606 --> 0:24:56,436
We specify the types that we're

972
00:24:56,436 --> 0:24:58,546
using, the CollectionView, and

973
00:24:58,546 --> 0:25:00,026
then we have our item provider

974
00:24:58,546 --> 0:25:00,026
then we have our item provider

975
00:25:00,026 --> 0:25:01,596
closure, which is real simple,

976
00:25:01,596 --> 0:25:02,636
because we're just displaying

977
00:25:02,636 --> 0:25:03,716
these color swatches.

978
00:25:04,926 --> 0:25:06,196
So we've seen, through these

979
00:25:06,196 --> 0:25:08,866
three examples, how easy it is,

980
00:25:08,866 --> 0:25:11,306
and how little code it takes to

981
00:25:11,306 --> 0:25:13,046
create these dynamic UIs that

982
00:25:13,536 --> 0:25:15,396
are also really robust to

983
00:25:15,396 --> 0:25:15,986
changes.

984
00:25:15,986 --> 0:25:17,586
We can make changes without fear

985
00:25:17,586 --> 0:25:18,826
of hitting these weird

986
00:25:18,826 --> 0:25:20,086
exceptions in our code.

987
00:25:20,086 --> 0:25:21,096
It's all very robust.

988
00:25:21,096 --> 0:25:23,086
It's baked into the API how that

989
00:25:23,086 --> 0:25:23,496
works.

990
00:25:24,166 --> 0:25:25,256
Now, we did touch on some

991
00:25:25,286 --> 0:25:27,066
interesting nuances, and the

992
00:25:27,066 --> 0:25:29,096
importance in particular of

993
00:25:29,096 --> 0:25:30,266
uniquely identifying your

994
00:25:30,266 --> 0:25:30,826
objects.

995
00:25:30,826 --> 0:25:31,946
And if you're working with Swift

996
00:25:31,946 --> 0:25:34,276
types, what those Swift types

997
00:25:34,276 --> 0:25:35,456
need to conform to and so on,

998
00:25:35,456 --> 0:25:36,646
that they need to be hashable.

999
00:25:37,096 --> 0:25:38,886
To take us on a deeper dive and

1000
00:25:38,886 --> 0:25:40,286
bring these issues into clear

1001
00:25:40,286 --> 0:25:40,836
focus.

1002
00:25:40,926 --> 0:25:41,966
I'm going to invite my

1003
00:25:41,966 --> 0:25:43,656
colleague, Steve, back on stage.

1004
00:25:43,656 --> 0:25:43,866
Thank you.

1005
00:25:44,516 --> 0:25:47,626
[ Applause ]

1006
00:25:48,126 --> 0:25:50,356
&gt;&gt; And so I kind of have a sense

1007
00:25:50,436 --> 0:25:52,836
for how this UI works walking

1008
00:25:52,836 --> 0:25:53,816
through all these demos.

1009
00:25:54,156 --> 0:25:56,046
I want to go through some more

1010
00:25:56,046 --> 0:25:57,276
detailed considerations of how

1011
00:25:57,276 --> 0:25:58,976
to get the best out of this API.

1012
00:26:02,656 --> 0:26:02,946
All right.

1013
00:26:03,056 --> 0:26:04,346
First, as we've seen all

1014
00:26:04,346 --> 0:26:05,236
throughout the demos, there's

1015
00:26:05,236 --> 0:26:06,396
basically just three steps.

1016
00:26:06,666 --> 0:26:07,856
You want to create a Snapshot,

1017
00:26:08,906 --> 0:26:10,246
configure it as you need it, and

1018
00:26:10,246 --> 0:26:10,946
apply it.

1019
00:26:11,446 --> 0:26:13,096
So you always want to call the

1020
00:26:13,096 --> 0:26:13,806
apply method.

1021
00:26:14,256 --> 0:26:15,576
Now conversely, you don't call

1022
00:26:15,576 --> 0:26:16,766
performBatchUpdates anymore.

1023
00:26:16,986 --> 0:26:17,646
That's old and dead.

1024
00:26:17,946 --> 0:26:19,356
Called insertItems, none of

1025
00:26:19,676 --> 0:26:19,766
that.

1026
00:26:19,946 --> 0:26:21,266
If you call these, the framework

1027
00:26:21,266 --> 0:26:22,066
will complain.

1028
00:26:22,296 --> 0:26:23,846
And, you know, you will see

1029
00:26:23,846 --> 0:26:23,936
that.

1030
00:26:27,046 --> 0:26:28,306
Okay, there are two ways to

1031
00:26:28,306 --> 0:26:29,706
create Snapshots.

1032
00:26:29,766 --> 0:26:31,276
And the most common way is to

1033
00:26:31,276 --> 0:26:32,486
create an empty Snapshot.

1034
00:26:32,706 --> 0:26:33,816
And here we see, we construct

1035
00:26:33,816 --> 0:26:35,206
the Snapshot with the types for

1036
00:26:35,206 --> 0:26:36,996
the sections and items.

1037
00:26:38,376 --> 0:26:39,736
And you can also create one,

1038
00:26:39,736 --> 0:26:40,696
like we saw in the last demo,

1039
00:26:40,696 --> 0:26:41,896
from the current state.

1040
00:26:41,896 --> 0:26:42,766
And this is very useful

1041
00:26:42,766 --> 0:26:44,196
sometimes when a certain action

1042
00:26:44,196 --> 0:26:45,326
occurs where you need to modify

1043
00:26:45,326 --> 0:26:45,976
just one little thing.

1044
00:26:48,516 --> 0:26:50,036
Now when you create this, you're

1045
00:26:50,036 --> 0:26:50,936
going to get a copy back.

1046
00:26:51,056 --> 0:26:52,696
So you can mutate that at will,

1047
00:26:52,696 --> 0:26:54,066
and it will not affect this --

1048
00:26:54,206 --> 0:26:55,746
the data source that it came

1049
00:26:55,746 --> 0:26:55,976
from.

1050
00:26:58,186 --> 0:26:59,456
Now once you have that Snapshot,

1051
00:26:59,456 --> 0:27:00,836
if you did ask some questions,

1052
00:26:59,456 --> 0:27:00,836
if you did ask some questions,

1053
00:27:00,836 --> 0:27:01,686
like, you know, "How many items

1054
00:27:01,686 --> 0:27:01,856
you got?

1055
00:27:01,856 --> 0:27:02,746
How many sections you got?

1056
00:27:02,846 --> 0:27:03,946
Identify the identifiers."

1057
00:27:04,286 --> 0:27:04,846
You can do that.

1058
00:27:04,846 --> 0:27:06,296
And there's a lot of API you can

1059
00:27:06,296 --> 0:27:07,146
check out in the SDK.

1060
00:27:07,146 --> 0:27:07,976
But here's a few of those.

1061
00:27:11,156 --> 0:27:12,296
All right, so I promise you no

1062
00:27:12,296 --> 0:27:13,146
more IndexPath.

1063
00:27:13,146 --> 0:27:14,456
So when we configured these

1064
00:27:14,456 --> 0:27:16,496
Snapshots, you'll never see an

1065
00:27:16,496 --> 0:27:18,666
IndexPath in this API, through

1066
00:27:18,666 --> 0:27:20,516
explicit API.

1067
00:27:21,066 --> 0:27:22,506
So, so far, we've seen a very

1068
00:27:22,506 --> 0:27:23,846
common pattern of appending

1069
00:27:23,846 --> 0:27:25,226
items and appending sections,

1070
00:27:25,226 --> 0:27:26,026
all those kinds of things.

1071
00:27:26,026 --> 0:27:27,026
But you can also do things like

1072
00:27:27,026 --> 0:27:28,456
insert and move and delete.

1073
00:27:29,246 --> 0:27:31,226
And all of these API's take in

1074
00:27:31,456 --> 0:27:34,276
other relative identifiers to

1075
00:27:34,276 --> 0:27:35,596
tell you where things go.

1076
00:27:35,596 --> 0:27:37,426
So if I want to insert 20 new

1077
00:27:37,426 --> 0:27:38,746
identifiers that are all unique,

1078
00:27:39,686 --> 0:27:40,776
before or after another

1079
00:27:40,776 --> 0:27:42,736
identifier, we have explicit API

1080
00:27:42,736 --> 0:27:43,336
for that.

1081
00:27:43,336 --> 0:27:44,256
So you'll say, "Insert these

1082
00:27:44,256 --> 0:27:45,566
identifiers before this

1083
00:27:45,566 --> 0:27:46,236
identifier."

1084
00:27:47,056 --> 0:27:49,246
Now, if you don't have anything

1085
00:27:49,246 --> 0:27:50,316
in that particular section,

1086
00:27:50,316 --> 0:27:51,536
there's no identifier to anchor

1087
00:27:51,536 --> 0:27:53,086
that insertion or move with,

1088
00:27:53,696 --> 0:27:54,986
that's why we have the append

1089
00:27:55,096 --> 0:27:55,356
APIs.

1090
00:27:55,356 --> 0:27:57,066
You can append items and

1091
00:27:57,066 --> 0:27:57,586
sections.

1092
00:27:58,836 --> 0:28:00,316
Now, in that familiar path,

1093
00:27:58,836 --> 0:28:00,316
Now, in that familiar path,

1094
00:28:00,316 --> 0:28:01,106
where you have a number of

1095
00:28:01,106 --> 0:28:01,766
sections, where you're

1096
00:28:01,766 --> 0:28:03,386
configuring your Snapshot, you

1097
00:28:03,386 --> 0:28:04,646
might loop through your section

1098
00:28:04,646 --> 0:28:04,866
data.

1099
00:28:04,866 --> 0:28:05,996
And in that instance, you can

1100
00:28:05,996 --> 0:28:07,846
append items without specifying

1101
00:28:07,876 --> 0:28:08,316
the section.

1102
00:28:08,316 --> 0:28:09,456
There's a default parameter in

1103
00:28:09,456 --> 0:28:11,426
Swift that specifies to null.

1104
00:28:11,666 --> 0:28:13,246
In this instance, we'll just

1105
00:28:13,246 --> 0:28:14,456
append to the last-known

1106
00:28:14,456 --> 0:28:14,966
section.

1107
00:28:14,966 --> 0:28:15,736
So it makes that code very

1108
00:28:15,736 --> 0:28:15,976
pretty.

1109
00:28:19,066 --> 0:28:19,956
All right, so let's talk a bit

1110
00:28:19,956 --> 0:28:21,246
about identifiers.

1111
00:28:21,986 --> 0:28:22,896
These have to be unique.

1112
00:28:23,386 --> 0:28:25,726
And this isn't a big problem,

1113
00:28:25,726 --> 0:28:26,896
because most apps have some kind

1114
00:28:26,896 --> 0:28:28,616
of notion of identity in their

1115
00:28:28,616 --> 0:28:29,426
model objects.

1116
00:28:29,916 --> 0:28:31,456
So it's a very natural step to

1117
00:28:31,456 --> 0:28:32,976
just use that unique identifier.

1118
00:28:35,046 --> 0:28:35,936
Now in Swift, this needs to

1119
00:28:35,936 --> 0:28:37,096
conform to hashable.

1120
00:28:37,526 --> 0:28:38,976
And conveniently enough, many

1121
00:28:38,976 --> 0:28:39,926
things in Swift do this

1122
00:28:39,926 --> 0:28:40,536
automatically.

1123
00:28:40,536 --> 0:28:42,356
We saw auto synthesis for this

1124
00:28:42,356 --> 0:28:42,976
in the enum types.

1125
00:28:45,646 --> 0:28:47,466
And we have string, and integer,

1126
00:28:47,466 --> 0:28:48,956
and UUID, all these great things

1127
00:28:48,956 --> 0:28:50,456
that are available for use for

1128
00:28:50,456 --> 0:28:51,286
DiffableDataSource.

1129
00:28:52,746 --> 0:28:54,636
Now, we also saw that you can

1130
00:28:54,636 --> 0:28:56,266
bring in some model data into

1131
00:28:56,266 --> 0:28:57,396
these identifiers.

1132
00:28:57,496 --> 0:28:58,626
And this is really convenient.

1133
00:28:58,996 --> 0:29:00,266
Now your identity needs to come

1134
00:28:58,996 --> 0:29:00,266
Now your identity needs to come

1135
00:29:00,266 --> 0:29:01,506
from some unique identifier.

1136
00:29:01,856 --> 0:29:02,976
But you can also bring in other

1137
00:29:03,126 --> 0:29:03,816
attributes.

1138
00:29:03,816 --> 0:29:05,536
When we saw like the name and

1139
00:29:05,536 --> 0:29:07,156
the mountains, you can control

1140
00:29:07,156 --> 0:29:07,666
our example.

1141
00:29:08,536 --> 0:29:09,426
And this is really handy,

1142
00:29:09,426 --> 0:29:10,656
because when you configure your

1143
00:29:10,656 --> 0:29:11,866
cell, you have everything you

1144
00:29:11,866 --> 0:29:12,966
need right there in line.

1145
00:29:12,966 --> 0:29:13,926
No looking it up somewhere else.

1146
00:29:18,056 --> 0:29:18,746
All right, here's a little,

1147
00:29:18,786 --> 0:29:19,816
quick template that we see

1148
00:29:19,816 --> 0:29:20,886
throughout the examples that

1149
00:29:20,886 --> 0:29:22,086
talks about how to create a

1150
00:29:22,086 --> 0:29:23,986
hashable thing in Swift where

1151
00:29:23,986 --> 0:29:24,706
they're using a struct.

1152
00:29:26,206 --> 0:29:26,966
Pretty straightforward stuff.

1153
00:29:30,506 --> 0:29:31,246
All right, so what about

1154
00:29:31,466 --> 0:29:32,636
IndexPath-based APIs?

1155
00:29:32,636 --> 0:29:34,306
Okay, so we have CollectionView

1156
00:29:34,306 --> 0:29:34,926
and TableView.

1157
00:29:34,926 --> 0:29:35,606
They have tons of

1158
00:29:35,606 --> 0:29:36,656
IndexPath-based APIs.

1159
00:29:36,656 --> 0:29:37,856
A lot of them in the Delegate

1160
00:29:37,896 --> 0:29:38,276
methods.

1161
00:29:38,276 --> 0:29:40,176
So if a user interacts with the

1162
00:29:40,176 --> 0:29:41,776
content and taps on an item,

1163
00:29:42,476 --> 0:29:43,356
you'll get this familiar

1164
00:29:43,356 --> 0:29:45,376
Delegate message didSelectItemAt

1165
00:29:45,376 --> 0:29:46,006
IndexPath.

1166
00:29:47,126 --> 0:29:48,536
But we've moved into this great

1167
00:29:48,536 --> 0:29:49,636
new identifier-based world.

1168
00:29:49,636 --> 0:29:50,236
What are we going to do with

1169
00:29:50,236 --> 0:29:51,066
this IndexPath?

1170
00:29:51,066 --> 0:29:51,906
You know, that's old school.

1171
00:29:51,906 --> 0:29:54,236
So here we have new API's.

1172
00:29:54,296 --> 0:29:55,356
Let you translate between

1173
00:29:55,356 --> 0:29:57,716
identifiers, IndexPaths, and

1174
00:29:57,716 --> 0:29:59,196
then back from IndexPaths to

1175
00:29:59,196 --> 0:29:59,926
identifiers.

1176
00:29:59,926 --> 0:30:01,046
So here, we see an example.

1177
00:29:59,926 --> 0:30:01,046
So here, we see an example.

1178
00:30:01,556 --> 0:30:02,796
We're taking that identifier,

1179
00:30:02,916 --> 0:30:04,606
that IndexPath that's past, and

1180
00:30:04,606 --> 0:30:06,256
converting it back to an

1181
00:30:06,256 --> 0:30:06,746
identifier.

1182
00:30:06,746 --> 0:30:07,736
And this is constant time.

1183
00:30:07,846 --> 0:30:08,976
This is super, super fast.

1184
00:30:12,426 --> 0:30:13,256
All right, so speaking of

1185
00:30:13,256 --> 0:30:13,886
performance.

1186
00:30:14,906 --> 0:30:17,406
So we've done a ton of work to

1187
00:30:17,406 --> 0:30:19,516
make this as fast as possible.

1188
00:30:19,656 --> 0:30:20,606
And there's a lot of really

1189
00:30:20,606 --> 0:30:21,796
great low-level stuff that just

1190
00:30:21,796 --> 0:30:21,976
blazes.

1191
00:30:25,266 --> 0:30:26,646
Now, if you've ever studied in

1192
00:30:26,646 --> 0:30:27,746
the computer science, the whole

1193
00:30:27,746 --> 0:30:29,176
notion of how diffs occur, you

1194
00:30:29,176 --> 0:30:30,516
know that this is a linear

1195
00:30:30,516 --> 0:30:31,606
operation, O of N.

1196
00:30:31,606 --> 0:30:34,236
And in simple terms, all it just

1197
00:30:34,236 --> 0:30:35,276
means is the more items you

1198
00:30:35,276 --> 0:30:36,836
have, the longer your diff

1199
00:30:36,836 --> 0:30:36,976
takes.

1200
00:30:39,106 --> 0:30:40,236
So during development, it's

1201
00:30:40,236 --> 0:30:41,736
super important to measure your

1202
00:30:41,736 --> 0:30:42,006
apps.

1203
00:30:42,006 --> 0:30:42,506
We all know this.

1204
00:30:42,506 --> 0:30:43,836
We want to make sure that the

1205
00:30:43,836 --> 0:30:46,076
main queue is always as free as

1206
00:30:46,106 --> 0:30:47,906
possible to be real responsive

1207
00:30:47,906 --> 0:30:48,766
to user events.

1208
00:30:48,766 --> 0:30:49,926
And we render everything really

1209
00:30:49,926 --> 0:30:50,376
quickly.

1210
00:30:50,896 --> 0:30:52,746
So as you're measuring your app

1211
00:30:52,796 --> 0:30:53,536
-- you all measure your apps --

1212
00:30:53,906 --> 0:30:55,066
during development, especially

1213
00:30:55,066 --> 0:30:55,566
towards the end.

1214
00:30:55,746 --> 0:30:56,596
I want to make sure that

1215
00:30:56,596 --> 0:30:58,106
everything's really free on that

1216
00:30:58,106 --> 0:30:58,776
main queue.

1217
00:30:59,906 --> 0:31:01,036
Well, if you find that you have

1218
00:30:59,906 --> 0:31:01,036
Well, if you find that you have

1219
00:31:01,036 --> 0:31:02,426
a large number of items in that

1220
00:31:02,426 --> 0:31:03,526
linear diffs taking that little

1221
00:31:03,526 --> 0:31:05,656
extra time, it is safe to call

1222
00:31:05,656 --> 0:31:06,596
the Apply method from a

1223
00:31:06,596 --> 0:31:06,966
background queue.

1224
00:31:07,516 --> 0:31:14,336
[ Applause ]

1225
00:31:14,836 --> 0:31:15,926
Now, what's really cool about

1226
00:31:15,986 --> 0:31:17,286
this is the amount of API we

1227
00:31:17,286 --> 0:31:18,486
have to support this.

1228
00:31:18,486 --> 0:31:19,376
There's no API.

1229
00:31:20,016 --> 0:31:21,046
[ Laughter ]

1230
00:31:21,046 --> 0:31:21,976
Which is the best API.

1231
00:31:22,031 --> 0:31:24,031
[ Cheering and Applause ]

1232
00:31:24,046 --> 0:31:24,176
Right?

1233
00:31:26,916 --> 0:31:28,046
All right, so what happens if

1234
00:31:28,046 --> 0:31:28,956
you call Apply from the

1235
00:31:28,956 --> 0:31:29,586
background queue?

1236
00:31:29,586 --> 0:31:30,886
Well effectively, the framework

1237
00:31:30,886 --> 0:31:31,966
is smart enough to know, "Hey,

1238
00:31:31,966 --> 0:31:32,856
I'm on the main queue."

1239
00:31:32,856 --> 0:31:34,056
And it says, "Let's just keep

1240
00:31:34,056 --> 0:31:35,076
doing this diff right here."

1241
00:31:36,126 --> 0:31:37,716
And once that diff is computed,

1242
00:31:37,956 --> 0:31:39,086
we jump back to the main queue,

1243
00:31:39,086 --> 0:31:40,926
apply the results from our diff,

1244
00:31:40,926 --> 0:31:41,966
and life goes on, like normal.

1245
00:31:45,256 --> 0:31:46,706
All right, so just one caveat,

1246
00:31:46,706 --> 0:31:47,696
and I promise, just one.

1247
00:31:48,406 --> 0:31:51,136
If you choose this model to call

1248
00:31:51,136 --> 0:31:52,466
Apply from the background queue,

1249
00:31:52,606 --> 0:31:53,226
be consistent.

1250
00:31:53,626 --> 0:31:54,646
Just always call it from the

1251
00:31:54,646 --> 0:31:55,236
background queue.

1252
00:31:55,286 --> 0:31:56,486
You never want to mix and match

1253
00:31:56,526 --> 0:31:58,226
calling it from a background

1254
00:31:58,326 --> 0:31:59,406
queue or the main queue.

1255
00:31:59,676 --> 0:32:00,786
Just always do it the same way.

1256
00:31:59,676 --> 0:32:00,786
Just always do it the same way.

1257
00:32:02,496 --> 0:32:03,566
And we're good citizens.

1258
00:32:03,566 --> 0:32:05,266
We'll complain about this if you

1259
00:32:05,266 --> 0:32:05,656
get it wrong.

1260
00:32:06,536 --> 0:32:08,016
All right, so at Apple

1261
00:32:08,216 --> 0:32:09,716
collaboration is a big part.

1262
00:32:09,716 --> 0:32:11,166
It's the main strength of our

1263
00:32:11,166 --> 0:32:12,666
organization, the way we talk to

1264
00:32:12,666 --> 0:32:14,156
each other and solve problems

1265
00:32:14,196 --> 0:32:14,616
together.

1266
00:32:15,286 --> 0:32:16,976
And part of this as the

1267
00:32:16,976 --> 0:32:18,146
frameworks authors is to make

1268
00:32:18,146 --> 0:32:19,456
sure that all of your clients,

1269
00:32:19,456 --> 0:32:20,796
or who you talk to on a regular

1270
00:32:20,796 --> 0:32:21,526
basis, and find out what they're

1271
00:32:21,526 --> 0:32:22,366
struggling with.

1272
00:32:22,756 --> 0:32:23,806
And this clearly is one of the

1273
00:32:23,806 --> 0:32:24,536
things they're struggling with.

1274
00:32:25,106 --> 0:32:26,726
So during this, we chatted with

1275
00:32:26,726 --> 0:32:27,636
the folks who are working on the

1276
00:32:27,636 --> 0:32:29,146
Share Sheet, this new,

1277
00:32:29,146 --> 0:32:30,966
redesigned Share Sheet in iOS

1278
00:32:30,966 --> 0:32:33,116
13, with the great airdrop

1279
00:32:33,166 --> 0:32:33,786
extensions.

1280
00:32:34,776 --> 0:32:36,076
And they found out about it kind

1281
00:32:36,076 --> 0:32:36,816
of late in the game when they

1282
00:32:36,816 --> 0:32:38,026
had this brand new design.

1283
00:32:38,026 --> 0:32:38,886
And they said, "Oh, this looks

1284
00:32:38,886 --> 0:32:39,216
great.

1285
00:32:39,216 --> 0:32:39,856
We need this."

1286
00:32:39,986 --> 0:32:40,976
And indeed they did.

1287
00:32:41,016 --> 0:32:42,996
So I want to bring up one of my

1288
00:32:42,996 --> 0:32:44,526
colleagues from the Share Sheet

1289
00:32:44,526 --> 0:32:46,876
team, Jacob Clapper, to walk us

1290
00:32:46,876 --> 0:32:48,136
through that adoption.

1291
00:32:48,256 --> 0:32:48,546
Jacob?

1292
00:32:49,516 --> 0:32:54,426
[ Applause ]

1293
00:32:54,926 --> 0:32:55,606
&gt;&gt; Hi, everyone.

1294
00:32:56,316 --> 0:32:57,596
I'm really excited to show you

1295
00:32:57,596 --> 0:32:58,586
how the Share Sheet has been

1296
00:32:58,586 --> 0:32:59,966
able to take advantage of the

1297
00:32:59,966 --> 0:33:02,186
great new CollectionView APIs in

1298
00:32:59,966 --> 0:33:02,186
great new CollectionView APIs in

1299
00:33:02,316 --> 0:33:02,976
iOS 13.

1300
00:33:05,046 --> 0:33:06,066
All right, so here we are in the

1301
00:33:06,066 --> 0:33:07,126
brand new Share Sheet.

1302
00:33:07,816 --> 0:33:08,786
And this Share Sheet actually

1303
00:33:08,786 --> 0:33:10,306
takes advantage of the new

1304
00:33:10,306 --> 0:33:12,086
compositional layout API's and

1305
00:33:12,086 --> 0:33:13,406
DiffableDataSource.

1306
00:33:13,406 --> 0:33:14,646
But where DiffableDataSource

1307
00:33:14,646 --> 0:33:16,126
really shines is in the brand

1308
00:33:16,126 --> 0:33:17,446
new airdrop extension.

1309
00:33:18,696 --> 0:33:21,176
So the airdrop extension has a

1310
00:33:21,176 --> 0:33:22,256
browser that's browsing for

1311
00:33:22,256 --> 0:33:22,846
devices.

1312
00:33:23,156 --> 0:33:24,576
And we actually already use

1313
00:33:24,576 --> 0:33:26,606
UUIDs to uniquely identify each

1314
00:33:26,606 --> 0:33:27,656
device that's discovered.

1315
00:33:28,166 --> 0:33:30,206
So as new devices are

1316
00:33:30,206 --> 0:33:31,876
discovered, we are able to

1317
00:33:31,876 --> 0:33:34,036
create an empty Snapshot, append

1318
00:33:34,036 --> 0:33:35,506
our sections and items, and

1319
00:33:35,506 --> 0:33:36,536
Apply the differences.

1320
00:33:36,876 --> 0:33:38,566
DiffableDataSource takes care of

1321
00:33:38,566 --> 0:33:39,056
the rest.

1322
00:33:39,056 --> 0:33:40,056
And the animations are

1323
00:33:40,056 --> 0:33:41,826
beautiful, no matter how many

1324
00:33:41,826 --> 0:33:43,736
items are removed or deleted.

1325
00:33:44,276 --> 0:33:46,196
DiffableDataSource has been a

1326
00:33:46,196 --> 0:33:47,316
game changer for us.

1327
00:33:47,626 --> 0:33:48,986
And we can't wait to see what

1328
00:33:48,986 --> 0:33:50,566
you do with it in your apps.

1329
00:33:50,646 --> 0:33:51,866
I'm going to hand it back over

1330
00:33:51,866 --> 0:33:53,486
to Troy for some final thoughts.

1331
00:33:55,516 --> 0:33:57,556
[ Applause ]

1332
00:33:58,056 --> 0:33:59,426
&gt;&gt; Boy, it's so exciting to me

1333
00:33:59,426 --> 0:34:00,456
to hear how much

1334
00:33:59,426 --> 0:34:00,456
to hear how much

1335
00:34:00,456 --> 0:34:02,146
DiffableDataSource is already

1336
00:34:02,196 --> 0:34:03,566
making a difference in the

1337
00:34:03,566 --> 0:34:05,106
development of our own apps.

1338
00:34:05,106 --> 0:34:06,526
And we couldn't be more thrilled

1339
00:34:06,526 --> 0:34:08,606
to make this same API that we've

1340
00:34:08,606 --> 0:34:09,866
been adopting internally

1341
00:34:10,146 --> 0:34:11,806
available to use for developers

1342
00:34:11,906 --> 0:34:12,976
across our platforms.

1343
00:34:21,045 --> 0:34:22,505
So as we've seen today,

1344
00:34:22,505 --> 0:34:24,485
DiffableDataSource dramatically

1345
00:34:24,485 --> 0:34:26,416
simplifies the work that you

1346
00:34:26,416 --> 0:34:28,485
have to do to get model data

1347
00:34:28,485 --> 0:34:30,606
into your CollectionViews and

1348
00:34:30,606 --> 0:34:31,676
your UITableViews.

1349
00:34:31,976 --> 0:34:33,326
We think it's really a game

1350
00:34:33,326 --> 0:34:33,596
changer.

1351
00:34:33,596 --> 0:34:35,646
It makes it incredibly simple

1352
00:34:35,876 --> 0:34:36,476
and robust.

1353
00:34:36,755 --> 0:34:38,516
There's no more puzzling

1354
00:34:38,696 --> 0:34:40,126
exceptions to debug and

1355
00:34:40,186 --> 0:34:42,216
hard-to-write batch update code.

1356
00:34:42,216 --> 0:34:44,025
You can really just focus on

1357
00:34:44,025 --> 0:34:44,916
what you want to do with your

1358
00:34:44,916 --> 0:34:46,496
app and leave the rest to the

1359
00:34:46,496 --> 0:34:46,936
framework.

1360
00:34:47,856 --> 0:34:49,315
DiffableDataSource is available

1361
00:34:49,426 --> 0:34:53,186
for you to use today on iOS,

1362
00:34:53,186 --> 0:34:54,606
TVoS, and MacOS.

1363
00:34:55,176 --> 0:34:57,016
In addition to providing-- to

1364
00:34:57,016 --> 0:34:58,676
figuring out the diffs for you,

1365
00:34:58,906 --> 0:35:00,236
and automatically committing

1366
00:34:58,906 --> 0:35:00,236
and automatically committing

1367
00:35:00,236 --> 0:35:01,936
them to your UI, you get these

1368
00:35:01,936 --> 0:35:03,946
nice animated changes, right?

1369
00:35:03,946 --> 0:35:05,516
And there's no additional work

1370
00:35:05,516 --> 0:35:07,476
for you to do to get that nice,

1371
00:35:07,786 --> 0:35:09,056
pleasing user interaction

1372
00:35:09,056 --> 0:35:09,316
effect.

1373
00:35:10,126 --> 0:35:12,566
The built-in diff is fast.

1374
00:35:12,566 --> 0:35:14,096
It has been heavily stress

1375
00:35:14,136 --> 0:35:14,556
tested.

1376
00:35:14,906 --> 0:35:17,296
DiffableDataSource is a robust

1377
00:35:17,296 --> 0:35:19,086
API that is ready for you to

1378
00:35:19,086 --> 0:35:20,186
take and run with it.

1379
00:35:20,656 --> 0:35:22,686
So go out there and take it.

1380
00:35:22,946 --> 0:35:24,526
Adapt to your apps to use

1381
00:35:24,526 --> 0:35:25,656
DiffableDataSource.

1382
00:35:25,986 --> 0:35:27,266
We can't wait to see the burden

1383
00:35:27,266 --> 0:35:28,356
this is going to take off your

1384
00:35:28,356 --> 0:35:29,616
shoulders and the delightful

1385
00:35:29,616 --> 0:35:31,176
user experiences that you're

1386
00:35:31,176 --> 0:35:32,206
going to be able to create with

1387
00:35:32,206 --> 0:35:33,586
it with much less time, much

1388
00:35:33,586 --> 0:35:34,176
fewer headaches.

1389
00:35:36,636 --> 0:35:37,896
If you found this talk

1390
00:35:37,896 --> 0:35:39,256
interesting, and you work with

1391
00:35:39,256 --> 0:35:40,426
CollectionViews, we've got

1392
00:35:40,426 --> 0:35:41,246
another one that you're really

1393
00:35:41,246 --> 0:35:43,166
going to love in Advances in

1394
00:35:43,166 --> 0:35:44,616
Collection View Layout.

1395
00:35:44,976 --> 0:35:47,176
We describe an entirely new

1396
00:35:47,176 --> 0:35:48,706
layout system, a way to just

1397
00:35:48,706 --> 0:35:50,276
simply describe any custom

1398
00:35:50,276 --> 0:35:51,736
layout that you want to have in

1399
00:35:51,736 --> 0:35:52,666
your CollectionView.

1400
00:35:52,986 --> 0:35:53,906
And be able to see it

1401
00:35:53,906 --> 0:35:55,356
implemented without any sub

1402
00:35:55,356 --> 0:35:57,206
classing with highly performant

1403
00:35:57,206 --> 0:35:57,666
results.

1404
00:35:57,666 --> 0:35:58,506
So we think you're really going

1405
00:35:58,506 --> 0:35:58,916
to love this.

1406
00:35:58,916 --> 0:36:00,346
Make sure to catch that session.

1407
00:35:58,916 --> 0:36:00,346
Make sure to catch that session.

1408
00:36:01,316 --> 0:36:02,686
And thank you so much for

1409
00:36:02,686 --> 0:36:02,976
watching today.

1410
00:36:03,516 --> 0:36:08,500
[ Applause ]
