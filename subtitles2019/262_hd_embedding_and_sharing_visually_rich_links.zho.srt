1
00:00:01,516 --> 0:00:05,826
[音乐]

2
00:00:06,326 --> 0:00:08,306
&gt;&gt; 嗨 我是 Tim Horton

3
00:00:08,306 --> 0:00:09,646
来自 Safari 和 Webkit 团队的 

4
00:00:10,426 --> 0:00:11,706
我将要为你展示如何

5
00:00:11,706 --> 0:00:13,516
在你的 App 中显示 Rich Link

6
00:00:14,836 --> 0:00:17,306
在 iOS 10 和 macOS Sierra 中

7
00:00:17,306 --> 0:00:18,546
我们介绍了信息中的 Rich Link 

8
00:00:18,546 --> 0:00:20,376
它是一个让 URL

9
00:00:20,376 --> 0:00:23,396
更美观更实用的途径

10
00:00:23,396 --> 0:00:24,506
为了最大化的

11
00:00:24,506 --> 0:00:25,356
利用这个优势 我们建立了

12
00:00:25,356 --> 0:00:28,326
针对某几种链接的规范

13
00:00:28,326 --> 0:00:30,176
这些包括了类似

14
00:00:30,176 --> 0:00:31,446
內联视频和音频播放

15
00:00:31,446 --> 0:00:33,756
以及一个对 Tweets 的特别演示

16
00:00:34,086 --> 0:00:35,296
它包括含有多张图片

17
00:00:35,296 --> 0:00:37,286
以及其他

18
00:00:37,396 --> 0:00:38,556
例如 Apple Maps 的链接

19
00:00:41,566 --> 0:00:45,276
今年 iOS 13 和 macOS 10.15

20
00:00:45,276 --> 0:00:47,166
带来了新的 API 它可以让你

21
00:00:47,166 --> 0:00:48,686
在你自己的

22
00:00:48,686 --> 0:00:50,516
App 中展示 Rich Link 

23
00:00:48,686 --> 0:00:50,516
这样你就可以

24
00:00:50,516 --> 0:00:52,356
用最少的精力 享受最多的好处

25
00:00:53,276 --> 0:00:54,686
在这个视频中我们将

26
00:00:54,686 --> 0:00:56,586
随着创建这个

27
00:00:56,586 --> 0:00:58,356
相当简单的食谱标记 App 的过程中

28
00:00:58,356 --> 0:01:00,566
我们逐步的用到

29
00:00:58,356 --> 0:01:00,566
我们逐步的用到

30
00:01:00,566 --> 0:01:03,596
新的 Link Presentation 框架的功能

31
00:01:03,596 --> 0:01:05,525
来从一个平淡无奇的 URL 列表到

32
00:01:05,525 --> 0:01:07,686
像这样一个丰富的链接网格

33
00:01:07,686 --> 0:01:08,376
而且这不需要花很多时间

34
00:01:10,396 --> 0:01:11,716
要做到这个

35
00:01:11,716 --> 0:01:13,326
我将涵盖 3 个主题

36
00:01:13,326 --> 0:01:15,296
首先 如何呈现元数据

37
00:01:15,296 --> 0:01:16,296
例如一个 URL

38
00:01:16,406 --> 0:01:19,096
第二 如何轻松呈现

39
00:01:19,096 --> 0:01:20,586
这个元数据给用户

40
00:01:21,286 --> 0:01:23,506
然后第三 如何使用取回的

41
00:01:23,506 --> 0:01:24,966
元数据来加速

42
00:01:24,966 --> 0:01:26,396
新的分享表单展示

43
00:01:26,396 --> 0:01:28,806
在 iOS 13 中

44
00:01:30,426 --> 0:01:31,986
那么让我们从检索

45
00:01:31,986 --> 0:01:32,416
元数据开始吧

46
00:01:34,396 --> 0:01:36,276
在菜谱 App 中让我们说

47
00:01:36,276 --> 0:01:37,546
你已经有了一些

48
00:01:37,546 --> 0:01:39,496
给用户获取 URL

49
00:01:39,496 --> 0:01:40,226
到 App 里的机制

50
00:01:41,226 --> 0:01:42,496
你可以把它们呈现

51
00:01:42,496 --> 0:01:44,556
在一个表格中

52
00:01:44,556 --> 0:01:46,046
但 URL 并不是非常用户友好的

53
00:01:46,276 --> 0:01:47,666
在这种情况下

54
00:01:49,996 --> 0:01:51,326
你的确可以改为让用户

55
00:01:51,326 --> 0:01:52,936
给每个链接起一个标题

56
00:01:52,986 --> 0:01:54,266
但是我们可以让它变得更加容易

57
00:01:55,686 --> 0:01:57,686
使用新的 Link Presentation 框架

58
00:01:57,686 --> 0:01:59,936
它很容易使用

59
00:01:59,966 --> 0:02:02,286
LPMetadataProvider类

60
00:01:59,966 --> 0:02:02,286
LPMetadataProvider类

61
00:02:04,926 --> 0:02:07,646
你只需提供 URL 然后它

62
00:02:07,646 --> 0:02:10,026
反馈给你 LPLinkMetadata 文件

63
00:02:10,026 --> 0:02:11,836
包含一个具有代表性的

64
00:02:11,836 --> 0:02:14,066
标题并且在任何媒体都可以使用

65
00:02:14,066 --> 0:02:17,256
让我们看看这是什么样子的

66
00:02:17,606 --> 0:02:19,376
首先你创建一个

67
00:02:19,376 --> 0:02:22,266
LPMetadataProvider 然后调用

68
00:02:22,266 --> 0:02:23,956
startFetchingMetadata 加上

69
00:02:23,956 --> 0:02:26,786
你感兴趣的 URL

70
00:02:26,786 --> 0:02:27,936
当调用完成处理程序时

71
00:02:27,936 --> 0:02:29,766
要确保没有错误

72
00:02:30,146 --> 0:02:32,056
如果服务器没有响应或

73
00:02:32,056 --> 0:02:34,296
太慢或你的用户没有

74
00:02:34,296 --> 0:02:35,436
网络连接

75
00:02:35,756 --> 0:02:37,456
提取元数据可能会失败 

76
00:02:37,456 --> 0:02:40,396
最后 你可以使用元数据

77
00:02:40,396 --> 0:02:41,346
来干你想做的任何事

78
00:02:42,066 --> 0:02:43,306
我们将回到这一个时刻

79
00:02:44,916 --> 0:02:46,456
在我们继续之前有一些

80
00:02:46,456 --> 0:02:48,136
都要记住的事情

81
00:02:48,136 --> 0:02:49,966
在使用 metadataProvider 和

82
00:02:49,966 --> 0:02:51,226
LinkMetadata 过程中

83
00:02:51,716 --> 0:02:53,436
首先 得到的元数据

84
00:02:53,436 --> 0:02:54,906
对象可以包括任何

85
00:02:54,906 --> 0:02:58,166
标题 图标 图像 视频或都不包含

86
00:02:58,166 --> 0:03:00,086
如果网站没有指定任何内容

87
00:02:58,166 --> 0:03:00,086
如果网站没有指定任何内容

88
00:03:00,846 --> 0:03:03,526
它也可以使用安全编码进行序列化 

89
00:03:04,126 --> 0:03:05,356
这很重要 因为

90
00:03:05,356 --> 0:03:06,946
LPMetadataProvider 让

91
00:03:06,946 --> 0:03:08,766
互联网做相关的工作

92
00:03:08,766 --> 0:03:10,606
而你不想做相关工作

93
00:03:10,606 --> 0:03:11,916
也不想让你的用户为这些数据

94
00:03:11,916 --> 0:03:14,076
和功能付费

95
00:03:14,076 --> 0:03:15,246
每当你展示相同的链接时

96
00:03:15,706 --> 0:03:16,966
你应该缓存检索到的

97
00:03:16,966 --> 0:03:19,306
尽量多的本地元数据

98
00:03:20,586 --> 0:03:23,056
此外 你还可以获取

99
00:03:23,056 --> 0:03:25,486
本地 URL 的元数据

100
00:03:25,486 --> 0:03:26,996
新的快速查看缩略 API

101
00:03:26,996 --> 0:03:29,316
将用于检索一个

102
00:03:29,316 --> 0:03:31,716
有代表性的缩略图 尽它最大可能

103
00:03:33,806 --> 0:03:35,296
现在让我们谈谈如何将

104
00:03:35,296 --> 0:03:37,136
我们检索元数据投入实际使用中

105
00:03:37,136 --> 0:03:38,546
用我们的 App 来展示一下

106
00:03:39,946 --> 0:03:41,696
再一次说 这非常简单

107
00:03:41,896 --> 0:03:44,706
你可以用早些时候的一个对象

108
00:03:43,176 --> 0:03:45,726
并用它建立一个 LPLinkView 

109
00:03:48,416 --> 0:03:49,256
就这么简单

110
00:03:51,816 --> 0:03:53,506
让我们回到这个食谱 App

111
00:03:53,506 --> 0:03:55,366
并将 LPLinkViews 放在我们的

112
00:03:55,366 --> 0:03:56,366
表格视图单元格里面

113
00:03:57,846 --> 0:03:58,486
现在好多了

114
00:03:59,056 --> 0:04:00,226
现在你有一个非常熟悉的

115
00:03:59,056 --> 0:04:00,226
现在你有一个非常熟悉的

116
00:04:00,226 --> 0:04:01,586
呈现方式让每个

117
00:04:01,586 --> 0:04:04,836
食谱在第一眼就很容易辨认

118
00:04:04,836 --> 0:04:06,476
LPLinkView 本身具有固有的大小

119
00:04:06,476 --> 0:04:10,726
但它也有会调节以此来符合理想的大小

120
00:04:10,726 --> 0:04:12,486
从而给出一定的限制

121
00:04:12,486 --> 0:04:14,586
我们会尝试呈现

122
00:04:14,586 --> 0:04:17,486
一些在任何尺寸的布局都是合理的东西

123
00:04:18,726 --> 0:04:20,065
我要谈的最后一件事

124
00:04:20,065 --> 0:04:21,416
是关于如何利用

125
00:04:21,416 --> 0:04:23,366
LinkMetadata 来加速

126
00:04:23,366 --> 0:04:26,966
在 iOS 13 中新的分享表单

127
00:04:28,496 --> 0:04:29,946
对于有共用 URL 的现有 App

128
00:04:29,946 --> 0:04:31,426
分享表单将会

129
00:04:31,426 --> 0:04:34,196
自动在卡片上方呈现链接的预览

130
00:04:35,026 --> 0:04:36,706
但是 这需要连接

131
00:04:36,706 --> 0:04:37,946
到服务器以进行检索元数据

132
00:04:37,946 --> 0:04:40,546
每次分享表单被展示的时候都是如此

133
00:04:41,046 --> 0:04:44,406
所以标题和图标是异步显示的

134
00:04:44,446 --> 0:04:45,596
让我们再看一遍

135
00:04:45,906 --> 0:04:48,256
注意观察分享表单的标题

136
00:04:48,736 --> 0:04:52,606
如果你已经有了一个

137
00:04:52,606 --> 0:04:54,846
URL 的 LPLinkMetadata 的对象

138
00:04:55,476 --> 0:04:56,596
你应该把它给

139
00:04:56,596 --> 0:04:58,266
分享表单然后预览就会

140
00:04:58,266 --> 0:05:00,506
无需从网络加载即可立即显示

141
00:04:58,266 --> 0:05:00,506
无需从网络加载即可立即显示

142
00:05:01,196 --> 0:05:02,266
你可以使用新的

143
00:05:02,346 --> 0:05:05,826
activityViewControllerLinkMetadata 方法

144
00:05:05,826 --> 0:05:09,276
在对 UIActivityItemSource 的操作时

145
00:05:09,276 --> 0:05:10,816
只需返回元数据对象

146
00:05:10,816 --> 0:05:13,386
让我们来看看它们的区别

147
00:05:13,386 --> 0:05:14,816
在我们的食谱 App 中 如果我们提供的

148
00:05:14,816 --> 0:05:16,686
数据是我们已经在表格视图中使用过的

149
00:05:18,406 --> 0:05:20,056
好了很多

150
00:05:20,206 --> 0:05:21,706
同样值得注意的是

151
00:05:21,706 --> 0:05:22,966
如果用户选择共享

152
00:05:22,966 --> 0:05:25,046
到消息中

153
00:05:25,046 --> 0:05:26,196
同样的元数据会被直接传送

154
00:05:26,386 --> 0:05:27,826
并且整个过程流畅无缝

155
00:05:27,826 --> 0:05:29,966
没有任何不必要多余下载的体验 

156
00:05:31,086 --> 0:05:31,846
最后一件事

157
00:05:32,446 --> 0:05:33,976
如果你的 App 已经有了一个

158
00:05:33,976 --> 0:05:35,776
食谱数据库 且带有标题和图片

159
00:05:35,776 --> 0:05:38,226
并没有被链接的演示所抓取

160
00:05:38,846 --> 0:05:40,356
你不必重新抓取

161
00:05:40,356 --> 0:05:42,056
来自互联网的元数据

162
00:05:42,056 --> 0:05:43,216
以此来加速

163
00:05:43,216 --> 0:05:44,986
分享表单或展示一个 Rich Link

164
00:05:45,646 --> 0:05:47,216
相反 你可以在

165
00:05:47,216 --> 0:05:48,696
LPLinkMetadata 的地方

166
00:05:48,696 --> 0:05:51,406
填入你自己之前存在的数据来源

167
00:05:52,196 --> 0:05:53,436
你只需创建一个

168
00:05:53,436 --> 0:05:55,706
LPLinkMetadata 对象

169
00:05:55,706 --> 0:05:57,496
并至少填入原始的 URL 和 

170
00:05:57,496 --> 0:05:59,396
URL 字段加上任何

171
00:05:59,396 --> 0:06:01,366
你有的其他信息

172
00:05:59,396 --> 0:06:01,366
你有的其他信息

173
00:06:03,066 --> 0:06:05,346
所以今天我们的三个关键要点是

174
00:06:05,956 --> 0:06:07,946
你可以使用 LPMetadataProvider

175
00:06:08,116 --> 0:06:10,286
来获取 URL 的丰富元数据

176
00:06:10,596 --> 0:06:12,366
为了提供更多的

177
00:06:12,366 --> 0:06:13,796
关于 URL 的内容

178
00:06:14,576 --> 0:06:16,026
你应该使用 LPLinkView

179
00:06:16,026 --> 0:06:17,716
来在你的 App 中显示链接

180
00:06:17,716 --> 0:06:19,116
以一种集美观与

181
00:06:19,116 --> 0:06:21,156
系统一致性于一体的方法

182
00:06:21,156 --> 0:06:22,366
并且你应该预先获取或使用

183
00:06:22,366 --> 0:06:24,216
已有的 LPLinkMetadata 来

184
00:06:24,216 --> 0:06:25,506
加速分享表单

185
00:06:25,506 --> 0:06:26,486
在你的 App 中的预览

186
00:06:27,546 --> 0:06:29,106
更多相关信息 请访问

187
00:06:29,146 --> 0:06:30,806
developer.apple.com 

188
00:06:32,076 --> 0:06:33,756
感谢你的参加
